\documentclass[preprint, 10pt]{elsarticle}

\input{preambles.tex}
\begin{document}

\title{Viscous Transport in Eroding Porous Media}


% OTHER TITLE POSSIBILITIES
% ???

\author[SH]{Shang-Huan Chiu}
\author[Nick]{M.~N.~J.~Moore}
\author[Bryan]{Bryan D.~Quaife}

\address[SH]{Department of Scientific Computing, Florida State
University, Tallahassee, FL, 32306.}
\address[Nick]{Department of Mathematics and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}
\address[Bryan]{Department of Scientific Computing and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}

\begin{abstract} 
  An abstract
\end{abstract}

\begin{keyword}
  Keyword 1 \sep Keyword 2 \sep Keyword 3 
\end{keyword}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{s:intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
A continuation of the methods paper~\cite{qua-moo2018}.
\paragraph{Governing Equations}
\begin{equation}
\label{eqn:erosionModel}
\begin{split}
  \mu \Delta \uu = \grad p, &\hspace{20pt} \xx \in \Omega, \gap &&\mbox{\em conservation
of momentum}\\
\grad \cdot \uu = 0, &\hspace{20pt} \xx \in \Omega, \gap &&\mbox{\em conservation of mass} \\
\uu = 0, &\hspace{20pt} \xx \in \gamma, \gap &&\mbox{\em no slip on the
bodies} \\
\uu = \UU, &\hspace{20pt} \xx \in \Gamma, \gap &&\mbox{\em outer wall
velocity} \\
\Vn = \CE \, \abs{\tau}, &\hspace{20pt} \xx \in \gamma,
&&\mbox{\em erosion model}.
\end{split}
\end{equation}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Contributions}
\begin{itemize}
  \item Use novel near-singular Barycentric integration scheme for
    Stokes equation outlined in~\cite{bar-wu-vee2015}.
  \item Need to compute one additional derivative since we need the
    derivative of the velocity to find the vorticity and stress tensor
  \item Annealing algorithm to create initial body configurations of specified area fraction specified size distribution (NM can do the writing for this).
  \item Tracer trajectories at different time steps
  \item Compute the anomalous diffusion rate using similar techniques as
    the paper with Pietro~\cite{dea-qua-bir-jua2018}
  \item Need a novel way to do time stepping through the complex
    geometry
\end{itemize}

\paragraph{Limitations}
\begin{itemize}
  \item Bodies are still pinned
  \item Bodies are still two dimensional
\end{itemize}

\paragraph{Related Work}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Outline of the Paper}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Boundary Integral Equation Formulation}
\label{s:formulation}
Continuing with our previous work~\cite{qua-moo2018}, we use a
double-layer potential formulation for the velocity $\uu$.  The
double-layer potential is
\begin{align}
  \uu(\xx) = \DDD[\eeta](\xx) = \frac{1}{\pi}\int_{\bd\Omega} 
    \frac{\rr \cdot \nn}{\rho^2} \frac{\rr \otimes \rr}{\rho^2}
    \eeta(\yy) \, ds_\yy, \quad \xx \in \Omega,
  \label{eqn:stokesDLP}
\end{align}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, $\nn$ is the unit outward
normal at $\yy$, and $\eeta$ is an unknown density function.  In
Section~\ref{sec:DLPcomplex}, we show how the Stokes double-layer
potential can also be expressed as the sum of a Laplacian double-layer
potential 
\begin{align}
  \DD[\eta](\xx) = \frac{1}{2\pi} \int_{\bd\Omega}
    \frac{\rr \cdot \nn}{\rho^2} \eta(\yy) ds_\yy
\end{align}
and its gradient.  Since the Laplacian double-layer potential can be
written as a Cauchy integral
\begin{align}
  \DD[\eta](\xx) = \Re (v(x)) \quad \text{where} \quad
  v(x) = \frac{1}{2\pi i} \int_{\bd\Omega}
    \frac{\eta(y)}{x - y} \, dy,
  \label{eqn:laplaceComplex}
\end{align}
where $\xx,\yy \in \RR^2$ are identified with the points $x,y \in \CC$,
the Stokes double-layer potential can be written in terms of Cauchy
integrals and its first derivative.  We also require the derivative of
the Stokes double-layer potential which requires the second derivative
of Cauchy integrals.

We will be using quadrature formulae to compute $v$ and its derivatives
that rely on the Cauchy integral theorem.  Since $v$ is holomorphic, its
value only depends on its boundary data.  The boundary data satisfies
the Sokhotski-Plemelj jump relation
\begin{align}
  v(x) = -\frac{1}{2} \eta(x) + \frac{1}{2\pi i} \int_{\bd\Omega}
    \frac{\eta(y)}{x-y}\, dy, \quad x \in \bd\Omega.
\end{align}
Once the boundary data of $v$ is computed, we have
\begin{align}
  \label{eqn:cauchy}
  v(x) = \frac{1}{2\pi i}\int_{\bd\Omega} 
    \frac{v(y)}{y-x} \,dy, \quad
  v'(x) = -\frac{1}{2\pi i} \int_{\bd\Omega}
    \frac{v(y)}{(y-x)^2} \, dy, \quad
  v''(x) = \frac{1}{\pi i} \int_{\bd\Omega}
    \frac{v(y)}{(y-x)^3} \, dy.
\end{align}
for $x \in \Omega$.  Since $v(x)$ depends on the density function $\eta
\in \CC$, we use the notation $v[\eta](x)$ to denote the holomorphic
function defined in equation~\eqref{eqn:laplaceComplex}, and the
derivatives are written as $v'[\eta](x)$ and $v''[\eta](x)$.

The Stokes double-layer potential itself can not represent all solutions
of the incompressible Stokes equations.  Therefore, we complete the
integral equation formulation following the work of Power and
Miranda~\cite{pow-mir1987}.  The completion depends on the Stokeslets
and rotlets
\begin{align}
  S[\llambda_\ell,\cc_\ell](\xx) = \frac{1}{4\pi} \left( 
    -\log \rho \II + \frac{\rr \otimes \rr}{\rho^2} \right), \quad
  R[\xi_\ell,\cc_\ell](\xx) = \frac{\rr^\perp}{\rho^2} \xi_\ell,
\end{align}
where $\rr = \xx - \cc_\ell$, $\cc_\ell$ is a point inside the
$\ell^{th}$ eroding body, $\rr^\perp = (r_2,-r_1)$, and $\rho =
\|\rr\|$.  Then, the solution of the Stokes equation is
\begin{align}
  \uu(\xx) = \DDD[\eeta](\xx) + 
    \sum_{\ell=1}^M S[\llambda_\ell,\cc_\ell](\xx) + 
    \sum_{\ell=1}^M R[\xi_\ell,\cc_\ell](\xx),
\end{align}
where the density function, Stokeslets, and rotlets satisfy
\begin{align}
  \ff(\xx) &= -\frac{1}{2}\eeta(\xx) + \DDD[\eeta](\xx) + 
    \sum_{\ell=1}^M S[\llambda_\ell,\cc_\ell](\xx) + 
    \sum_{\ell=1}^M R[\xi_\ell,\cc_\ell](\xx) +
    \NN_0(\eeta](\xx), \quad \xx \in \bd\Omega, \\
  \llambda_\ell &= \frac{1}{2\pi} \int_{\gamma_\ell} 
    \eeta(\yy)\, ds_\yy \quad \ell = 1,\ldots,M, \\
  \xi_\ell &= \frac{1}{2\pi} \int_{\gamma_\ell}
    (\yy - \cc_\ell)^\perp \cdot \eeta(\yy)\, ds_\yy 
    \quad \ell = 1,\ldots,M,
\end{align}
where $\ff$ is the prescribed Dirichlet boundary condition of the
velocity on the outer wall and eroding bodies.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Cauchy Integral Representation of the Double-Layer
Potential}
\label{sec:DLPcomplex}
The Stokes double-layer potential~\eqref{eqn:stokesDLP} can be
decomposed as
\begin{align}
  \DDD[\eeta](\xx) &= 
    \frac{1}{2\pi} \int_{\bd\Omega} 
      \frac{\nn}{\rho^2} (\rr \cdot \eeta) \, ds_\yy + 
    \frac{1}{2\pi} \nabla \int_{\bd\Omega}
      \frac{\rr \cdot \nn}{\rho^2} (\yy \cdot \eeta) \, ds_\yy \\
    &- \frac{1}{2\pi} x_1 \nabla \int_{\bd\Omega}
      \frac{\rr \cdot \nn}{\rho^2}\eta_1(\yy) \, ds_\yy -
    \frac{1}{2\pi} x_2 \nabla \int_{\bd\Omega}
      \frac{\rr \cdot \nn}{\rho^2}\eta_2(\yy) \, ds_\yy.
\end{align}
All these integrals but the first are a gradient of a Laplace layer
potential.  In addition, each component of the first integral can be
written as a Cauchy integral with a complex-valued density
function~\cite{bar-wu-vee2015}.  Therefore, the Stokes double-layer
potential can be written as five Cauchy integrals and their derivatives
with the density functions $\yy \cdot \eeta$, $\eta_1$, and $\eta_2$.
The individual velocity components are
\begin{align}
  \label{eqn:cauchy1}
  u_1(x) &= \Re (v[\tau_1](x)) + \Re (v'[y\cdot\eta](x)) 
           -x_1\Re (v'[\eta_1](x)) - x_2\Re (v'[\eta_2](x)), \\
  u_2(x) &= \Re (v[\tau_2](x)) - \Im (v'[y\cdot\eta](x)) 
       +x_1\Im (v'[\eta_1](x)) + x_2\Im (v'[\eta_2](x)),
\end{align}
where $y \cdot \eta = y_1 \eta_1 + i y_2 \eta_2 \in \CC$, 
\begin{align} 
  \tau_1=(\eta_1+i\eta_2)\frac{\Re(n)}{n}, \quad \text{and} \quad
  \tau_2=(\eta_1+i\eta_2)\frac{\Im(n)}{n},
\end{align}
and $n \in \CC$ is the complex representation of the outward unit normal
$\nn \in \RR^2$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Cauchy Integral Representation of the Shear Stress}
To compute the rate of erosion, we must compute the shear stress of the
double-layer potential
\begin{align}
  \tau(\xx) = \left(\nabla \DDD[\eeta](\xx) + 
    \nabla^T \DDD[\eeta](\xx) \right) \nn \cdot \ss,
\end{align} where $\nn$ and $\ss$ are the unit normal and tangent
vectors at $\xx$, respectively.  Each term of the gradient of the
velocity field can be written in terms of Cauchy integrals.  For
example,
\begin{align}
  \pderiv{u_1}{x_2} &= \Re(iv'[\tau_1](x)) + 
      \Re(i v''[y \cdot \eta](x)) -
      x_1\Re(i v''[\eta_1](x))  -
      \Re(v'[\eta_2](x)) - x_2 \Re(iv''[\eta_2](x)) \\
    &= -\Im(v''[\tau_1](x)) - 
      \Im(v''[y \cdot \eta](x)) +
      x_1\Im(v''[\eta_1](x)) -
      \Re(v'[\eta_2](x)) + x_2 \Im(v''[\eta_2](x)).
\end{align}
Similarly, the other three components of $\nabla \DDD[\eeta]$ can be
calculated
\begin{align}
  \pderiv{u_1}{x_1} &= \Re (v'[\tau_1](x)) + 
    \Re (v''[y\cdot\eta](x)) - \Re (v'[\eta_1](x)) - 
    x_1\Re (v''[\eta_1](x)) - x_2\Re (v''[\eta_2](x)), \\
  \pderiv{u_1}{x_2} &= - \Im (v'[\tau_1](x)) - 
    \Im (v''[y\cdot\eta](x)) + x_1\Im (v''[\eta_1](x)) - 
    \Re (v'[\eta_2](x)) + x_2\Im (v''[\eta_2](x)), \\
  \pderiv{u_2}{x_1} &= \Re (v'[\tau_2](x)) - 
    \Im (v''[y\cdot\eta](x)) + \Im (v'[\eta_1](x)) +
    x_1\Im (v''[\eta_1](x)) + x_2\Im (v''[\eta_2](x)), \\
  \pderiv{u_2}{x_2} &= -\Im (v'[\tau_2](x)) - 
    \Re (v''[y\cdot\eta](x)) + x_1\Re (v''[\eta_1](x)) +
    \Im (v'[\eta_2](x)) + x_2\Re (v''[\eta_2](x)).
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Cauchy Integral Representation of the Vorticity}
Having calculated all derivatives of the double-layer potential, the
vorticity can written in terms of Cauchy integrals.  In particular,
\begin{align}
  \omega(x) = \pderiv{u_2}{x_1} - \pderiv{u_1}{x_2} = 
\Re (v'[\tau_2](x)) + \Im (v'[\tau_1](x)) 
 + \Re (v'[\eta_2](x))+ \Im (v'[\eta_1](x)).
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Cauchy Integral Representation of the Pressure}
The pressure of the double-layer potential is
\begin{align}
  p(\xx) = -\frac{1}{\pi} \int_{\bd\Omega} \frac{1}{\rho^2}
    \left(1 - 2 \frac{\rr \otimes \rr}{\rho^2} \right) \nn
    \cdot \eeta(\yy) \, ds_\yy.
\end{align}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Transport, Tracers, and Tortuosity}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Erosion leads to interesting porous geometries, and we are interested in
characterizing transport in these geometries.  To characterize the
transport, we first require tracer trajectories (streamlines) that are
governed by
\begin{align}
  \frac{d\ss}{dt} = \uu(\ss,t), \quad \ss(0) = \ss_0.
\end{align}
Instead of allowing the transport and erosion to happen simultaneously,
we freeze the geometry and compute the streamlines in this fixed
geometry.  Therefore, the velocity $\uu$ has no temporal dependence when
we characterize the transport.

The tortuosity measures ...


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Methods}
\label{s:method}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We have shown that the velocity, shear stress, vorticity, and pressure
of the double-layer potential can all be written in terms of Cauchy
integrals and its first two derivatives.  Therefore, we require
quadrature methods to evaluate the expressions in
equation~\eqref{eqn:cauchy}.  Since the integrands are all smooth and
periodic, the Trapezoid rule has spectral accuracy.  However, the
integrand is nearly singular if $x$ is close to $\bd\Omega$, and the
quadrature error is arbitrarily large if the resolution $N$ is fixed.
There have been a variety of near-singular integration schemes
developed, and we extend a method first outlined by Barnett et
al.~\cite{bar-wu-vee2015} which we call the {\em Barycentric quadrature
rule}.  This method first uses the density function $\tau(y)$ to compute
the boundary data of $v$, denoted by $v^-{y}$.  Then, it makes use
of the identity
\begin{align}
  v(x) = \int_{\bd\Omega} \frac{v^{-}(y)}{y-x} \, dy, 
  \quad x \in \Omega.
\end{align}

Here, we briefly describe this quadrature method, and then derive a
necessary extension to simulate erosion.  The Barycentric quadrature
rule starts with a quadrature rule with nodes $y_j \in \bd\Omega$ and
weights $w_j$. We use the trapezoid rule because of its superior
accuracy when $x$ is sufficiently far from $\bd\Omega$.  However, as $x$
approaches $\bd\Omega$, the integrand becomes nearly singular and the
quality of the trapezoid rule deteriorates. To eliminate the
nearly-singular integrand, we use the identity
\begin{align}
  \int_{\bd\Omega} \frac{v^{-}(y) - v(x)}{y - x} \,dy = 0.
\end{align}
Then, even if $x$ is close to $\bd\Omega$, the integrand is no longer
nearly-singular and the accuracy of the trapezoid rule is bounded
independent of $x$.  A similar identity identity involving $v'(x)$ also
holds.   Now, applying the spectrally accurate trapezoid rule, the
quadrature error of the Barycentric quadrature rule
\begin{align}
  v(x) \approx \frac{\sum\limits_{j=1}^N \frac{v_j^-}{y_j-x}w_j}
    {\sum\limits_{j=1}^N \frac{1}{y_j-x}w_j}
  \quad \text{and} \quad
  v'(x) \approx \frac{\sum\limits_{j=1}^N 
    \frac{v_j^- - v(x)}{(y_j - x)^2}w_j}
    {\sum\limits_{j=1}^N \frac{1}{y_j-x}w_j}, 
  \label{eqn:vvpQuadrature}
\end{align}
is uniformly bounded~\cite{bar-wu-vee2015}.  A slight modification of
these formulae are applied if $x \in \Omega^{c}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Barycentric Quadrature for $v''(x)$}
While accurate quadrature rules for $v(x)$ and $v'(x)$ have already been
developed~\cite{bar-wu-vee2015}, this work requires a similar quadrature
rule for $v''(x)$.  We mimic the approach developed
in~\cite{bar-wu-vee2015}.  First, if $x \in \Omega$ and $n \in
\mathbb{N}$, then 
\begin{align}
  \frac{1}{2\pi i}\int_{\bd\Omega} \frac{1}{(y-x)^n}\, dy = 
  \left\{
    \begin{array}{ll}
      1, & n = 1, \\
      0, & n > 1. \\
    \end{array}
  \right.
\end{align}
Applying this identity to the Cauchy integral theorem for $v''(x)$, we
have
\begin{align}
  0 &= \frac{1}{2\pi i} \int_{\bd\Omega} 
      \frac{2v^{-}(y)}{(y-x)^3}\,dy - v''(x) \\
%    &= \frac{1}{2\pi i} \int_{\bd\Omega} 
%      \frac{2v^{-}(y)}{(y-x)^3}\,dy - 
%    \frac{1}{2\pi i} \int_{\bd\Omega} 
%      \frac{(y-x)^2 v''(x)}{(y-x)^3}\,dy -
%    \frac{1}{2\pi i} \int_{\bd\Omega} 
%      \frac{2v(x)}{(y-x)^3}\, dy -
%    \frac{1}{2\pi i} \int_{\bd\Omega} 
%      \frac{2(y-x)v'(x)}{(y-x)^3}\, dy \\
    &= \frac{1}{2\pi i} \int_{\bd\Omega} 
      \frac{2v^{-}(y) - v''(x)(y-x)^2 - 2v(x) - 2(y-x)v'(x)}
      {(y-x)^3}\, dy.
\end{align}
Since we have constructed the integrand so that it is bounded for for
all $x \in \Omega$, the quadrature error of the trapezoid rule is
acceptable.  Applying the quadrature rule and solving for $v''(x)$, the
Barycentric quadrature rule for the second derivative is
\begin{align}
  v''(x) &\approx \frac{2\sum\limits_{j=1}^N 
    \frac{v^{-}_{j} - v(x) - (y_j-x)v'(x)}{(y_j-x)^3}w_j}
    {\sum\limits_{j=1}^N \frac{1}{y_j-x}w_j}.
\end{align}
To compute $v(x)$ and $v'(x)$, the Barycentric quadrature rule in
equation~\eqref{eqn:vvpQuadrature} is used. If $x \in \Omega^c$, the
identity
\begin{align}
\frac{1}{x-a} &= -\frac{1}{2\pi i}\int_{\bd\Omega} 
    \frac{(y-a)^{-1}}{y-x} dy, 
\end{align}
is used, and the resulting Barycentric quadrature formula is
\begin{align}
  v''(x) &\approx \frac{1}{x-a}\frac{2\sum\limits_{j=1}^N
    \frac{v^{+}_{j} - v(x) - (y_j-x)v'(x)}{(y_j-x)^3}}
    {\sum\limits_{j=1}^N \frac{(y_j-a)^{-1}}{y_j-x}w_j}.
\end{align}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Fast Summation Methods}
\label{sec:fmm}
The Barycentric quadrature rule achieves acceptable accuracy for
computing the velocity, shear stress, and vorticity.  However, applied
directly, it requires $\mathcal{O}(N^2)$ operations.  Since the shear
stress must only be computed once per time step, and the vorticity is
only used as a post-processing step, we accept the $\mathcal{O}(N^2)$
algorithm.  However, the velocity must be computed at every GMRES
iteration, which would make the overall method impractical without a
fast algorithm.

To compute the velocity with $\mathcal{O}(N)$ operations, we start by
using the trapezoid rule accelerated with the fast multipole method
(FMM) \todo[inline]{reference here}. For target points that are
sufficiently far from $\bd\Omega$, the resulting velocity is
sufficiently accurate.  However, the velocity at points that are too
close to $\bd\Omega$ must be corrected.  For a general point $\xx$,
\begin{align}
  \vv(\xx) = \int_{\Gamma} D(\xx,\yy) \eeta(\yy)\, ds_\yy + 
    \sum_{k=1}^{M} \int_{\gamma_k} D(\xx,\yy) \eeta(\yy)\, ds_\yy.
\end{align}
Assuming that $\xx$ is too close to $\gamma_i$, we first subtract the
velocity contribution of $\vv(\xx)$ due to $\gamma_i$.  Then, the
Barycentric quadrature rule is used to compute the velocity due to
$\gamma_i$ with more accuracy.  This is correction is applied to all
points that are close to an eroding body or the outer wall $\Gamma$.

The same strategy of using the trapezoid rule and then correcting with
the Barycentric quadrature is used to compute the shear stress on
$\bd\Omega$ and vorticity in $\Omega$.  The trapezoid rule is applied
with a direct summation, but this cost is only incurred once per time
step, and the majority of the computational effort is still required to
compute the velocity using the fast summation method.

To determine if a point $\xx \in \gamma_i$ needs to be corrected with
the Barycentric quadrature rule, we first estimate the proximity of
$\xx$ to $\bd\Omega$.  The criteria depends on the length of the outer
wall, $L_w$, the length of the eroding bodies $L_i$, $i=1,\ldots,M$, and
the number of discretization points $N_\out$ and $N_\iin$.  


{\color{red}
By using Barycentric quadrature rule to approach integrations, we get a reasonable(?) double-layer potential and quantities of interest at target points but it requires $\mathcal{O}(N^2)$ operations per target point which is computational expensive if we impose it on all the target points. In order to accelerate the process and keep the accuracy, it is a compromise that we use Barycentric quadrature rule to approach the nearly singular integratons but apply trapezoid rule when the target point is far from source points. 


To numerically compute the completed double-layer potential, we discretize each of the $M$ bodies with  $N_\iin$ points, and the outer boundary with $N_\out$ points. The following is the four-step fast summation methods.
}
\begin{itemize}
  \item Apply trapezoid rule as a first pass

{\color{red} We use the Fast Multipole Method (FMM)~\cite{gre-rok1987, gre-gre-may1992} with trapezoid rule to calculate the double-layer potential.
}
  \item Efficiently find points that are too close for trapezoid

{\color{red}
 Let $L_w$ be the length of the outer boundary and $L_{b}$ be the length of the boundary of body where $b=1, \cdots, M$. Here are the criteria to see if two points are too close for trapezoid. For criterion of outer boundary to body,  let $d$ be the minimum distance between outer boundary and a point $x$ on the body $b$, we say $x$ is too close to outer boundary if
\begin{equation}\label{eqn:Cw2b}
d<\frac{L_{b}}{2\pi} + \alpha_1\frac{L_w}{N_\out}
\end{equation}
where $\alpha_1$ is a constant. 
For criterion between two bodies, let $d$ be the distance between the centroid $a$ of the body $b_1$ and a point $x$ on the body $b_2$, we say they are too close if
\begin{equation}\label{eqn:Cb2b}
d<\frac{L_{b_1}}{2\pi}+\frac{L_{b_2}}{2\pi}+\alpha_2\left(\frac{L_{b_1}}{N_\iin}+\frac{L_{b_2}}{N_\iin}\right)
\end{equation}
where $\alpha_2$ is a constant. 

}
  \item Subtract off trapezoid rule directly
  \item Add on Barycentric directly
\end{itemize}
{\color{red}  (Discussion of the choices of $\alpha_1$ and $\alpha_2$ with respect to accuracy and  efficiency)

To find the suitable values of $\alpha_1$ and $\alpha_2$ in~\eqref{eqn:Cw2b} and \eqref{eqn:Cb2b}, we set $\alpha_1=\alpha_2=1, 2, 3$, and $4$ to test the criteria on a 20-body problem with $N_\out = 1024$ and $N_\iin = 128, 256$, and $512$. To check the accuracy of the simulations, we use the solution calculated by \todo[inline]{what method} to \todo[inline]{...}
To see how efficient our code is, we record the cpu time for each step.

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Results}
\label{s:results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We do some simulations.  The parameters are
\begin{itemize}
  \item time step size
  \item regularization and smoothing parameters
  \item resolution on bodies and solid wall
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A single body close to a wall}
\todo[inline]{Do a single body that is extremely close one of the two
horizontal walls.  This can be compared to some of the
results~\cite{mit-spa2017}.  Do for a variety of distances to
demonstrate how close we can put it to the wall with no need to increase
the resolution}
\begin{figure}[htbp]
\begin{center}
\includegraphics[width = 0.30 \textwidth]{./figs/1b_0d4r1h_shear}
\includegraphics[width = 0.30 \textwidth]{./figs/1b_0d4r0d5h_shear}
\includegraphics[width = 0.35 \textwidth]{./figs/1b_0d4r0d1h_shear}
\caption{A single body eroding in Stokes flow. Color indicates the shear stress on the body. In this simulation, we use three minimum body-to-wall initial distances $d=h$(left), $h/2$(middle), and $h/10$(right) with $N_\iin = 256$ discretization points on the body, $N_\out = 1024$ points on the outer boundary, a time-step of $\Dt$, and smoothing parameters of $\eps $ and $\sigma $.}
\label{} 
\end{center}
\end{figure}
{\color{red} We first consider a single circular body in a shear flow. 
The domain $\Omega$ is a rectangle $[-3,3]\times[-1,1]$ with rounded corners. 
The velocity of flow from the left side of $\Omega$ is $v(x_1,x_2)=x_2+1$. 
Let the initial radius of the body be $r$, 
the initial length of the body be $L$, $N_\iin$ and 
$N_\out$ be the number of discretization points 
on the body and wall respectively, 
$h=L/N_\iin$ be the resolution mesh size of the body, 
and $d$ be the minimum initial distance from body to wall. 
To investigate the shape of eroding body when it is close to wall, 
we set $r=0.4$, $N_\iin=256$, and $N_\out=1024$ 
with respect to three different $d=h, h/2$, and $ h/10$. 

}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[H]
\begin{center}
\includegraphics[width = 0.42 \textwidth]{./figs/20b_dense1}
\includegraphics[width = 0.507 \textwidth]{./figs/20b_dense101}\\

\includegraphics[width = 0.42 \textwidth]{./figs/20b_dense201}
\includegraphics[width = 0.507 \textwidth]{./figs/20b_dense301}
\caption{\label{fig:Eroding20vort} Erosion of 20 nearly touching bodies with the fixed-pressure-drop condition. The color is the vorticity of fluid. The 4 snapshots are evenly spaced in time. In this simulation, we use $N_\iin = 256$ discretization points on the body, $N_\out = 1024$ points on the outer boundary, a time-step of $\Dt=10^{-4}$, and smoothing parameters of $\eps= 15/256$ and $\sigma=10/256 $. In the forth frame, bodies 4, 12, and 17 have vanished completely, and body 19 (the one without number on the right) has almost vanished because of eroding.}
\end{center}
\end{figure}
\subsection{20 nearly touching bodies}
{\color{red} 
By using Barycentric quadrature rule, 
we are able to capture the details in the fluid when wall and bodies or body and bodies 
are close to each other. 
The first nearly touching bodies case is 20 bodies in a Hagen-Poiseuille flow. 
The domain $\Omega$ is a rectangle $[-3,3]\times[-1,1]$ with rounded corners. 
The velocity of flow from the left side of $\Omega$ is $v(x_1,x_2)=(1+x_2)(1-x_2)$. 
The number of discretization points $N_\iin$ on the bodies is 256 and the number 
of discretization points $N_\out$ on the outer boundary is 1024. 

The snapshots of the process of 20 nearly touching bodies 
eroding are in Fig.~\ref{fig:Eroding20vort}. 
We place some bodies to nearly contact not only one another 
but also the outer boundary. For example, bodies 1, 6, 13, and 15 
are very close to outer boundary. In~\cite{qua-moo2018} 
we reported the quick expanding space at the narrow channel 
between neighboring bodies, the developing flat faces at the sites 
of near contact, and bodies vanishing. In this nearly touching bodies 
structure, we also observe these phenomena but with more new details.

For the speed of expanding space at the narrow channel, we see some 
narrow channels do expand faster than other wider channels. 
For example, the spacing between bodies 14 \& 18 is smaller 
than the spacing between bodies 7 \& 14 initially and the former one is 
comparable to the latter one by the second frame. But there are some 
small initial spacings that do not expand that much at all by the fourth frame, 
for example between bodies 1 \& 6, 3 \& 9. 
We could find the explanation from the vorticity of fluid 
in Fig.~\ref{fig:Eroding20vort}. 
Since the eroding velocity on the body is proportional to the 
absolute value of vorticity in our erosion model,  
then when the  absolute value of vorticity is small 
there is not much erosion on the body. 
In all four frames of Fig.~\ref{fig:Eroding20vort}, 
the vorticity is relatively small between bodies 1 \& 6 and 3 \& 9.

Besides the channels between two bodies, there is a single channel across from left to right of the domain and the flow has been concentrated in this channel. In the second frame of Fig.~\ref{fig:Eroding20vort}, this channel is between bodies 1 \& 20, 1 \& 9, 4 \& 3, 8 \& 11, 8 \& 2, 6 \& 12, and 6 \& 19. We can get a better understanding from the trajectories of tracers in Fig.~\ref{fig:Eroding20tracer}. In the top three frames of  Fig.~\ref{fig:Eroding20tracer},
the flow (or tracer) first comes from three small channels between outer boundary \& body 10, bodies 7 \& 14, and bodies 14 \& 18, then the three branches become one main channel between bodies 1 \& 9. After 

For the flat faces at the sites of near contact, since we put the body be close to one another
so we are able to see all the channels between two close bodies have flat faces. 
Besides the channels between bodies, we also observe the flat faces on the bodies 
which are close to the outer boundary. For example, we see the flat faces 
on the top of bodies 1 \& 6 and the bottom of bodies 13 \& 15.  



Since the direction of flow is from left to right, most of the tracers will not travel vertically but horizontally when the gaps or channels are too small.  }

\begin{figure}[H]
\begin{center}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b30}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b60}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b90}\\

\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b120}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b150}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b180}\\

\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b210}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b240}
\includegraphics[width = 0.3 \textwidth]{./figs/tracer_20b270}
\caption{\label{fig:Eroding20tracer}The trajectories of 200 tracers in the fluid with 20 bodies. The 9 snapshots are evenly spaced in time. The tracers are evenly spread in the $x_2-$direction and released at $x_1=-1$.}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
\caption{The tortuosity of the 20 nearly touching bodies}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{50 nearly touching bodies}
{\color{red}
The second nearly touching bodies case is 50 bodies in a Hagen-Poiseuille flow.
}

\subsection{100 bodies}
{\color{red}
This case is 100 bodies in a Hagen-Poiseuille flow.
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\label{s:conclusions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{\bf Acknowledgments} We would like to thank Manas Rachh for
supplying the FMM for the Stokes double-layer potential. BQ and NM were
supported by Florida State University startup funds and Simons
Foundation Mathematics and Physical Sciences-Collaboration Grants for
Mathematicians.

\bibliographystyle{plainnat} 
\biboptions{sort&compress}
\bibliography{refs}


\end{document}








%old stuff%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{boundary integral equation formulation} 
%\label{sec:bies}
%add an introduction why we do not use the double-layer potentials of stokes equations but the double-layer potentials of laplace equations to solve stokes equation when we use barycentric approach (or complex variable approach).
%
%\subsubsection{laplace's equations from $\rdb^2$ to $\cdb$ }
%
%let $\omega$ be the domain of fluid. the boundary of $\omega$ is $\gamma$ and the outward normal vector on $\gamma$ is ${\bf n_y}=(n_1,n_2)$.
%
%consider a laplace's equations with dirichlet boundary condition
%\begin{equation}\label{laplace}
%  \begin{cases}
%    \delta {\bf u}=0, & \text{in}\,\,\, \omega \in \rdb^2;\\
%    {\bf u}={\bf f}, & \text{on}\,\,\, \gamma.
%  \end{cases}
%\end{equation}
%
%Let ${\bf x}=(x_1,x_2), {\bf y}=(y_1,y_2)$. Then we have ${\bf r}={\bf x} - {\bf y}$ and $\rho=|\bf r|$.
%The double-layer potential which solves \eqref{Laplace} is 
%\begin{align*}
%\D[\sigma]({\bf x})&=\frac{1}{2\pi}\displaystyle\int_{\Gamma} \frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\sigma({\bf y})ds_y,
%%\frac{1}{2\pi}\displaystyle\int_{\Gamma}\frac{\partial}{\partial {\bf n_y}} \log |{\bf x}-{\bf y}| \sigma({\bf y})ds_y,\\ \\
%%&=\frac{-1}{2\pi}\int_{\Gamma}\frac{{\bf r}\cdot{\bf n_y}}{\rho^2} \sigma({\bf y})ds_y\\ \\
%%&=\frac{-1}{2\pi}\int_{\Gamma}\frac{n_1(x_1-y_1)+n_2(x_2-y_2)}{(x_1-y_1)^2+(x_2-y_2)^2} \sigma({\bf y})ds_y 
%\numberthis\label{DLP:real}
%\end{align*}
%where $\sigma$ is the density function on the boundary $\Gamma$.
%
%
%Consider a Cauchy integral 
%\begin{equation}\label{CI}
%v({x})=\frac{1}{2\pi i}\int_{\Gamma}\frac{\sigma({ y})}{{ y}-{ x}} d{ y},\,\,\,\,\,\,\,\,\, \forall { x} \in \Cdb\setminus \Gamma.
%\end{equation}
%where ${ x}=x_1+ix_2$, $ { y}=y_1+iy_2$, ${ n_y}=n_1+i n_2$ and $d{ y}=i {n_y}ds_y$. It can be shown that 
%the real part of the Cauchy integral in \eqref{CI} is equivalent to the double-layer potential in \eqref{DLP:real}. 
%
%
%\subsubsection{From Stokes DLP to Laplace DLPs}
%
%Let ${\bf x}=(x_1,x_2), {\bf y}=(y_1,y_2)$. Then we have ${\bf r}={\bf x} - {\bf y}$ and $\rho=|\bf r|$.
%
%
%The Stokes double-layer potential  is
%\begin{equation}\label{StokesDLP1}
%\D[\boldsymbol\sigma]({\bf x}):=\frac{1}{\pi}\int_{\Gamma}\left(\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\frac{{\bf r} \otimes {\bf r}}{\rho^2}\right) {\boldsymbol\sigma({\bf y})} d s_y.
%\end{equation}
%We could rewrite the Stokes DLP in terms of the Laplace DLP as
%\begin{align*}\label{StokesDLP2}
%\D[\boldsymbol\sigma]({\bf x})=\frac{1}{2\pi}\int_{\Gamma}&\frac{{\bf n_y}}{\rho^2}({\bf r} \cdot {\boldsymbol \sigma})ds_y+\frac{1}{2\pi}\nabla\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}({\bf y} \cdot{\boldsymbol \sigma})ds_y\\
%&-\frac{1}{2\pi}x_1 \nabla\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\sigma_1ds_y-\frac{1}{2\pi}x_2\nabla\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\sigma_2ds_y. \numberthis
%\end{align*}
%

 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Computing the shear stress}
%\label{sec:shearStressLP}
%
%To calculate the shear stress, we need to know the gradient of double-layer potential in \eqref{StokesDLP2} 
%\begin{align*}\label{SSLP}
%\nabla\D[\boldsymbol\sigma]({\bf x})=\frac{1}{2\pi}\nabla\int_{\Gamma}&\frac{{\bf n_y}}{\rho^2}({\bf r} \cdot {\boldsymbol \sigma})ds_y+\frac{1}{2\pi}\nabla^2\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}({\bf y} \cdot{\boldsymbol \sigma})ds_y\\
%&-\frac{1}{2\pi}\nabla\left(x_1 \nabla\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\sigma_1ds_y\right)-\frac{1}{2\pi}\nabla\left(x_2\nabla\int_{\Gamma}\frac{{\bf r} \cdot {\bf n_y}}{\rho^2}\sigma_2ds_y\right). \numberthis
%\end{align*}
%
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Boundary evolution in the {\thL} framework} 
%\label{sec:thetaL}
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Solving the BIE}
%\label{sec:BIE}
%\subsubsection{Interior Case}
%Consider a Cauchy integral 
%\begin{align}\label{CIFI}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^-({ y})}{{ y}-{ x}} d{ y}
%&=\begin{cases}
%\,v(x), &{ x} \in \Omega,\\ 
%\,0,  &{ x} \in \Cdb\setminus \bar{\Omega}.
%\end{cases}
%\end{align}
%By the identity of Cauchy Integral Formula $\displaystyle\frac{1}{2 \pi i}\int_{\Gamma}\frac{1}{{ y}-{ x}} d{ y}=1,$ we can rewrtie \eqref{CIFI} and get 
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^-({ y})-v(x)}{{ y}-{ x}} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega.
%\end{equation}
%\begin{equation}\label{dNCI}
%v'({x})=\frac{1}{2\pi i}\int_{\Gamma}\frac{v^-({ y})}{(y- x)^2} d{ y},\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega.
%\end{equation}
%By the identity of Cauchy Integral Formula $\displaystyle\frac{1}{2 \pi i}\int_{\Gamma}\frac{1}{( y- x)^n} d{ y}=0$ for integer n $\neq 1$, we can rewrtie \eqref{dNCI} and get 
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^-({ y})-v(x)-(y-x)v'(x)}{(y-x)^2} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega.
%\end{equation}
%
%\subsubsection{Exterior case}
%Consider a Cauchy integral formula for the exterior domain
%\begin{align}\label{CIFE}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^+({ y})}{{ y}-{ x}} d{ y}
%&=\begin{cases}
%\,v_{\infty}, &{ x} \in \Omega,\\ 
%\,-v(x)+v_{\infty},  &{ x} \in \Omega^c,
%\end{cases}
%\end{align}
%where $v_{\infty}=\displaystyle\lim_{x \to \infty}v(x)$.
%\begin{equation}
%\frac{1}{x-a}=\frac{-1}{2 \pi i} \int_{\Gamma}\frac{(y-a)^{-1}}{y-x} d{ y},\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega^c.
%\end{equation}
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^+({ y})-(y-a)^{-1}(x-a)v(x)}{y-x} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega^c.
%\end{equation}
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{v^+({ y})-v(x)-(y-a)^{-1}(x-a)(y-x)v'(x)}{(y-x)^2} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega^c.
%\end{equation}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Shear stress}
%\label{sec:shearStress}
%\subsubsection{Interior Case}
%\begin{equation}\label{ddNCI}
%v''({x})=\frac{1}{2\pi i}\int_{\Gamma}\frac{2v^-({ y})}{(y- x)^3} d{ y},\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega.
%\end{equation}
%By the identity of Cauchy Integral Formula $\displaystyle\frac{1}{2 \pi i}\int_{\Gamma}\frac{1}{( y- x)^n} d{ y}=0$ for integer n $\neq 1$, we can rewrtie \eqref{ddNCI} and get 
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{2v^-({ y})-2v(x)-2(y-x)v'(x)-(y-x)^2v''(x)}{(y-x)^3} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega.
%\end{equation}
%\subsubsection{Exterior case}
%\begin{equation}
%\frac{1}{2\pi i}\int_{\Gamma}\frac{2v^+({ y})-2v(x)-2(y-x)v'(x)-(y-a)^{-1}(x-a)(y-x)^2v''(x)}{(y-x)^3} d{ y}=0,\,\,\,\,\,\,\,\,\, \forall { x} \in \Omega^c.
%\end{equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% TIME-STEPPING %%
%\subsection{Time-stepping with the {\thL} method} 
%\label{sec:timeStepping}
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Post processing quantities of interest}
%\label{s:qoi}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Vorticity}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Pressure}
%\label{sec:pressure}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Drag}
%\label{sec:drag}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Near-singular integration}
%\label{sec:NSI}
%
%
%{\color{red}
%Here we derive the equations~\eqref{eqn:pderiv1}-\eqref{eqn:pderiv2} 
%and the other two are similar.
%To derive equations~\eqref{eqn:pderiv1} and \eqref{eqn:pderiv2}, 
%we need to apply the fact that if a real function $u$ is equivalent to 
%the real part of a complex varaible function $f$, 
%then we have $\nabla u=(\Re(f'),-\Im(f'))$.
%Let $f_1(x)= v[\tau_1](x)$, $f_2(x)=v'[\yy\cdot\eeta](x)$, $f_3(x)=v'[\eta_1](x)$,
%and $f_4(x)= v'[\eta_2](x)$. Then we can rewrite equation~\eqref{eqn:cauchy1}
%\begin{align*}
%u_1(\xx)&= u_{11}(\xx) +  u_{12}(\xx) +u_{13}(\xx)+u_{14}(\xx) \\
%&=\Re (f_1(x)) + \Re (f_2(x))-x_1\Re (f_3(x)) - x_2\Re (f_4(x)).
%\end{align*}
%To get the gradient of $u_1(x)$, we have
%\begin{align*}
%\nabla u_1(x)&= \nabla u_{11}(x)+\nabla  u_{12}(x) 
%+\nabla u_{13}(x)+\nabla u_{14}(x) \\ \\
%&=\begin{bmatrix}
%\Re(f_1'(x))\\ \\
%-\Im(f_1'(x))
%\end{bmatrix}+
%\begin{bmatrix}
%\Re(f_2'(x))\\ \\
%-\Im(f_2'(x))
%\end{bmatrix}
%+
%\begin{bmatrix}
%-\Re(f_3(x))-x_1\Re(f_3'(x))\\ \\
%x_1\Im(f_3'(x))
%\end{bmatrix}
%+
%\begin{bmatrix}
%-x_2\Re(f_4'(x))\\ \\
%-\Re(f_4(x))+x_2\Im(f_4'(x))
%\end{bmatrix}\\ \\
%&=
%\begin{bmatrix}
%\Re (v'[\tau_1](x)) + 
%    \Re (v''[\yy\cdot\eeta](x)) - \Re (v'[\eta_1](x)) - 
%    x_1\Re (v''[\eta_1](x)) - x_2\Re (v''[\eta_2](x))\\ \\
%- \Im (v'[\tau_1](x)) - 
%    \Im (v''[\yy\cdot\eeta](x)) + x_1\Im (v''[\eta_1](x)) - 
%    \Re (v'[\eta_2](x)) + x_2\Im (v''[\eta_2](x))
%\end{bmatrix}.
%\end{align*}

%{\color{red}
%\begin{alignat}{3}
%1 &= \frac{1}{2\pi i}\int_{\Gamma} 
%    \frac{1}{y-x} dy, &&x \in \Omega, \label{eqn:cauchyId1}\\
%\frac{1}{x-a} &= \frac{-1}{2\pi i}\int_{\Gamma} 
%    \frac{(y-a)^{-1}}{y-x} dy,  \quad &&x \in \Omega^c\label{eqn:cauchyId2}. 
%\end{alignat}
%and the contour integral 
%\begin{align}\label{eqn:cauchyId3}
%0=\oint_{\Gamma} \frac{1}{(y-x)^n}dy, \quad n \neq 1.
%\end{align}
%Then we apply equations~\eqref{eqn:cauchyId1} and~\eqref{eqn:cauchyId3} on
%the second derivative of Cauchy integral in \eqref{eqn:cauchy} and get
%\begin{align*}
%0 &= \frac{1}{2\pi i} \int_{\Gamma}
%    \frac{2v^-(y)}{(y - x)^3} \, dy -v''(x)\\
%&= \frac{1}{2\pi i} \int_{\Gamma}
%    \frac{2v^-(y)}{(y - x)^3} \, dy 
%-v''(x)\frac{1}{2\pi i}\int_{\Gamma} 
%    \frac{1}{y-x} dy\\
%&= \frac{1}{2\pi i} \int_{\Gamma}
%    \frac{2v^-(y)}{(y - x)^3} \, dy 
%-\frac{1}{2\pi i}\int_{\Gamma} 
%    \frac{(y-x)^2v''(x)}{(y-x)^3} dy
%-\frac{1}{2\pi i}\int_{\Gamma} \frac{2v(x)}{(y-x)^3}dy
%-\frac{1}{2\pi i}\int_{\Gamma} \frac{2(y-x)v'(x)}{(y-x)^3}dy\\
%&= \frac{1}{2\pi i}\int_{\Gamma} 
%    \frac{2v^-({ y})-2v(x)-2(y-x)v'(x)-(y-x)^2v''(x)}{(y-x)^3} dy.
%\end{align*}
%}
%\todo[inline]{S-H: How do we get these identities?}
%\begin{alignat}{3}
%  0 &= \frac{1}{2\pi i}\int_{\Gamma} 
%    \frac{2v^-({ y})-2v(x)-2(y-x)v'(x)-(y-x)^2v''(x)}{(y-x)^3} dy, &&x \in \Omega, \\
%  0 &= \frac{1}{2\pi i}\int_{\Gamma}
%    \frac{2v^+(y)-2v(x)-2(y-x)v'(x)-(y-a)^{-1}(x-a)(y-x)^2 v''(x)}
%    {(y-x)^3} dy, \quad &&x \in \Omega^c.  \label{eqn:Identity}
%\end{alignat}
%{\color{red}
%and the quadrature formulations are
%\begin{alignat}{3}
%  v''(x) &\approx
%    \frac{2\sum\limits_{j=1}^N \frac{v_j^- -v(x)-(y_j-x)v'(x)}{(y_j-x)^3}w_j}
%    {\sum\limits_{j=1}^N \frac{1}{y_j-x}w_j}, &&x \in \Omega, \\
%  v''(x) &\approx \frac{1}{x-a}\frac{2\sum\limits_{j=1}^N
%    \frac{v_j^+ -v(x)-(y_j-x)v'(x)}{(y_j-x)^3}}{\sum\limits_{j=1}^N \frac{(y_j-a)^{-1}}{y_j-x}w_j}
%    , \quad &&x \in \Omega^c.  \label{eqn:SecondBary}
%\end{alignat}
%where $a$ is a point inside the $\Omega$ in equations~\eqref{eqn:Identity} and \eqref{eqn:SecondBary}.
%
%}


