\documentclass[11pt]{article}


\usepackage{todonotes}
\usepackage{fullpage}
\usepackage{amsmath,amsfonts,amssymb,stmaryrd}
\usepackage{color}
\newcommand{\comment}[1]{{\color{blue} #1}}

\begin{document}

\noindent
Dear Silas Alben,
\\ \\
\noindent
Thank you for handling the manuscript, and we would like to thank the
reviewer for their positive and constructive comments.  The attached
manuscript addresses all the reviewer's comments and the result is what
we believe is a stronger manuscript.  We also note that formatting
issues were resolved in the bibliography. An itemized list of the
changes addressing the reviewer's comments are below.
\\ \\
\noindent
Sincerely,
\\
\noindent
Shang-Huan Chiu, Nick Moore, and Bryan Quaife

\section*{Response to Reviewer 1}

\noindent
\comment{The Barycentric formulae (5.9 \& 5.10) for the first
derivatives of Cauchy integral are incorrect. They are NOT true
barycentric form and straightforward numerical experiments will show
that all accuracies are lost up to the boundary using these formulae,
even if $v(x)$ is computed to high accuracy using the formulae (5.6 \&
5.7). (See e.g.~Sec 3.3 of Barnett et.~al.~2015 for more details.)}
\begin{itemize}
  \item Leading up to equation (5.9) and (5.10), we removed all
    instances where we had previously claimed these quadrature rules
    were in Barycentric form.

  \item After equation (5.10), we now state:
    \begin{quotation}
      \noindent
      Note that $v(x)$ is required to compute $v'(x)$ for both the
      interior and exterior case, and this is available using the
      Barycentric quadrature rules (5.6) and (5.7). As pointed out by
      Barnett {\em et al.}~(2015), equations (5.9) and (5.10) are not in
      a Barycentric form since the numerators suffer from catastrophic
      cancellation as $x$ approaches $\partial\Omega$. The result is
      that the quadrature error is not uniformly bounded. However, since
      these errors are sufficiently small for the geometries and
      resolutions we consider, we use these quadrature formulas
      nonetheless. We note that the quadrature formulas can be put into
      true Barycentric form (Barnett {\em et al.}~2015, see equations
      (3.11) and (3.13)), but this increases the complexity for
      evaluating $v'(x)$ to $O(N^2)$ operations. 
    \end{quotation}

\end{itemize}

\noindent
\comment{Likewise, the second derivative ``barycentric formulae" (5.15 \& 5.18) are incorrect, either. So the authors will need to explain how they managed to get high accuracies with the stated formulae?}
\begin{itemize}
  \item Leading up to equation (5.15) and (5.18), we removed all
    instances where we had previously claimed these quadrature rules
    were in Barycentric form.

  \item We have also updated the text so that it does not give the
    impression that the error is uniformly bounded. However, for the
    geometries and resolutions we consider, we found that the
    non-Barycentric form quadrature rules are accurate enough to compute
    the necessary quantities at the target points that are required to
    perform the subsequent analysis in the paper.

  \item After equation (5.18), we now state:
    \begin{quotation}
      \noindent
      These quadrature formula are also not in a Barycentric form
      because of catastrophic cancellation in the numerator. As is the
      case when computing $vâ€²(x)$, this error is sufficiently small at
      the geometries and resolutions we consider, so we use these
      quadrature formulas.
    \end{quotation}

  \item To make it clear which quadrature methods we apply, we have
    added the following paragraph to the end of Section 5.2:
    \begin{quotation}
      \noindent
      In section 6, the quadrature rules (5.6), (5.7), (5.9), (5.10),
      (5.15), and (5.18) are used to form simulations of nearly-touching
      eroding grains, and to study dynamics of the flow in regions
      arbitrarily close to eroding grains.
    \end{quotation}

  \item In the second paragraph of Section 5.2, we updated the last
    sentence to read:
    \begin{quotation}
      \noindent
      After briefly summarizing this method, we compute the second
      derivative so that the shear stress and vorticity can be
      accurately computed.
    \end{quotation}

  \item We start Section 5.3 with the following revised sentence:
    \begin{quotation}
      \noindent
      By using these quadrature rules, the velocity, shear stress, and
      vorticity are calculated at the target points necessary to
      simulate erosion and transport.
    \end{quotation}

\end{itemize}

\noindent
\comment{In my opinion, the claim of having developed a ``new quadrature
method" is too strong. After all, there is nothing new about the
barycentric quadrature itself. Rather, I suggest that maybe a more
appropriate claim would be that the authors have developed a ``new
numerical scheme" for the Stokes porous media flow, where the accurate
quadrature is one ingredient in this scheme.}
\begin{itemize}
  \item We have toned down some of the claims. The following modified
    paragraphs and sentences are in the revised manuscript:
    \begin{quotation}
      \noindent
      In previous work (Quaife \& Moore 2018), the BIE is discretized
      with the trapezoid rule, and this is acceptable if the grains that
      are sufficiently separated (Trefethen \& Weideman 2014). However,
      when grains are close, the result is a nearly-singular integrand
      and the error of the trapezoid rule is no longer acceptable. One
      of the earliest quadrature methods for nearly-singular integrands
      was developed by Baker \& Shelley (1986), and in recent years,
      many other schemes have followed (af Klinteberg \& Tornberg 2018;
      Helsing \& Ojala 2008; Beale {\em et al.}~2016; Beale \& Lai 2001;
      Kl\"{o}ckner {\em et al.}~2013). We use a Barycentric quadrature
      method (Barnett 2014; Barnett {\em et al.}~2015) since it is a
      non-intrusive modification of the trapezoid rule, and the error is
      guaranteed to be uniformly bounded. We use this quadrature method
      to compute the velocity gradient, which is needed to evaluate the
      shear stress and the fluid vorticity.
    \end{quotation}

    \begin{quotation}
      \noindent
      Section 5 describes the numerical methods, with special attention
      paid to the quadrature method for computing the shear stress and
      the vorticity.
    \end{quotation}

    \begin{quotation}
      \noindent
      As a continuation of our previous work (Quaife \& Moore 2018), we
      have simulated dense suspensions and characterized transport in
      viscous eroding porous media. This is accomplished by using
      high-order time stepping methods and a combination of trapezoid
      and Barycentric quadrature methods to solve a BIE formulation of
      the Stokes equations. By using these numerical methods, we are
      able to perform stable simulations of erosion with $N = O(100)$
      discretization points, while the trapezoid rule would require
      $O(10^5)$ discretization points.
    \end{quotation}
\end{itemize}


\noindent
\comment{The transient increase of tortuosity is interesting, but the
explanation in Sec 6.4 is not satisfying. The authors proposed that the
increase of tortuosity can be explained by the sudden increase of
$x$-velocity when a grain vanishes. But in formula (4.4) or (4.5), the
$x$-velocity appears both in the numerator and the denominator, which
seems to me that the increase would just cancel. Then, as the authors
have pointed out, wouldn't the straighter streamlines resulted from the
vanishing of grains have decreased the tortuosity?}
\begin{itemize}
  \item response
\end{itemize}

\noindent
\comment{The porosity-tortuosity models (4.6c \& 4.6d) are not
explicitly compared in the results section. How much worse are they
comparing to the other models?}
\begin{itemize}
  \item We have adjusted each of the appropriate sections.

  \item In Section 6.2, we have added the following sentence:
    \begin{quotation}
      \noindent
      A slightly larger root-mean-square error of $6.70 \times 10^{-3}$
      is possible with the logarithmic porosity-tortuosity model (4.6b),
      but the other two models have a root- mean-square error that is an
      order of magnitude larger.
    \end{quotation}


  \item In Section 6.3, we have added the following sentence:
    \begin{quotation}
      \noindent
      However, the root-mean-square error of the other three models is
      bounded by $2.38 \times 10^{-2}$.
    \end{quotation}

  \item In Section 6.4, we have added the following sentence:
    \begin{quotation}
      \noindent
      We also compute the lines of best fit using the
      porosity-tortuosity models (4.6).  Each of the models result in a
      root-mean-squared error ranging from $4.60 \times 10^{-3}$ for
      model (4.6c) to $7.20 \times 10^{-3}$ for model (4.6c). The black
      dashed line in figure 15(a) is the line of best fit
      $\widehat{T}(\phi) = \phi^{-0.2459}$, with a root-mean-square
      error of $5.50 \times 10^{-3}$.  We note a slightly better
      root-mean-square error of $4.60 \times 10^{-3}$ is possible with
      the model $\widehat{T}(\phi) = \left(1 + 0.1499(1-\phi)\right)^2$.
    \end{quotation}

\end{itemize}

\noindent
\comment{The coefficient CE in equation (2.1) is undefined.}
\begin{itemize}
  \item Thank you for pointing this out. We also realized that $\mu$ is
  undefined. We now state:
  \begin{quotation}
    \noindent
    Parameters include the fluid viscosity $\mu$ and the
    material-dependent erosion constant $C_E$. By non-dimensionalizing
    equations (2.1) (Quaife \& Moore 2018), we set both these parameters
    to one.
  \end{quotation}
\end{itemize}

\noindent
\comment{Should the shear stress formula (2.2) contain viscosity in it
based on the governing equation (2.1)?}
\begin{itemize}
  \item In general, it would. However, since we have non-dimensionalized
    following our previous work, the viscosity is assumed to be 1.
\end{itemize}

\noindent
\comment{In Figure 5, do the colors represent vorticity itself or the
log of the abs vorticity? (Which would be consistent with the colors in
Figure 4.)}
\begin{itemize}
  \item The color represents the logarithm of the absolute value of the
    vorticity.
  \item We have updated the caption to read:
    \begin{quotation}
    \noindent
      The eroded bodies from figure 4 at time $t = 0.1$. The color is
      the logarithm of the magnitude of the vorticity. The initial
      distances from the body to the solid wall are: (a) $h$, (b) $h/2$,
      and (c) $h/10$.
    \end{quotation}
  \item We have also updated the text to read:
    \begin{quotation}
    \noindent
      To visualize the flow, in figure 5 we plot the logarithm of the
      absolute value of the vorticity from the final time step in figure
      4.
    \end{quotation}
\end{itemize}

\noindent
\comment{When first introduced in Sec 4.3, the ``pore sizes" are not
clearly defined. (My first impression was that pore size = portion of an
edge of the Delaunay diagram. Only at the end in Sec 6.4 do we know that
it is defined as the closest distance between grains.)}
\begin{itemize}
  \item In Figure 3, we clarify the definition by adding the statement:
    {\em represented by the length of the red line segments}.
  \item In the text, we now state:
    \begin{quotation}
    \noindent
      Finally, we define the pore sizes to be the minimum distance
      between all pairs of neighboring grains, and these distances are
      represented by the red line segments in figure 3(a).
    \end{quotation}
\end{itemize}

\noindent
\comment{``Porosity" is undefined throughout the paper.}
\begin{itemize}
  \item We have now formally defined the porosity by rewriting the
    description of coarse-grained models as:
  \begin{quotation}
  \noindent
    Examples of coarse-grained models for porous media flow include
    tortuosities (Matyka {\em et al.}~2008; Duda {\em et al.}~2011;
    Koponen {\em et al.}~1996), geometry connectivity (Knudby \& Carrera
    2005), anomalous dispersion (Dentz {\em et al.}~2004), and
    permeability-porosity relationships (Dardis \& McCloskey 1998;
    Carman 1937), where the porosity is the fraction of the geometry
    that is fluidized.
  \end{quotation}


\end{itemize}

\noindent
\comment{``Area fraction" is plotted in (and only in) Figure 7, while
the rest of the paper used porosity. Maybe plotting porosity here would
give a more consistent and smoother reading experience?}
\begin{itemize}
  \item We examined the area fraction and flow rate in figure 7 so that
    it could be compared to results from our previous work. The goal is
    to demonstrate that we now able to resolve smaller area fractions
    and correspondingly lower flow rates.

  \item We have updated the text to read:
    \begin{quotation}
      \noindent
      In our previous work (Quaife \& Moore 2018), we investigated the
      effects of erosion on the area fraction and flow rate of two
      different geometries. Here, we do the same analysis, but with the
      denser packing of the grains.
    \end{quotation}

\end{itemize}


\end{document}
