\documentclass[preprint, 10pt]{elsarticle}

\newcommand{\mcaption}[2]{\caption{\small \em #1}\label{#2}}
\newcommand{\secref}[1]{\ref{#1}}

\input{preambles.tex}
\begin{document}

\title{Methods paper for erosion}

\author[Nick]{M.~Nicholas J.~Moore}
\author[Bryan]{Bryan D.~Quaife}
\address[Nick]{Department of Mathematics and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}
\address[Bryan]{Department of Scientific Computing and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}

\begin{abstract} 
We consider two dimensional eroding bodies in Stokes flow
\end{abstract}

\begin{keyword}
  Stokes flow \sep Erosion \sep Boundary integral method \sep
  Fluid-structure interaction \sep Fast multipole methods 
\end{keyword}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction\label{s:intro}}

This is a methods paper
\begin{itemize}
  \item Boundary integral equation formulation
  \item How we compute the shear stress and pressure
  \item Multiple bodies
  \item Avoiding stokes paradox
  \item $\theta-L$ formulation
  \item Regularization
\end{itemize}

\cite{moo-ris-chi-zha-she2013}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Formulation\label{s:formulation}} 
We consider multiple bodies being eroded by a two-dimensional Stokesian
fluid.  The Stokes paradox is circumvented by using a rounded-off
rectangle that encloses the eroding bodies.  Then, the flow is driven
by a boundary conditions, such as a Hagen-Poiseuille flow, on the
boundary of the outer geometry \todo[inline]{Need a figure here}
\begin{subequations}
\label{eqn:erosionModel}
\begin{gather}
eqn1 \label{eqn:eqn1} \\
eqn2 \label{eqn:eqn2} \\
\pderiv{\xx}{\nn} = -|\tau| \label{eqn:poreEvolution}
\end{gather}
\end{subequations}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Erosion Model} 
\todo[inline]{Governing equations}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boundary Integral Equation Formulation} 
The incompressible Stokes equations are
\begin{alignat*}{3}
  \mu\Delta \uu &= \grad p, \qquad && \xx \in \Omega, \\
  \grad \cdot \uu &= 0,   && \xx \in \Gamma.
\end{alignat*}
The viscosity $\mu$ sets the time scale, and we will assume that
$\mu=1$.  The double-layer potential
\begin{align}
  \DD[\eeta](\xx) = \frac{1}{\pi} \int_{\Gamma} 
    \frac{\rr \cdot \nn}{\rho^2} \frac{\rr \otimes \rr}{\rho^2} 
    \eeta \, ds_\yy, \quad \xx \in \Omega,
    \label{eqn:velocityDLP}
\end{align}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, and $\nn$ is the unit outward
normal, solves the incompressible Stokes equations for any sufficiently
smooth density function $\eeta$.  However, the double-layer potential can not capture velocity fields
corresponding to rigid body motions~\cite{pow-mir1987}.  A standard
method to complete the double-layer potential is to introduce a
Stokeslet and rotlet due to each interior body
\begin{align}
  S[\llambda_k,\cc_k] = \frac{1}{4\pi} \left(-\log \rho \II + 
    \frac{\rr \otimes \rr}{\rho^2} \right)\llambda_k
  \quad \text{and} \quad
  R[\xi_k,\cc_k] = \frac{\rr^\perp}{\rho^2}\xi_k,
  \label{eqn:stokeslet_rotlet}
\end{align}
where $\cc_k$ is a point in the interior of $\Omega_k$, $\rr = \xx -
\cc_k$, and $\rr^\perp = (r_2,-r_1)$.  Then, the solution of the Stokes
equations with a Dirichlet boundary condition $\ff$ can be written in
terms of the completed double-layer potential
\begin{align}
  \uu(\xx) = \DD[\eeta](\xx) + \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
              \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx), \quad \xx \in \Omega,
  \label{eqn:completedDLP}
\end{align}
where the density function, Stokeslets, and rotlets satisfy the
second-kind integral equation
\begin{subequations}
\label{eqn:completed_DLP}
\begin{align}
  \ff(\xx) &= -\frac{1}{2}\eeta(\xx) + \DD[\eeta](\xx) + 
      \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
      \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx), \quad \xx \in \Gamma, 
      \label{eqn:DLP}\\
  \llambda_k &= \frac{1}{2\pi}\int_{\Gamma_k} \eeta(\yy) \, ds_\yy, 
  \label{eqn:stokeslet} \\
  \xi_k &= \frac{1}{2\pi}\int_{\Gamma_k} \yy^\perp \cdot \eeta(\yy)
  \, ds_\yy.
  \label{eqn:rotlet}
\end{align}
\end{subequations}
Finally, because of the incompressibility constraint, the boundary
condition must satisfy 
\begin{align}
  \int_{\Gamma} \ff \cdot \nn \, ds_\yy = 0.
\end{align}
This results in a rank-one null space of
equation~\eqref{eqn:completed_DLP} which we remove by adding the rank
one modification $\NN_0[\eeta](\xx) = \int_{\Gamma_0} (\nn(\xx) \times
\nn(\yy))\nn(\yy) \, ds_\yy$, for $\xx \in \Gamma_0$.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computing the Shear Stress, Pressure, and Drag} 
The governing equations~\eqref{eqn:erosionModel} require the shear
stress which is defined on the boundary of each pore.  The shear stress
is given by
\begin{align}
  \tau = \left(\nabla \uu + \nabla \uu^T \right)\nn \cdot \ss,
  \label{eqn:shearStress}
\end{align}
where $\ss$ is the unit tangent vector.  We note that for the Stokes
equations, because of the no-slip boundary condition on the pores, the
shear stress is identical to the surface vorticity $\tau = u_y - v_x$.
However, we use equation~\eqref{eqn:shearStress} to compute the shear
stress since the jump conditions resulting from the double-layer
potential are known~\cite{qua-bir2014a}.  The velocity field of the
completed double-layer potential involves three terms: the double-layer
potential $\DD$, the Stokeslets $S$, and the rotlets $R$.  To compute
the shear stress, we first compute the deformation tensor $\ssigma =
\frac{1}{2}(\nabla\uu + \nabla\uu^T)$ of each of these terms
individually.

Considering the double-layer potential~\eqref{eqn:velocityDLP} evaluated
at $\xx \in \Omega$, the deformation tensor is
\begin{align}
  \ssigma^\DD(\xx) = \int_{\bd\Omega} K_\ssigma(\xx,\yy) \eeta(\yy) \,ds_\yy,
  \label{eqn:shearStressDLP}
\end{align}
where the kernel $K_\ssigma$ is given by
\begin{align*}
  K_\ssigma(\xx,\yy) = \frac{1}{2\pi}\left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn) +
    \frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right).
\end{align*}
We are interested in the deformation tensor at boundary points $\xx_0
\in \bd\Omega$, and this requires an expression for the jump in
$\ssigma^\DD(\xx)$ as $\xx \rightarrow \xx_0 \in \Gamma$.  The limiting
value is given by~\cite{qua-bir2014a}
\begin{align}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}\sigma_\DD(\xx) =
  J[\eeta](\xx_0) + \ssigma^\DD(\xx_0) = 
  \frac{1}{2}\pderiv{\eeta}{\ss} \cdot \ss
  \left[ \begin{array}{cc}
    s_x^2 - s_y^2 & 2s_x s_y \\ 2s_x s_y & s_y^2 - s_x^2
  \end{array}\right] + \ssigma^\DD(\xx_0), \quad \xx_0 \in \Gamma.
\end{align}

The deformation tensor due to the Stokeslets and rotlets in
equation~\eqref{eqn:stokeslet_rotlet} are
\begin{align}
  \ssigma^S(\xx_0) &= \frac{\rr \cdot \llambda}{4\pi\rho^2} \left(
    \II - \frac{2}{\rho^2} \rr \otimes \rr \right),  \\
  \ssigma^R(\xx_0) &= -\frac{\xi}{\rho^4} \left(\rr \otimes \rr^\perp + 
                           \rr^\perp \otimes \rr \right).
\end{align}
Now that the deformation tensor of each component of the completed
double-layer potential are computed, the shear stress at $\xx_0 \in
\Gamma$ can be computed as
\begin{align}
  \tau = \left(J[\eeta](\xx_0) + \ssigma^\DD(\xx_0) + 
    \ssigma^S(\xx_0) + \ssigma^R(\xx_0)\right) \nn \cdot \ss.
\end{align}

To compute the pressure at $\xx_0 \in \Gamma$, we follow the same
procedure used for the shear stress.  In particular, we compute the
pressure due to each of the three terms that compose the completed
double-layer potential.  They are given by
\begin{align}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}p^\DD(\xx) =  
  -\pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0),
\end{align}
where
\begin{align}
  p^\DD(\xx) = -\frac{1}{\pi}\int_{\Gamma} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot \eeta(\yy) \,ds_\yy.
\end{align}
The pressure due to the Stokeslets is
\begin{align}
  p^S(\xx_0) = \frac{\rr \cdot \llambda}{2\pi\rho^2},
  \label{eqn:pressureDLP}
\end{align}
and the velocity due to a rotlet is pressure-free.  Therefore, once the
density function and Stokeslets are computed, the pressure at a point
$\xx_0 \in \Gamma$ is
\begin{align}
  p(\xx_0) = -\pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0) + 
              \frac{\rr \cdot \llambda}{2\pi\rho^2}.
\end{align}

Finally, with the pressure and shear stress, the drag on a single pore
with boundary $\Gamma_k$ is
\begin{align}
  F_D = \int_{\Gamma_k} (-p \nn + \tau \ss)\,ds.
\end{align}

\todo[inline]{Describe convention for normal and tangent vectors}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Methods\label{s:method}} 
We discretize the second-kind integral equation~\eqref{eqn:DLP} using a
Nystr\"om method.  The equations for the
Stokeslets~\eqref{eqn:stokeslet} and rotlets~\eqref{eqn:rotlet} are
approximated with the trapezoid rule.  By applying a quadrature method,
this results in a dense linear system which we solve with fast multipole
accelerated GMRES.  Because of the second-kind nature of the integral
equation, the number of GMRES iterations is mesh independent (but not
geometry independent), and the overall complexity of the Stokes solver
is proportional to the cost of a single matrix-vector multiplication.
The shear stress, pressure, and drag must also be computed using
quadrature, and this can be interpreted as a post-processing step once
the density function, Stokeslets, and rotlets are computed.  All the
quadrature methods are described in Section~\ref{sec:quadrature}

Once the shear stress is computed, it is used to update the shape of the
pores according to the normal flow~\eqref{eqn:poreEvolution}.  To
eliminate tangling and stretching of the mesh, we use a $\theta-L$
formulation~\cite{hou-low-she1994} which is described in
Section~\ref{sec:thetaL}.  In this section, we also describe our time
stepping method and two regularization terms that are necessary to
control the curvature of the pores and to maintain spectral accuracy in
space.

\todo[inline]{Describe the upcoming subsections better}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quadrature} 
\label{sec:quadrature}
There are several integrals that we need to compute including the
double-layer potential velocity field~\eqref{eqn:velocityDLP}, the shear
stress~\eqref{eqn:shearStressDLP}, and the
pressure~\eqref{eqn:pressureDLP}.  By using carefully choosing the
quadrature rules, high-order solutions can be computed.  For all the
integrals, the trapezoid rule is used since it achieves spectral
accuracy for smooth periodic functions.  However, care must be taken
when the source point and target points coincide.

For the velocity field, the kernel of the integral operator
\begin{align}
  D(\xx,\yy) = \frac{\rr \cdot \nn}{\rho^2} 
               \frac{\rr \otimes \rr}{\rho^2}
\end{align}
has a removable singularity when $\xx = \yy$.  In particular
\begin{align}
  \lim_{\substack{\yy \rightarrow \xx \\ \yy \in \Gamma}} D(\xx,\yy) = 
  \frac{\kappa(\xx)}{2\pi}\ss \otimes \ss,
\end{align}
where $\kappa(\xx)$ is the curvature of $\Gamma$ at $\xx$.  By using
this limiting term in when applying the trapezoid rule, spectral
accuracy is achieved because of the smoothness and periodicity of the
integrand~\cite{tre-wei2014}.

For the shear stress and the pressure, we will use odd-even integration
which achieves spectral accuracy if the integrand is no stronger than
$\mathcal{O}(\rho^{-1})$.  Since both these integrands are too strong,
the singularity must be weakened.  This can be done by adding a constant
density function which has no effect on the shear stress and
pressure~\cite{}.  In particular, the shear stress due to the
double-layer potential is equivalent to
\begin{align}
  \ssigma^{\DD}(\xx_0) &= \int_{\bd\Omega}K_\ssigma(\xx_0,\yy)
      \ssigma(\yy) \, ds_{\yy} \\ 
      &= \int_{\bd\Omega}K_\ssigma(\xx_0,\yy)
      (\ssigma(\yy) - \ssigma(\xx_0)) \, ds_{\yy}.
\end{align}
For the pressure, the double-layer potential is equivalent to
\begin{align}
  p^\DD(\xx) = -\frac{1}{\pi}\int_{\Gamma} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot (\eeta(\yy) - \eeta(\xx_0)) \,ds_\yy.
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Fast Summation} 
All the layer potentials are compatible with a fast summation such as
the Fast Multipole Method (FMM).  The majority of the 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{$\theta-L$ Formulation} 
\label{sec:thetaL}

We use a quasi-static approximation so that the velocity field
instantaneously changes with the changing geometry.  Therefore, we can
alternate between the two main aspects of our simulation
\begin{enumerate}
  \item Given a geometry, compute the shear stress of along each of the
  pores.
  \item Given the shear stress, update the geometry according to the
  erosion model.
\end{enumerate}

\todo[inline]{Artificial Diffusion} 
\todo[inline]{Gaussian Filter} 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results\label{s:results}} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions\label{s:conclusions}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
\section{Error estimates for near-singular integration \label{A:AppendixA}} 
\end{appendices}


\bibliographystyle{plainnat} 
\bibliography{refs}
\biboptions{sort&compress}
\end{document}


