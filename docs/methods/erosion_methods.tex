\documentclass[preprint, 10pt]{elsarticle}

\newcommand{\mcaption}[2]{\caption{\small \em #1}\label{#2}}
\newcommand{\secref}[1]{\ref{#1}}

\input{preambles.tex}
\begin{document}

\title{Viscous Erosion in Porous Media}

% OTHER TITLE POSSIBILITIES
% A fast and accurate method for viscous erosion in a 2D porous medium

\author[Bryan]{Bryan D.~Quaife}
\author[Nick]{M.~Nicholas J.~Moore}
\address[Nick]{Department of Mathematics and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}
\address[Bryan]{Department of Scientific Computing and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}

\begin{abstract} 
We develop numerical methods to simulate the fluid-mechanical erosion of many bodies (order 50) in 2D Stokes flow. The broad aim is to simulate the erosion of a porous medium (e.g.~ground water flow) with resolution at the grain scale. Our fluid solver is based on a boundary-integral formulation of the Stokes equations with a double-layer potential. We solve the associated linear system iteratively using GMRES and the fast-multipole method (FMM) for acceleration. Since the underlying integral equation is second-kind, GMRES achieves a bounded iteration count (independent of the number of unknowns). To evolve the individual grains under shear-driven erosion, we regularize via curvature-penalization and solve the associated system using the {\thL} formulation. This framework allows numerically stable treatment of stiff terms, thus permitting large time steps. The overall accuracy of our method is exponential in space and second-order in time. The method is computationally efficient, with the main part of the solver having an $O(N)$ cost, and a one-time $O(N^2)$ computation. We benchmark single-body results against analytical predictions. In our multi-body simulations, we find that erosion leads to spontaneous channelization between bodies in near contact. The channelization is associated with a dramatic reduction in the resistance of the porous medium, much more than would be expected from the reduction in grain size alone.
\end{abstract}

\begin{keyword}
  Stokes flow \sep Erosion \sep Boundary integral method \sep Shear
  stress \sep {\thL} formulation
\end{keyword}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction\label{s:intro}}

Erosion is a fluid-mechanical process responsible for a variety
of phenomena in geophysical and other settings.  For example,
wind erosion causes sand dunes to be  longer on the windward
side~\cite{han1969}, while stream-bed erosion is responsible for branching structures
of rivers~\cite{coh-dev-sey-yi-szy-rot2015}.  Erosion is
also important in biophysical applications, for example plaque erosion in arteries
is key to understanding heart disease~\cite{sha2002,
gro-gij-van-fer-hat-van-yua-wen2007}, and the separation of biofilms can
be explained by erosion~\cite{pic-van-hei2000}. 
Much recent work has been devoted to understanding fundamental aspects of the fluid-structure interaction that occurs during the erosion \cite{ris-moo-chi-she-zha2012, moo-ris-chi-zha-she2013, mit-spa2016, hewett2017evolution, moore2017riemann, lachaussee2018competitive, lopez2018cfd}, and related processes like dissolution or melting \cite{Huang2015, kondratiuk2015steadily, rycroft2016asymmetric, cohen2016erosion, yuan2017dynamics, claudin2017dissolution, hewett2017pear}. All of these processes involve a feedback process between how boundaries move and how flow evolves and thus can be conceptually linked  as `sculpting with flow' \cite{ristroph2018sculpting}.
% Later, we can take out a lot of these references, especially ones that are cited elsewhere in the paper. For example, Mitchell and Spagnolie and several of my papers are cited elsewhere.


Another application, which motivates the current work, is erosion caused by groundwater flow.
Here, a slow moving fluid erodes channels in the ground, and this
affects the fluid transport.  In all these examples, there is a feedback
process between the flow and the eroding bodies---the shape of the
bodies affect the flow, while the flow changes the shape by fluidizing
each body.  This fluid-mechanical feedback system has been simulated in
idealized cases such as a single eroding two-dimensional body in a
uniform flow~\cite{moo-ris-chi-zha-she2013} or a single mobile eroding
three-dimensional body~\cite{mit-spa2016}. However, to better understand
the effect of erosion on groundwater flow, multiply-connected domains
must be considered.  Here we simulate two-dimensional erosion, in
multiply-connected domain such as the porous geometry of many
groundwater flows (Fig.~\ref{fig:50bodies}).

Because of the length and velocity scales of groundwater flow, we
restrict our attention to small Reynolds number flows.  For groundwater
flow, Darcy's law is often used, but this does not resolve the pore
structure and assumes a homogeneous geometry which is often not valid.
Instead, we use the incompressible Stokes equations to represent the
flow, and the individual pores are resolved which results in a complex
multiply-connected geometry.  A boundary integral equation (BIE) is
well-suited for solving the incompressible Stokes equations in a complex
geometry since it can resolve individual grains and the non-negligible
interactions between bodies are resolved. Moreover, high-order accuracy
and computational efficiency are obtained. To link the eroding body and
fluid dynamics, the body is eroded in the normal direction at a rate
that is proportional to the magnitude of the shear
stress~\cite{ris-moo-chi-she-zha2012}.  Tracking the interface of
fluid-structure interaction problems with a long time horizon is
particularly (???) ---the mesh is often distorted and tangled by the dynamics
and regions of high curvature develop.  These two issues are resolved
by, first, introducing a tangential velocity field to maintain a grid
that is equispaced in arclength, but that does not affect the dynamics,
and, second, a curvature penalization term.  Furthermore, the frame of
reference is changed to \thL~variables so that the curvature term
appears as a diffusive term that can easily be handled in a 
numerically stable fashion, e.g.~via an exponential integrator or an implicit method.

In addition to simulating the eroding grains, the flow is further
characterized by computing the vorticity in the flow.  The vorticity is
particularly insightful since it is identical to the shear stress on
no-slip boundaries.  Therefore, by computing the
vorticity, we are able to locate regions where the erosion rates will be
fastest or slowest.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Contributions} The present study develops numerical methods
to simulate erosion of multiply-connected two-dimensional geometries.
Since groundwater flow occurs at small spatial and velocity scales, we
assume the flow is viscous (ie.~zero Reynolds number).  By allowing for
complex multiply-connected domains, we capture the effect that
interacting bodies have on erosion, and the grains in the flow are
individually resolved rather than homogenized.  We start by validating
our method on a single circular body placed symmetrically in a CHANNEL
flow.  By artificially fixing the area of the body as a function of
time, we are able to characterize the long-time behavior of the shape
and the resulting flow and compare these results with analytical
results.  Then, we compute the vorticity of erosion in
multiply-connected geometries to better characterize erosion in porous
media. 

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.9 \textwidth]{./figs/50bod.pdf}
\caption{\label{fig:50bodies} A time lapse of 50 bodies eroding in a
viscous flow.  The boundary conditions are a constant pressure drop that
creates a flow from the left to right.  The rate of erosion is
proportional to the shear stress which is equivalent to the vorticity
evaluated on the bodies.  The colors represent the vorticity, so regions
with large vorticity (in magnitude) are regions where the flow will
erode the fastest.}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure generated from data file 50circ512p5, 
%which uses 50circ512.in with epsfac = 30, sigfac = 10, dt = 1e-4, fixpdrop = 1

To create high-fidelity and computationally efficient numerical methods,
two fast and accurate methods are employed.  First, the fluid equations
and the erosion rate (shear stress) are efficiently solved with spectral
accuracy by using a fast-multipole-accelerated BIE method.  Given the
rate of erosion, the shape is integrated in time with second-order
accuracy.  All spatial derivatives are be computed in Fourier space,
resulting in spectral accuracy in space.  To further visualize the
effect of erosion, we compute the vorticity of the flow
(Fig.~\ref{fig:50bodies}) to visualize regions of high and low erosion.

A challenge with erosion is that it creates corners at points on the
body where the shear stress vanishes.  There is recent work for solving
BIEs in geometries with corners by using
carefully chosen local expansions around each corner~\cite{rac-ser2017,
ser-rok2016} or panel-based graded meshes~\cite{hel2011,
gil-hao-mar2014, bre2012}.  The limitation of these methods is that they
require the corner's location, a non-uniform spaced mesh, and some of
the methods have a large condition number.  One solution is to use two
meshes---one for the quadrature the other for the interface tracking.
Then, interpolation between the two grids is required, and this is the
approach taken by Ojala and Tornberg~\cite{oja-tor2015}.  Instead of
using two grids and interpolation operators, we only require the uniform
grid by slightly modify the geometry to maintain sufficient regularity.
First, we add a regularization term to the shear stress to penalize
regions of high curvature.  Second, we apply a Gaussian filter to smooth
the absolute value of the shear stress before the body shape is updated.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Limitations} 

%\todo[inline]{These are some of my thoughts on reworking this first paragraph. See if you like it.}
We begin by making two fundamental design choices: first, we restrict
ourselves to two spatial dimensions, and second the bodies are
considered immobile (i.e.~fixed to their initial locations). The
restriction to 2D allows us to simulate the erosion of many bodies
(up to $50$ in this manuscript) with high resolution, giving us the
ability to accurately characterize the erosion of a porous medium. While
BIEs are available in 3D, the extra computational cost limits the number of bodies that could be practically simulated, making porous-medium simulations less feasible. The second assumption of immobile bodies affords a simple framework to study the effects of erosion in isolation. While other effects, such as sedimentation or transport, undoubtedly play a role in real applications, these effects would introduce additional complexity, both conceptually and numerically. 

%\todo[inline]{This is the original below:}
%There are two main limitations of the current
%work.  First, the flow is assumed to be two-dimensional.  However, by
%assuming that the flow is two-dimensional, we are able to simulate the
%erosion of more bodies and with higher resolution than would be
%available in three dimensions.  Moreover, several flows can be described
%to good accuracy under a two-dimensional approximation, but certain
%phenomena occur only in three dimensions.  Extending the current work to
%three dimensions is possible with a boundary integral equation
%formulation.  In particular, the fluid solvers exist~\cite{mal-bir2015},
%and the main challenges of a BIE solver have been addressed by other
%groups including surface representation~\cite{yin-bir-zor2006,
%vee-rah-bir-zor2011}, near-singular integration~\cite{yin-bir-zor2006,
%kli-tor2016b}, and fast summation methods~\cite{yin-bir-zor2004,
%ros-ols2015}.  The more significant challenge of extending our work to
%three dimensions is guaranteeing that the mesh does not become
%distorted, which can be done, for example, by using an extension of the
%two-dimensional {\thL} formulation~\cite{amb-sie-tlu2013}.
%
%The second limitation is that the eroding bodies are fixed.  Mitchell
%and Spagnolie~\cite{mit-spa2016} simulate a single mobile eroding body
%in three dimensions~\cite{mit-spa2016}, but additional challenges are
%caused when there are multiple bodies. In particular, especially in
%dense suspensions, bodies can become extremely close to one another, and
%the interaction between the bodies is difficult to resolve unless the
%underlying mesh is refined to levels that are intractable. In future
%work we plan to consider mobile eroding bodies by including a small
%force and torque to prevent unphysical contact~\cite{lu-rah-zor2017}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Related work} Simulating eroding bodies has been studied
analytically, experimentally, and numerically.  Because of the scales
involves with geophysical flows, most of these works consider high
Reynolds number flows.  For instance, the experimental work of Moore et
al.~\cite{moo-ris-chi-zha-she2013} considers on the order of $10^4$.
For low Reynolds number flows, Mitchell and Spagnolie~\cite{mit-spa2016}
simulate the erosion of a mobile body in three dimensions, but they only
consider single body.  

Mitchell and Spagnolie~\cite{mit-spa2016} formulate the traction jump as
a DLP using Lorentz Reciprocal Theorem so that additional layer
potentials have to be evaluated.  That is, they never find the density
function.

The effect of erosion on a geometry is quite rich.  For instance, it has
been hypothesized and numerically observed that the erosion leads to a
shear stress that is uniform on the body which results in a uniform
erosion rate.  The shape that has a uniform shear stress is analyzed in
three dimensions by Montenegro-Johnson and Lauga~\cite{mon-lau2015}
which is an extension of the analysis done by Pironneau~\cite{pir1973}
to find a Stokesian drag minimizing shape.  However, the effect of
erosion on a porous media is less understood.  With the methods
developed in this paper, quantities such as the total drag across a
porous region as a function of time can be computed in future work.

To simulate multiple bodies, it is essential to resolve the nonlocal
effects between the different bodies.  In this work, these interactions
are included with high-order accuracy by using an integral equation
method.  Integral equations have been used extensively to simulate
viscous fluids in complex geometries.  One particular application are
particulate flows, such as bubbles or droplets, and the classic book of
Pozrikidis~\cite{poz1992} describes BIEs for such problems.

Several groups consider the optimal body in a Stokes fluid that
optimizes some quantity.  For example, Pironneau~\cite{pir1973} found
the axisymmetric shape of a fixed volume body that minimizes drag is
similar to an American football with an opening angle of 60 degrees, and
this shape corresponds to a body with constant surface vorticity.  This
analysis is taken further by Montenegro-Johnson and
Lauga~\cite{mon-lau2015} where the optimal axisymmetric shape of fixed
surface area is computed.  We include a similar calculation for the
two-dimensional Stokes equations, and the resulting shape agrees with
our numerical solution. 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Outline of the paper} In Section~\ref{s:formulation}, we
describe the governing equations for both the fluid and describe the
erosion model using a \thL~framework.  In Section~\ref{s:method}, the
numerical methods in both space and time are described.
Section~\ref{SingleResults} gives several numerical examples.  Finally,
concluding remarks are made in Section~\ref{s:conclusions}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Formulation}
\label{s:formulation}
We start by defining the main variables used to model erosion.  We only
consider flows that are confined by a solid wall $\Gamma$ that encloses
$M$ eroding bodies as diagrammed in Fig.~\ref{fig:schematic}.  The bodies are denoted as $\gamma_\ell$, $\ell=1,\ldots,M$, and we write $\gamma = \gamma_1 \cup \cdots \cup \gamma_M$.
On each body, $\nn$ and $\ss$ denote the unit normal and unit tangent vectors respectively. Throughout the paper, we adopt the convention that $\ss$ points in the counterclockwise direction and $\nn$ points out of the fluid domain (i.e.~into the bodies). Neglecting inertial forces, the dynamics of the fluid is
fully characterized by the position of the bodies $\xx_\ell(s,t) \in
\gamma_\ell$, where $s$ is the arclength and $t$ is time.  Given
$\xx_\ell(s,t)$, $\ell=1,\ldots,M$, derived variables include the fluid
velocity $\uu$, the pressure $p$, and the shear stress $\tau$.   On the
bounding wall, we prescribe a velocity $\UU(\xx,t)$.  Then, the
governing equations are
\begin{equation}
\label{eqn:erosionModel}
\begin{split}
  \mu \Delta \uu = \grad p, &\hspace{20pt} \xx \in \Omega, \gap &&\mbox{conservation
of momentum}\\
\grad \cdot \uu = 0, &\hspace{20pt} \xx \in \Omega, \gap
&&\mbox{\em conservation of mass} \\
\uu = 0, &\hspace{20pt} \xx \in \gamma, \gap &&\mbox{\em no slip on the
bodies} \\
\uu = \UU, &\hspace{20pt} \xx \in \Gamma, \gap &&\mbox{\em outer wall
velocity} \\
\Vn = \abs{\tau}, &\hspace{20pt} \xx \in \gamma,
&&\mbox{\em erosion model},
\end{split}
\end{equation}
where $\Vn$ is the normal velocity of the interface and $\mu$ is the
fluid viscosity.  The outer wall is formed by rounding off the corners
of $[-3,3] \times [-1,1]$, and we enforce the Hagen-Poiseuille flow
\begin{align*}
  \UU(\xx) = \umax (1-y^2,0), \quad \xx \in \Gamma,
\end{align*}
where $U$ sets the maximum of the imposed Poiseuille flow. Often, we
will simply set $U=1$, but in some instances we change $U$ dynamically
to enforce that the pressure drop across the computational cell is
constant as bodies erode within it.  The boundary of the fluid domain is
$\bd\Omega = \gamma_1 \cup \cdots \cup \gamma_M \cup \Gamma$.  To
minimize the boundary effects of the inflow and outflow, we only place
bodies in the center third, $[-1,1] \times [-1,1]$, of the fluid domain.

\begin{figure}[htpb]
  \centering
  \input{figs/schematic.tikz}
  \caption{\label{fig:schematic} A schematic for the governing
    equations.  A no-slip boundary condition is imposed on each body
    $\gamma_\ell$ whose unit normal points outward relative to the
    geometry.  On the outer geometry $\Gamma$, a Hagen-Poiseuille flow
    is imposed.  The bodies are eroded at a rate that is proportional to
    the magnitude of the shear stress applied by the Stokesian fluid.
    The bodies are constrained to the middle third of the channel that
    is located between the dashed lines.}
\end{figure}

To perform the simulations, we freeze the geometry at each time step,
solve the incompressible Stokes equations, and then update the geometry
according to the erosion model.  The separation between these two
processes is justified since the time scale of erosion is much longer
than that of the flow.

%We use a quasi-static approximation.  That is, at each time step, we
%freeze the geometry, solve the incompressible Stokes equations, and then
%update the geometry according to the erosion model.  The two steps
%inside the red rectangle describes a time step in the quasi-static
%approximation.
%\todo[inline]{Appeal to separation of scales to justify this quasi-static approximation; i.e.~the timescale of erosion is much longer than that of the flow.}

Our erosion model is based on the shear stress, and this model is
discussed in more detail in Section~\ref{sec:erosion}.  We then describe
how the incompressible Stokes equations are solved in $\Omega$ using a
boundary integral equation in Section~\ref{sec:bies}.  In
Section~\ref{sec:shearStressLP}, we discuss how the shear stress is
computed.  Finally, in Section~\ref{sec:thetaL}, we describe how corners
in the geometry are avoided and perform a change of coordinates to treat a stiff term.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Erosion model} 
\label{sec:erosion}

Other models for erosion include ones that use an erosion rate that is
proportional to a power of the magnitude of the shear
stress~\cite{par-izu2000}, or ones that use a critical shear stress
below which erosion does not occur~\cite{lag2000}.


To model erosion, the normal velocity is  proportional to the absolute
value of the shear stress.   Since the constant of proportionality only
sets the time scale, we let $\Vn = |\tau|$ as described in
equation~\eqref{eqn:erosionModel}. For the sake of numerical stability,
we modify this law in Section~\ref{sec:thetaL}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boundary integral equation formulation} 
\label{sec:bies}

In this section, we describe the boundary integral equations employed
for the fluid equations.  In particular, we recast the incompressible
Stokes equations with Dirichlet boundary conditions 
\begin{alignat*}{3}
  \mu\Delta \uu &= \grad p, \qquad && \xx \in \Omega, \\
  \grad \cdot \uu &= 0,   && \xx \in \Omega, \\
  \uu &= \ff,  && \xx \in \bd\Omega,
\end{alignat*}
into an equivalent BIE.  The boundary condition $\ff$ is the prescribed
velocity $\UU$ on $\Gamma$, and it is zero on the grains $\gamma$.
Since we are interested in two dimensions, a stream function formulation
can be used by recasting the governing equations as a problem in
analytic function theory~\cite{gre-kro-may1996}.  So that our work can
extended to three dimensions, we instead use primitive variables by
writing the velocity in terms of the standard double-layer
potential~\cite{lad1963,poz1992}
\begin{align}
  \DD[\eeta](\xx) = \frac{1}{\pi} \int_{\bd\Omega} 
    \frac{\rr \cdot \nn}{\rho^2} \frac{\rr \otimes \rr}{\rho^2} 
    \eeta(\yy) \, ds_\yy, \quad \xx \in \Omega,
    \label{eqn:velocityDLP}
\end{align}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, and $\eeta$ is an unknown
density function.  As the viscosity $\mu$ also sets the time scale, we
take $\mu=1$.  \todo[inline]{Do you think we should flesh out this
time-scale stuff more precisely? i.e.~By setting $\mu = 1$ and $C = 1$
(the erosion constant), what exactly is the timescale that defines our
dimensionless time.} \todo[inline]{This might be worth doing.  Is it
something you can do quickly or do you want me to take a crack at it?}

The double-layer potential representation is only able to represent
force- and torque-free velocity fields, so we complete the velocity
representation with Stokeslets and Rotlets~\cite{pow-mir1987,pow1993}.
This is done by complementing the double-layer potential with Stokeslets
and rotlets centered inside each interior body
\begin{align}
  S[\llambda_\ell,\cc_\ell] = \frac{1}{4\pi} \left(-\log \rho \II + 
    \frac{\rr \otimes \rr}{\rho^2} \right)\llambda_\ell
  \quad \text{and} \quad
  R[\xi_\ell,\cc_\ell] = \frac{\rr^\perp}{\rho^2}\xi_\ell, 
  \quad \ell=1,\ldots,M,
  \label{eqn:stokeslet_rotlet}
\end{align}
where  $\rr = \xx - \cc_\ell$, $\cc_\ell$ is a point inside the
$\ell^{th}$ body, $\rr^\perp = (r_2,-r_1)$, and $\rho = \|\rr\|$.  Then,
any solution of the Stokes equations with a Dirichlet boundary condition
$\ff$ can be written in terms of the completed double-layer potential
\begin{align}
  \label{eqn:completed_DLP}
  \uu(\xx) = \DD[\eeta](\xx) + 
    \sum_{\ell=1}^{M} S[\llambda_\ell,\cc_\ell](\xx) +
    \sum_{\ell=1}^{M} R[\xi_\ell,\cc_\ell](\xx), \quad \xx \in \Omega,
\end{align}
where the density function, Stokeslets, and rotlets satisfy
\begin{subequations}
\label{eqn:completed_BIE}
\begin{align}
  \ff(\xx) &= -\frac{1}{2}\eeta(\xx) + \DD[\eeta](\xx) + 
      \sum_{\ell=1}^{M} S[\llambda_\ell,\cc_\ell](\xx) +
      \sum_{\ell=1}^{M} R[\xi_\ell,\cc_\ell](\xx) + \NN_0[\eeta](\xx),
      \quad \xx \in \bd\Omega, 
      \label{eqn:DLP}\\
  \llambda_\ell &= \frac{1}{2\pi}\int_{\gamma_\ell} \eeta(\yy) \, ds_\yy,
  \quad \ell=1,\ldots,M,
  \label{eqn:stokeslet} \\
  \xi_\ell &= \frac{1}{2\pi}\int_{\gamma_\ell} \yy^\perp \cdot \eeta(\yy)
  \, ds_\yy, \quad \ell=1,\ldots,M.
  \label{eqn:rotlet}
\end{align}
\end{subequations}
Here,
\begin{align*}
  \NN_0[\eeta](\xx) = \int_{\Gamma} 
    (\nn(\xx) \otimes \nn(\yy))\eeta(\yy) \, ds_\yy
\end{align*}
removes the rank one null space resulting from the flux-free requirement
of $\ff$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computing the shear stress}
\label{sec:shearStressLP}
To compute the shear stress, there are two options.  First, instead of
solving the BIE~\eqref{eqn:completed_BIE} for an arbitrary density
function, a similar BIE can be solved for the
traction~\cite{mit-spa2016}.  Alternatively, the traction corresponding
to the double-layer potential of the velocity~\eqref{eqn:velocityDLP}
can be computed using appropriate layer potentials.  While the first
method bypasses a step by forming the traction jump directly, it does
not allow us to directly compute other quantities such as the vorticity,
so we use the second method.

The shear stress is
\begin{align*}
  \tau = -\left(\nabla \uu + \nabla \uu^T \right)\nn \cdot \ss \, .
\end{align*}
The reader may notice an unusual sign convention above, but this is simply a consequence of our conventions for $\nn$ and $\ss$ (see Fig.~\ref{fig:schematic}). 
The velocity field of the
completed double-layer potential~\eqref{eqn:completed_DLP} involves
three terms: the double-layer potential, the Stokeslets, and the
rotlets.  We compute the deformation tensor $\ssigma =
\frac{1}{2}(\nabla\uu + \nabla\uu^T)$ for each of these terms
individually.

The deformation tensor of the double-layer
potential~\eqref{eqn:velocityDLP} at $\xx \in \Omega$
is~\cite{qua-bir2014a}
\begin{equation}
  \label{eqn:shearStressDLP}
  \begin{aligned}
  \ssigma^\DD(\xx) = \frac{1}{2\pi}\int_{\bd\Omega} &\left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn) 
    \right. \\
    &\left.
    +\frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right) \eeta(\yy) ds_\yy.
  \end{aligned}
\end{equation}
We require the deformation tensor on $\bd\Omega$, and this requires
taking the limit of equation~\eqref{eqn:shearStressDLP} when $\xx$ tends
to $\xx_0 \in \bd\Omega$.  The limiting value is given by
\begin{align*}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}\sigma_\DD(\xx) =
  J[\eeta](\xx_0) + \ssigma^\DD(\xx_0), \quad \xx_0 \in \bd\Omega,
\end{align*} 
where
\begin{align}
  J[\eeta](\xx_0) = \frac{1}{2}\left(\pderiv{\eeta}{\ss} 
    \cdot \ss\right) \left[ 
  \begin{array}{cc}
    s_x^2 - s_y^2 & 2s_x s_y \\ 2s_x s_y & s_y^2 - s_x^2
  \end{array}\right].
  \label{eqn:shearStressJump}
\end{align}
The deformation tensor of the Stokeslets and
rotlets~\eqref{eqn:stokeslet_rotlet} are
\begin{equation}
  \label{eqn:shearStressSR}
  \begin{aligned}
  \ssigma^S(\xx_0) &= \sum_{\ell=1}^{M}
    \frac{\rr \cdot \llambda_\ell}{4\pi\rho^2} \left(
    \II - \frac{2}{\rho^2} \rr \otimes \rr \right),  \\
  \ssigma^R(\xx_0) &= -\sum_{\ell=1}^M
    \frac{\xi_\ell}{\rho^4} \left(\rr \otimes \rr^\perp + 
    \rr^\perp \otimes \rr \right).
  \end{aligned}
\end{equation}
Now that the deformation tensor of each component of the completed
double-layer potential is computed, the shear stress at $\xx_0 \in
\bd\Omega$ is
\begin{align}
  \tau = -2 \left(J[\eeta](\xx_0) + \ssigma^\DD(\xx_0) + 
    \ssigma^S(\xx_0) + \ssigma^R(\xx_0)\right) \nn \cdot \ss.
  \label{eqn:shearStressLP}
\end{align}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boundary evolution in the {\thL} framework} 
\label{sec:thetaL}

To evolve the boundaries of eroding bodies, we use the {\thL} framework which offers certain advantages in numerically stabilizing moving-interface problems \cite{hou-low-she1994}. Here, $\theta$ is the local tangent angle and $L$ is the total perimeter of a given boundary. For a boundary parametrized by arclength $(x(s),y(s))$, the local tangent angle is defined through the relation $\left( \pdi{x}{s}, \pdi{y}{s} \right) = \left(\cos \theta, \sin \theta \right)$.

For numerical stability, we modify the erosion law~\eqref{eqn:erosionModel} to include a term that penalizes curvature $\kappa$. The idea is to prevent regions of extremely high curvature from developing, as these regions would compromise the accuracy and stability of our fluid solver. We thus replace~\eqref{eqn:erosionModel} with
\begin{align}
  \label{eqn:Vn}
  \Vn = \atau + \eps \mean{\atau} \left( \frac{L }{2\pi} \kappa - 1 \right).
\end{align}
The parameter $\eps \ll 1$ controls the strength of the curvature-penalization. This term causes regions of high curvature to recede more rapidly and thus suppresses any high-frequency oscillations that may exist. Above, $\mean{\cdot}$ indicates a boundary mean. Since a closed body has mean curvature $\mean{\kappa} = 2\pi / L$, the penalty term has mean zero and thus preserves area. The only source of material loss is therefore the shear-stress itself. In addition, we have scaled the penalty term on the mean absolute shear, $\mean{\atau}$, so that the ratio of smoothing-to-erosion always remains fixed, even as bodies vanish.

In the following, we parameterize each boundary by normalized arclength, $\alpha = 2 \pi s / L$. In terms of $\alpha$, the curvature is given by
\begin{align}
\kappa = \frac{2 \pi}{L} \pderiv{\theta}{\alpha} \, ,
\end{align}
and substitution into~\eqref{eqn:Vn} gives
\begin{align}
\label{eqn:Vn2}
\Vn = \atau +  \eps \mean{\atau}   \left(\pderiv{\theta}{\alpha} - 1 \right) \, .
\end{align}

The boundary of each body will be represented by a grid of collocation
points. If we were to simply evolve the interfaces
under~\eqref{eqn:Vn2}, this grid would become distorted, which, if
unchecked, could lead to severe tangling and numerical instability. We
therefore introduce an artificial tangential velocity $\Vs$ that always
keeps the grid points equally spaced in arclength \cite{hou-low-she1994}. The appropriate tangential velocity satisfies 
\begin{align}
\pderiv{\Vs}{\alpha} = \thalpha \Vn - \mean{\thalpha \Vn} \, .
\end{align}
The evolution of the interface is then given by the combination of the normal and tangential velocity
\begin{align}
\dot{\xx}(t) = \Vn \nn + \Vs \ss \, .
\end{align}
Since $\Vs$ is tangential, it does not modify the physics of erosion, only the parameterization of the boundaries.

When recast in the variables $\theta$ and $L$, the interface evolution becomes
\begin{align}
\tderiv{L}{t} &= - 2 \pi \mean{\thalpha \Vn}, \\
\pderiv{\theta}{t} &= \frac{2 \pi}{L} \left( \pderiv{\Vn}{\alpha} +
\thalpha \Vs \right).
\end{align}
Inserting~\eqref{eqn:Vn2} for the normal velocity gives
\begin{align}
\label{eqn:Levo1}
\tderiv{L}{t} &= - 2 \pi \mean{\thalpha \Vn}, \\
\label{eqn:thetaevo1}
\pderiv{\theta}{t} &= \frac{2\pi}{L} \left(
\eps \mean{\atau} \ppd{\theta}{\alpha} + \pderiv{\atau}{\alpha} +
\thalpha \Vs \right)\,.
\end{align}
These are the main evolution equations for $\theta(\alpha,t)$ and $L(t)$.
In addition, it is necessary to track a reference point for each body, so that the {\thL} variables can be converted back to cartesian coordinates. We track the coordinates of the surface mean $\mean{\xx}$, which moves according to
\begin{align}
\label{eq:xsurf}
\frac{d}{dt} \mean{\xx} = \mean{ V_s \ss + V_n \nn } \, .
\end{align}
We note that tracking the center of mass is also a valid choice, but the surface mean gives a somewhat simpler formula. Equations~\eqref{eqn:Levo1}--\eqref{eq:xsurf} comprise the main system of equations to be solved numerically in Section~\ref{sec:timeStepping}. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical methods}
\label{s:method}
There are three main numerical methods that need to be developed.  In
Section~\ref{sec:BIE}, we describe how the BIE~\eqref{eqn:completed_BIE}
is solved.  Once the density function is found,
Section~\ref{sec:shearStress} describes how the shear
stress~\eqref{eqn:shearStressLP} is computed.  Then, in
Section~\ref{sec:timeStepping}, a time stepping method for evolving the
interface according to equations~\eqref{eqn:Levo1}
and~\eqref{eqn:thetaevo1} is described. So that we can form stable
simulations with long time horizons, we use numerical methods that
achieve spectral accuracy in space, second-order accuracy in time, and
maintain an equispaced discretization of the bodies.  The boundaries are
represented in Fourier space, giving us a set of discretization points
$\xx_i$ of each body, and all derivatives and integrals (the arclength,
curvature, and mean values) are computed with spectral accuracy using
the Fourier representation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Solving the BIE}
\label{sec:BIE}

To numerically evaluate the completed double-layer
potential~\eqref{eqn:completed_BIE}, let $N_\iin$ be the number of
points on each of the $M$ bodies, and $N_\out$ be the number of points
on the outer boundary.  Then, $N = MN_\iin + N_\out$ is the total number
of discretization points of $\bd\Omega$.  The double-layer potential
in~\eqref{eqn:DLP} is discretized with the trapezoid rule as
\begin{align}
  \DD[\eeta](\xx_i) = \sum_{j=1}^{N} K(\xx_i,\xx_j) \eeta(\xx_j) 
      \Delta s_{j}, \quad i=1,\ldots,N,
  \label{eqn:trapDLP}
\end{align}
where $\Delta s_j$ is the arclength term of $\bd\Omega$ at
$\xx_j$, and
\begin{align*}
  K(\xx,\yy) = \frac{1}{\pi} \frac{\rr \cdot \nn}{\rho^2} 
      \frac{\rr \otimes \rr}{\rho^2},
\end{align*}
where $\rr = \xx - \yy$ and $\rho = \|\rr\|$, is the kernel of the
double-layer potential.  The diagonal term of~\eqref{eqn:trapDLP} is
replaced with the limiting value of the double-layer potential
\begin{align*}
  D(\xx,\xx) = -\frac{\kappa(\xx)}{2\pi}(\ss(\xx) \otimes \ss(\xx)),
\end{align*}
where $\kappa(\xx)$ is the curvature and $\ss(\xx)$ is the unit tangent
vector at $\xx \in \bd\Omega$.  The equations for the
Stokeslets~\eqref{eqn:stokeslet} and the rotlets~\eqref{eqn:rotlet} are
also discretized with the trapezoid rule.  Applying this discretization
strategy to~\eqref{eqn:completed_BIE}, the dense linear system that
needs to be solved is
\begin{equation}
  \label{eqn:completed_BIE_discretized}
  \begin{aligned}
    \ff(\xx_i) &= -\frac{1}{2}\ssigma(\xx_i) + \sum_{j=1}^{N} 
      K(\xx_i,\xx_j) \eeta(\xx_j) \Delta s_{j} + 
      \sum_{\ell=1}^M S[\llambda_\ell,\cc_\ell](\xx_i) \\
      &\hspace{53pt}
      +\sum_{\ell=1}^M R[\xi_\ell,\cc_\ell](\xx_i) 
      +\sum_{\xx_j \in \Gamma} (\nn(\xx_i) \otimes
      \nn(\xx_j))\eeta(\xx_j), \\
    \llambda_\ell &= \sum_{\xx_j \in \gamma_\ell} \eeta(\xx_j) 
      \Delta s_j, \\ 
    \mu_\ell &= \sum_{\xx_j \in \gamma_\ell}
      {(\xx_j - \cc_\ell)}^\perp \cdot \eeta(\xx_j) \Delta s_j,
  \end{aligned}
\end{equation}
for $i=1,\ldots,N$, $\ell=1,\ldots,M$.  Since all the integrands are
smooth and periodic, by using the trapezoid rule, we are guaranteed that
the numerical solutions converges to the true solution with spectral
accuracy.

The linear system~\eqref{eqn:completed_BIE_discretized} is solved
iteratively with the generalized minimal residual method
(GMRES)~\cite{saa-sch1986}.  Since the BIE is second-kind, only a
mesh-independent number of GMRES iterations are
required~\cite{cam-ips-kel-mey-xue1996}.  Therefore, the asymptotic cost
is determined by the cost of performing a matrix-vector multiplication,
and the bulk of the cost is evaluating the $N$-term sum
in~\eqref{eqn:completed_BIE_discretized}.  Naively, evaluating this sum
at all points requires $\bigO(N^2)$ operations.  To reduce the
computational cost, we use the Fast Multipole Method
(FMM)~\cite{gre-rok1987, gre-gre-may1992} to reduce the complexity from
$\bigO(N^2)$ to $\bigO(N)$.  Since the number of required GMRES
iterations is mesh-independent, the overall complexity for
solving~\eqref{eqn:completed_BIE_discretized} is $\bigO(N)$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Shear stress}
\label{sec:shearStress}
We have decomposed the deformation tensor into contributions from three
different terms.  The contributions from the Stokeslets and the rotlets
can be directly evaluated since $\rr \neq 0$ for all $\xx \in \gamma$.
For the shear stress of the double-layer potential, we would like to use
the trapezoid rule. The kernel of the deformation tensor due to
the double-layer potential~\eqref{eqn:shearStressDLP} is 
\begin{align*}
  K_\ssigma(\xx,\yy)\eeta(\yy) &= \frac{1}{2\pi} \left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn)
    \right. \\ & \hspace{25pt}+ \left.
    \frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right).
\end{align*}
Unfortunately, this kernel has a singularity that is asymptotic to
$\bigO(\rho^{-2})$ when $\yy \rightarrow \xx$, and this is too strong
for the trapezoid rule.  The singularity strength can be reduced since
the velocity corresponding to a constant density function is
constant~\cite{poz1992}.  Therefore, the deformation tensor of the
double-layer potential is equivalent to
\begin{align*}
  \ssigma^{\DD}(\xx) = \int_{\bd\Omega}K_\ssigma(\xx,\yy)
      (\eeta(\yy) - \eeta(\xx)) \, ds_{\yy}, \quad \xx \in \bd\Omega.
\end{align*}
This expression for the deformation tensor has a singularity that is
asymptotic to $\bigO(\rho^{-1})$ when $\yy \rightarrow \xx$.  Finally,
to achieve spectral accuracy, we apply odd-even
integration~\cite{sid-isr1988}.  Therefore, the deformation tensor of
the double-layer potential at a discretization point $\xx_i$ on body
$\gamma_\ell$, with $i$ being odd, is approximated as
\begin{align}
  \ssigma^{\DD}(\xx_i) = \sum_{\xx_j \notin \gamma_\ell}
    K_\ssigma(\xx_i,\xx_j) \eeta(\xx_j) \Delta s_j + 
  \sum_{\substack{\xx_j \in \gamma_\ell \\ j \: \mathtt{even}}}
    K_\ssigma(\xx_i,\xx_j) (\eeta(\xx_j) - \eeta(\xx_i)) \Delta s_j,
  \label{eqn:stressOddEven}
\end{align}
and a similar approximation is used when $i$ is even.  The deformation
tensor due to the Stokeslets and rotlets are given in
equation~\eqref{eqn:shearStressSR}.  Finally, the jump in the
deformation tensor~\eqref{eqn:shearStressJump} is computed with Fourier
differentiation.  Finally, the shear stress is computed by multiplying the
deformation tensor by the normal vector, and taking the inner product
with the tangent vector.

We do not employ an FMM to evaluate the shear stress at $\xx_i$,
$i=1,\ldots,N$, so the cost of evaluating the shear stress is
$\bigO(N^2)$.  However, this calculation is only performed once per time
step as opposed to the velocity double-layer potential that must be
evaluated at each GMRES iteration.  In future work, we plan to use a
kernel-independent FMM~\cite{yin-bir-zor2004} to evaluate the shear
stress with $\bigO(N)$ operations.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TIME-STEPPING %%
\subsection{Time-stepping with the {\thL} method} 
\label{sec:timeStepping}

With the shear stress computed, we are now ready to numerically evolve the boundary of each body using the {\thL} framework. The main equations to be solved are~\eqref{eqn:Levo1}--\eqref{eq:xsurf}.  In Section~\ref{sec:thetaL} we introduced a curvature-penalizing term into the erosion law~\eqref{eqn:Vn}. This term suppresses high-frequency oscillations, but also introduces {\em stiffness} into evolution equation~\eqref{eqn:thetaevo1}. We will therefore use a combined exponential-integrator/Runge-Kutta method to solve system~\eqref{eqn:Levo1}--\eqref{eq:xsurf}. The exponential integrator will handle the stiff term in a numerically stable fashion, while the Runge-Kutta method will treat nonlinear terms explicitly. Our overall time-stepping method will be second-order accurate.

First, we must address a second potential source of numerical
instability. The erosion law~\eqref{eqn:Vn} depends on the {\em absolute
value} of shear stress, $\atau$, which exhibits a corner anywhere $\tau$
changes sign (i.e.~at a stagnation point). The corner in $\atau$
introduces high frequencies into~\eqref{eqn:thetaevo1} which could result in either numerical instability or an extremely stringent step-size restriction. To avoid these difficulties, we smooth $\atau$ via a narrow Gaussian filter of width $\sigma$
\begin{align}
\atausig = \int_{\gamma} \frac{1}{\sqrt{2\pi} \sigma}
 \exp \left(- \frac{\alpha'^2}{2 \sigma^2}\right) \abs{ \tau(\alpha - \alpha') } \, d\alpha' \, ,
\end{align}
with corresponding normal and tangential interface velocities
\begin{align}
& \Vnsig = \atausig +  \eps \mean{\atausig}
\left(\pderiv{\theta}{\alpha} - 1 \right), \\
& \pderiv{\Vssig}{\alpha} = \thalpha \Vnsig - \mean{\thalpha \Vnsig}.
\end{align}
This smoothing further suppresses the feedback of high frequencies between $\atau$ and the body shape.

We now consider the system of evolution equations given by~\eqref{eqn:Levo1}--\eqref{eq:xsurf}. For convenience, we introduce the following variables
\begin{align}
%\label{eq:M}
& \Mterm = - 2 \pi \mean{\thalpha \Vnsig}, \\
%\label{eq:N}
& \NLterm = \frac{2 \pi}{L} \left( \pderiv{\atausig}{\alpha} + \thalpha
\Vssig \right), \\
%\label{eq:elfun}
& \elfun = \frac{2 \pi}{L}  \mean{\atausig} \, .
\end{align}
Then,~\eqref{eqn:Levo1} and~\eqref{eqn:thetaevo1} can be compactly expressed as
\begin{align}
\label{eqn:Levo2}
& \tderiv{L}{t} = \Mterm, \\
\label{eqn:thetaevo2}
& \pderiv{\theta}{t} = \eps \elfun \ppd{\theta}{\alpha} + \NLterm.
\end{align}
The diffusive term on the right of~\eqref{eqn:thetaevo2} results from the curvature penalization and is the stiffest term present. This term is multiplied by $\zeta$, which is spatially constant but depends on time (due to $L$ and $\mean{\atau}$). Meanwhile, $\NLterm$, represents all remaining terms in the evolution equation, including contributions from the shear-dependent erosion law and from the artificial tangential velocity, $\Vs$. Since the local shear stress depends on interactions between bodies, $\NLterm$ is both a nonlinear and nonlocal.

We will evolve $\theta(\alpha,t)$ in spectral space and so introduce the Fourier series for $\theta$ and $\NLterm$
\begin{align}
\label{thetaSeries}
 \theta(\alpha,t) &= \alpha + \FourierSum \thhat_k e^{ i k \alpha} \, , \\
 \NLterm(\alpha,t)  &= \FourierSum \widehat{\NLterm}_k e^{ i k \alpha} \, .
\end{align}
The careful reader will notice that in~\eqref{thetaSeries} we have decomposed $\theta(\alpha)$ into a linear component and a periodic component. In spectral space,~\eqref{eqn:thetaevo2} produces the system of ODEs
\begin{align*}
\tderiv{\thhat_k}{t} +  \eps k^2  \elfun \thhat_k = \widehat{\NLterm}_k,
\qquad k=-N_\iin/2,\ldots,N_\iin/2-1\, .
\end{align*}
These ODEs can be simplified by applying the integrating factor
\begin{align}
\label{eq:mu}
\mu_k = \exp \left( \eps k^2 \int \elfun \, dt \right) \, ,
\end{align}
which leads to the coupled system
\begin{align}
\label{eqn:Levo3}
& \tderiv{L}{t} = \Mterm, \\
\label{eqn:thetaevo3}
& \tderiv{}{t}\left( \mu_k \thhat_k \right) = \mu_k \widehat{\NLterm}_k \, ,
\qquad k = -N_\iin/2, \ldots, N_\iin/2 -1.
\end{align}
Note that the diffusive term from~\eqref{eqn:thetaevo2} does not appear explicitly in~\eqref{eqn:thetaevo3}, but rather is implied by the integrating factor~\eqref{eq:mu}. This is the idea of an exponential integrator. We solve the resulting system~\eqref{eq:mu}--\eqref{eqn:thetaevo3} with an
explicit, second-order Runge-Kutta method (RK2). In particular, we use the {\em midpoint} RK2 method because it maximizes the smoothing effect of the diffusive term.
\todo[inline]{Last sentence might need to be clarified.  Not sure about
using `so as to'}

At the first stage of RK2 (the half step) we discretize~\eqref{eq:mu}--\eqref{eqn:thetaevo3} as
\begin{align}
\label{eq:mu12d}
& \mu_k^{(n+1/2)} = \mu_k^{(n)} \exp \left( \eps k^2 \frac{\Dt}{2}
\zeta^{(n)} \right), \\
\label{eq:L12d}
& \frac{L^{(n+1/2)} - L^{(n)}}{\Dt/2} = \Mterm^{(n)}, \\
\label{eq:th12d}
& \frac{ \mu_k^{(n+1/2)} \thhat_k^{(n+1/2)} - \mu_k^{(n)} \thhat_k^{(n)}}{\Dt/2} 
= \mu_k^{(n)} \hat{\NLterm}_k^{(n)},
\end{align}
where the superscript indicates the time step. At the next stage of RK2 it will be necessary to evaluate derivates at the half step $n+1/2$, thus requiring a call to the Stokes solver for which the body shapes must be known. We therefore insert~\eqref{eq:mu12d} into~\eqref{eq:th12d} and solve for $\theta^{(n+1/2)}$, giving
\begin{align}
\label{eq:th12}
\thhat_k^{(n+1/2)} = \left( \thhat_k^{(n)} + \frac{1}{2} \Dt \, \hat{\NLterm}_k^{(n)} \right)
\exp \left( -\epsilon k^2 \frac{\Dt}{2} \elfun^{(n)}\right) \, .
\end{align}
Since $\zeta >0$, the exponential term always {\em suppresses} high-frequencies (exponentially with $k^2$). In other words, this is a smoothing term. With the geometry at step $n+1/2$ known, a call to the Stokes solver allows the computation of $\Mterm^{(n+1/2)}$, $\widehat{\NLterm}_k^{(n+1/2)}$, and $\zeta^{(n+1/2)}$.

At the second stage of RK2, we discretize~\eqref{eq:mu}--\eqref{eqn:thetaevo3} as 
\begin{align}
\label{eq:mu1d}
& \mu_k^{(n+1)} = \mu_k^{(n)} \exp \left( \eps k^2 {\Dt} \,
\zeta^{(n+1/2)} \right), \\
\label{eq:L1d}
& \frac{L^{(n+1)} - L^{(n)}}{\Dt} = \Mterm^{(n+1/2)}, \\
\label{eq:th1d}
& \frac{ \mu_k^{(n+1)} \thhat_k^{(n+1)} - \mu_k^{(n)} \thhat_k^{(n)}}{\Dt} =
\mu_k^{(n+1/2)} \hat{\NLterm}_k^{(n+1/2)}.
\end{align}
We must eventually compute the geometry at step $n+1$, and so we insert~\eqref{eq:mu1d} into~\eqref{eq:th1d} and solve for $\theta^{(n+1)}$, giving
\begin{align}
\thhat_k^{(n+1)} =  \thhat_k^{(n)} \exp \left( - \epsilon k^2 \Dt \elfun^{(n+1/2)} \right) + \Dt \, \hat{\NLterm}_k^{(n+1/2)} \exp \left( - \frac{1}{2} \eps k^2 \Dt \left( 2 \elfun^{(n+1/2)} - \elfun^{(n)} \right) \right).
\end{align}
Once again, both exponential terms act to smooth the geometry. Finally, to track the reference point, $\mean{x}$, we simply apply the same RK2 method to~\eqref{eq:xsurf}.

We point out that most exponential integrators use some form of quadrature to treat~\eqref{eq:mu}, but, here, we have simply applied the same RK2 method used for the rest of the system. We believe this to be a simple, systematic approach to arrive at a self-consistent discretization of desired accuracy because it avoids choices regarding which quadrature to use (midpoint, trapezoid, Simpson's, etc.) and can be easily generalized to other time-stepping methods, such as fourth-order Runge-Kutta. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Post processing quantities of interest}
\label{s:qoi}
To study characteristics of the flow, the vorticity
(Section~\ref{sec:vorticity}), pressure (Section~\ref{sec:pressure}),
and drag (Section~\ref{sec:drag}) will be computed.  Once
equation~\eqref{eqn:completed_DLP} is solved for the density function,
Stokeslets, and rotlets, all of these quantities can be computed.  For
target points in the fluid domain, the resulting layer potentials
involve integrands that are periodic and smooth, so the trapezoid rule
guarantees spectral accuracy~\cite{tre-wei2014}.  However, if the target
point is close to $\bd \Omega$, a nearly-singular integrand must be
integrated, and this requires upsampling that is described in
Section~\ref{sec:NSI}.  When the target points is on the boundary, the
integrands involve singularities that are evaluated by combining
singularity subtraction and odd-even integration~\cite{sid-isr1988}.  



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Vorticity}
\label{sec:vorticity}
We start by computing the vorticity $\omega(\xx) = v_x - u_y$ for $\xx \in
\Omega$.  As we did for the shear stress, we compute the vorticity due
to the double-layer potential, Stokeslets, and rotlets individually.
The vorticity of the double-layer potential~\eqref{eqn:velocityDLP} at
$\xx \in \Omega$ is
\begin{align}
  \omega^{\DD}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} 
    \frac{(\rr \cdot \nn^\perp) + (\rr \cdot \nn)}{\rho^4}
    (\rr \cdot \eeta) ds_{\yy}.
  \label{eqn:vorticityDLP}
\end{align}
The vorticity due to the Stokeslet is
\begin{align*}
  \omega^S(\xx) = -\frac{1}{\pi} \sum_{\ell=1}^{M} 
    \frac{\rr \cdot \llambda_\ell^\perp}{\rho^2},
\end{align*}
and the vorticity of a rotlet is zero.  Therefore, the vorticity at $\xx
\in \Omega$ is
\begin{align*}
  \omega(\xx) = \omega^\DD(\xx) + \omega^S(\xx).
\end{align*}
To compute~\eqref{eqn:vorticityDLP} numerically, we apply the trapezoid
rule with an upsampling scheme described in Section~\ref{sec:NSI}.

For the Stokes equations, on boundaries that have a no-slip boundary
condition, the shear stress is equivalent to the vorticity $\omega = v_x -
u_y$.  Therefore, we do not need to compute the vorticity for $\xx \in
\bd\Omega$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Pressure}
\label{sec:pressure}
To compute the pressure at $\xx \in \Omega$, we follow the
same procedure used for the shear stress.  We start by computing the
pressure of the double-layer potential for $\xx \in \Omega$ and add the
appropriate jump if $\xx \in \Gamma$. For $\xx \in \Omega$, the pressure
is
\begin{align}
  p^{\DD}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot \eeta(\yy) \,ds_\yy.
    \label{eqn:pressureDLP}
\end{align}
The pressure due to the Stokeslets is
\begin{align}
  p^S(\xx_0) = \sum_{\ell=1}^{M}\frac{\rr \cdot \llambda_\ell}{2\pi\rho^2},
  \label{eqn:shearPressureSR}
\end{align}
and the pressure due to the rotlets is zero.  Therefore, the pressure is
\begin{alignat*}{3}
  p(\xx) &= p^{\DD}(\xx) + p^{S}(\xx), &&\xx \in \Omega,\\
  p(\xx) &= \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx) + 
              p^{S}(\xx), \quad && \xx \in \bd\Omega.
\end{alignat*}
To compute~\eqref{eqn:pressureDLP} numerically, we apply the trapezoid
rule with an upsampling scheme described in Section~\ref{sec:NSI}.

To compute the pressure at $\xx_0 \in \bd\Omega$, we consider the limit
as $\xx$ tends to $\xx_0$.  The limiting value is given
by~\cite{qua-bir2014a}
\begin{align}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}p^\DD(\xx) =  
    \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0).
  \label{eqn:pressureJump}
\end{align}
Similar to the shear stress, the singularity of the pressure
corresponding to the double-layer potential~\eqref{eqn:pressureDLP} is
too strong for the trapezoid rule to be directly applied.  Therefore, we
again subtract a constant density function and write the pressure as
\begin{align*}
  p^\DD(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot (\eeta(\yy) - \eeta(\xx)) \,ds_\yy, 
    \quad \xx \in \bd\Omega.
\end{align*}
Then, identical to how the shear stress is
computed~\eqref{eqn:stressOddEven}, odd-even integration is used to
evaluate this layer potential for pressure.  The pressure due to the
Stokeslets are given in equation~\eqref{eqn:shearPressureSR}.  Finally,
to add the jump condition~\eqref{eqn:pressureJump}, Fourier
differentiation is used to compute the arclength derivative. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Drag}
\label{sec:drag}
With the pressure and shear stress, the drag on a single body with
boundary $\gamma_\ell$ is
\begin{align}
\FFD = \int_{\gamma_\ell} p \nn + \tau \ss \,ds.
\label{eqn:drag}
\end{align}
The reader may notice an unusual sign convention for pressure in this formula, which is simply due to the normal direction pointing {\em into} the bodies.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Near-singular integration}
\label{sec:NSI}
The layer potentials for the velocity~\eqref{eqn:velocityDLP},
vorticity~\eqref{eqn:vorticityDLP}, and pressure~\eqref{eqn:pressureDLP}
need to be evaluated at points $\xx \in \Omega$. We write the general
layer potential as
\begin{align}
  \phi(\xx) = \int_{\bd\Omega} K(\xx,\yy) \eeta(\yy) ds_\yy.
  \label{eqn:genericLP}
\end{align}
Since the integrand is periodic and smooth, the trapezoid rule
guarantees spectral accuracy.  However, when the target point $\xx$ is
close to $\bd\Omega$, the integrand is nearly-singular, and the accuracy
of the trapezoid rule deteriorates unless a large number of
discretization points are used.  We are only interested in computing the
velocity, vorticity, and pressure to visualize the flow, so it is not
necessary that we resolve the integrands for arbitrarily close target
points.

The layer potential~\eqref{eqn:genericLP} is approximated with the
trapezoid rule 
\begin{align}
  \phi(\xx) = \sum_{j=1}^N q_j K(\xx,\yy_j),
  \label{eqn:layerPotential}
\end{align}
where $q$ contains the quadrature weights, Jacobian, and density
function.  Based on numerical experiments, the error of the $N$-point
trapezoid rule is acceptable for points $\xx$ that are more than 5
arclength spacings from $\bd\Omega$. For points that are closer than 5
arclength spacings to $\bd\Omega$, we use an upsampled trapezoid rule.
The required upsampling of the geometry and the density function is done
with a Fourier interpolant.  To minimize the number of discretization
points that are used to approximate the layer
potential~\eqref{eqn:layerPotential}, we use the same upsampling rate
for all target points that are in the same dyadic interval
(Table~\ref{tbl:upsampling}).  For points that are closer than $5/16$ of
an arclength from $\bd\Omega$, a value of 0 is simply assigned to
$\phi$.
\newcolumntype{V}{>{\centering\arraybackslash}m{4em}}
\newcolumntype{N}{@{}m{0pt}@{}}
\begin{table}[htpb]
\centering
%\begin{tabular}{|c|ccccc|}
\begin{tabular}{|V|V|V|V|V|V|N}
  \hline
  $d(\xx,\bd\Omega)$ &
  $\left[5h,\infty\right]$ &
  $\left[\frac{5}{2}h,5h\right]$ &
  $\left[\frac{5}{4}h,\frac{5}{2}h\right]$ & 
  $\left[\frac{5}{8}h,\frac{5}{4}h\right]$ &
  $\left[\frac{5}{16}h,\frac{5}{8}h\right]$ & \\ [2ex] 
  \hline
  Upsample Rate & 1 & 2 & 4 & 8 & 16 & \\
  \hline
\end{tabular}
\caption{\label{tbl:upsampling}The upsampling rate of our near-singular
integration scheme.  $d(\xx,\bd\Omega)$ is the distance between a point
$\xx \in \Omega$ and the boundary of the domain $\bd\Omega$, and $h$ is
an arclength spacing.}
\end{table}

In future work, upsampling will not be adequate.  For example, if
eroding bodies are also sedimenting, bodies will come too close to one
another for upsampling to be sufficient.  Therefore, we plan to
implement a near-singular integration scheme that uses either
near-singular interpolation~\cite{qua-bir2014a}, quadrature by
expansion~\cite{klo-bar-gre-one2013}, Barycentric
interpolation~\cite{bar-wu-vee2015}, or panel-based
quadrature~\cite{hel-oja2008a}.

%%-----------------------------------------------------------------%%
% RESULTS SECTION
%%-----------------------------------------------------------------%%
\section{Results: Single-body erosion}
\label{SingleResults}
With the description of the methods complete, we now present numerical results on bodies eroding in Stokes flow. We first discuss the case of a single body, as certain features can be predicted analytically and thus used for validation. In Section \ref{MultiResults} we will discuss the erosion of multiple bodies and highlight important differences that arise compared to the single-body case.

\subsection{A single body eroding in Stokes flow}

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.80 \textwidth]{./figs/01bodseq.pdf}
\caption{A single body eroding in Stokes flow. As the body erodes, it develops a corner at its front and rear stagnation points, while remaining for-aft symmetric due to time-reversibility. Color indicates the vorticity of the surrounding flow, which, when evaluated on the boundary, gives the local shear stress. In this simulation, we use $N_\iin = 1024$ discretization points on the body, $N_\out = 1024$ points on the outer boundary, a time-step of $\Dt = 10^{-6}$, and smoothing parameters of $\eps = 10/1024$ and $\sigma = 10/1024$.}
\label{01bodseq} 
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure from datafile 01circ1024aa;
% Uses 01circ1024.in with epsfac = 10, sigfac = 10, dt = 1e-6, fixarea = 0, fixpdrop = 0

Figure \ref{01bodseq} shows the erosion of a single body, numerically simulated with $N_\iin = 1024$ discretization points and shown at three evenly spaced times. Here, color represents the vorticity of the surrounding flow. When evaluated on the boundary, vorticity corresponds to the shear stress and thus the local erosion rate. As seen in the left-most snapshot, the body is initially circular and has the strongest vorticity above and below it. The flow is for-aft symmetric as a result of the time-reversibility of the Stokes equations, with vorticity vanishing at the body's front and rear stagnation points. 
At the next instance, the body has lost material due to erosion, but remains for-aft symmetric due to the flow symmetry. The greatest material loss has occurred at the body's top and bottom, where shear is strongest. Interestingly, the body has developed well-defined corners at its front and rear stagnation points. This geometric feature is a consequence of the erosion law, which depends on the {\em absolute} shear stress: wherever the stress vanishes, $\atau$ exhibits a corner, which manifests as a corner in the geometry. As shown in the third snapshot, this corner persists as the bodies becomes even more slender and continues to shrink.
\todo[inline]{Is this the notation we want to use for scientific
notation? Could instead use $1.79 \times 10^{-2}$? \\
Fine by me (Nick). What about for tables (e.g. table 4)? For tables, I am more used to seeing the 1.79E-2 notation. How about you?}

To better understand the shape evolution, Fig.~\ref{shrink_intface}(a) shows several superimposed interfaces at evenly spaced times. The interfaces are color-coded by normalized time $t/t_f$, where $t_f = 1.79 \times 10^{-2}$ is the time at which the body vanishes. The body converges to a fairly slender, for-aft symmetric shape with corners at its front and back --- somewhat reminiscent of an American football.
Fig.~\ref{shrink_intface}(b) shows how the absolute shear stress, $\atau$, is distributed along each of these interfaces. The normalized arclength $s/L$ runs counterclockwise around the body, with $s/L = $ 0 and 0.5 corresponding to the rear and front stagnation points respectively. At early times (yellow to orange), the stress is highly variables, with highest values at the top and bottom of the body. As time proceeds, though, the stress becomes more evenly distributed along the body's surface (red). As the body nears the final stages of erosion (dark red), the stress actually becomes slightly higher near the stagnation points. A close look reveals that the stress always vanishes {\em at} the stagnation points, but in a region that becomes increasingly narrow.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.8 \textwidth]{./figs/shrink_intface.pdf}
\caption{
Shape and stress evolution: (a) Interfaces of the eroding body from Fig.~\ref{01bodseq} shown at evenly-spaced time intervals. Color indicates normalized time, $t/t_f$, where $t_f = 1.79 \times 10^{-2}$ is the time at which the body completely vanishes. (b) The distribution of absolute shear stress, $\atau$, along each of these interfaces. Normalized arclength, $s/L$, runs counterclockwise from the rear stagnation point. The stress initially varies over the body's surface, but becomes more uniform over time.}
\label{shrink_intface}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure from datafile 01circ1024aa;
% Uses 01circ1024.in with epsfac = 10, sigfac = 10, dt = 1e-6, fixarea = 0, fixpdrop = 0

\subsection{Scaling laws for area and drag}
\label{sec:scaling}

Figure~\ref{shrink_intface}(a) shows that the spacing between successive interfaces becomes larger with time, suggesting that the overall shear stress grows as the body vanishes. This observation is consistent with the well-known 3D Stokes drag law, $\tau \sim \mu \umax / a$, in which drag is inversely proportional to body-scale $a$ (e.g.~for a sphere, $a$ is taken to be the radius). This law must be modified in two dimensions, though. The modification is made non-trivial by subtleties of the 2D Stokes paradox, but can be correctly deduced by noting that, as the body vanishes, its drag must be consistent with slender-body theory \cite{poz1997, bouzarth2007epicyclic, camassa2008trajectory, MooreJFM2012, zhao2015transportation}. 
For a slender body in flow perpendicular to its long-axis $\ell$, the drag is proportional to
$\mu \umax \ell/ \log(\ell/a)$, where $a$ is a length scale of the cross-section and $a \ll \ell$. This relationship implies that the stress-per-unit-span on a 2D cross-section can be estimated as
\begin{align}
  \label{eqn:stresslaw}
  \tau \sim \frac{\mu \umax}{a \log(\ell/a)} \qquad \text{for } a \ll \ell \, .
\end{align}
In interpreting our 2D simulations, we will treat the span, $\ell$, as
fixed. Recall that $L$ denotes the total perimeter of the 2D cross-section. Since $L$ and $a$ each represent a characteristic scale of the cross-section, they can often be interchanged in scaling analysis.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.9 \textwidth]{./figs/area_drag.pdf}
\caption{Area and drag: (a) The body area measured in the simulations (black) shown against the scaling-law prediction~\eqref{area_predict} (dotted red), the two of which agree closely. (b) The horizontal drag (black) on the body as it erodes, along with the viscous (green) and pressure (blue) contributions. The scaling prediction can be rearranged to give estimate~\eqref{dragscaling} for the viscous drag (dotted red).}
\label{area_drag}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure from datafile 01circ1024aaa;
% Uses 01circ1024.in with epsfac = 10, sigfac = 10, dt = 1e-7, fixarea = 0, fixpdrop = 0

The body's rate of area reduction is given by integrating the absolute shear stress around the boundary
\begin{align}
\dot{A} = - \int_{\gamma} \atau \, ds \,  = - \mean{\atau} L \, ,
\end{align}
which is an {\em exact} relationship. Inserting scaling law~\eqref{eqn:stresslaw} gives
\begin{align}
\dot{A} \sim \frac{ - \mu \umax}{\log(\ell/a)} \qquad \text{as } a \to 0 \, . 
\end{align}
Noting that $A \sim a^2$ allows one to solve the ODE, giving
\begin{align}
\label{area_predict}
\frac{A}{A_0} \left( 1 - c_1 \log{\frac{A}{A_0}} \right) \sim \frac{t_f - t}{t_f} \quad \text{as } t \to t_f \, .
\end{align}
Here, $t_f$ is the time of vanishing, $A_0$ is the body's initial area, and $c_1$ is a free constant. The above is an {\em implicit} relationship for how the area of an eroding body scales down in time, which we can use to test our numerical simulation. In Fig.~\ref{area_drag}(a) compare the area measured in our numerical simulation (black curve) against the above scaling law (red dotted curve) with $c_1 = 0.24$ a fit parameter. The two agree remarkable well throughout the entire simulation, thus co-validating the simulation and asymptotic results.

The drag exerted by the eroding body


The drag on the eroding body offers a second check on our simulation. This quantity will also be of great interest in its own right for characterizing a porous-medium.



%\ref{eqn:drag}

In Fig.~\ref{area_drag}(b), we show the horizontal drag $F_D$ measured on the body as it erodes. Note that, in the context of 3D slender-body theory, this $F_D$ should be interpreted as the drag per unit span. The figure shows the drag to decrease  gradually at first, then abruptly tend to zero in the final moments as the body vanishes. This behavior is consistent with fact that drag vanishes {\em logarithmically} with body-size in 2D Stokes flow. We also show in the figure the separate contributions of the viscous and the pressure drag. Initially, these two contributions are comparable, with a slightly greater level of pressure drag. However, as the body erodes and assumes a more slender form, the pressure drag decays more rapidly and viscous drag dominates.

As a final check, we can estimate the drag (per unit span) using slender-body theory via the formula
\begin{align}
\label{dragscaling}
\frac{F_D}{4 \pi} \sim \frac{ \mu U}{\log(\ell/a)}.
\end{align}
The normalization factor of $4 \pi$ produces an {\em exact} relationship (under the assumptions of slender-body theory) for the case of a {\em circular} cylinder, where $a$ is taken to be the radius. To generalize to other shapes, we define $a = \sqrt{A/\pi}$ and fit $\ell$ to get $\ell = 2.3 a_0$.

\todo[inline]{Clean up this section}

\subsection{Local analysis for the limiting shape}

With the vanishing rate understood, we now seek to quantify the limiting shape observed in Fig.~\ref{shrink_intface}(a). Certain features of this shape can be predicted analytically by appealing to the principal that, in long time, the shear stress becomes uniformly distributed along the body. In particular, consider the angle formed at the front and rear stagnation points. In a small region around this point, we can neglect body curvature and consider the problem of Stokes flow around an infinite wedge. We aim to determine the wedge's opening angle, $\oangle$, through the principle of uniform stress. Exact solutions can be obtained to this problem via separation of variables in polar coordinates $(r, \theta)$~\cite{poz1997}. In this section alone, $\theta$ denotes the polar coordinate (not the local tangent angle along the body). The corresponding stream function is assumed to take the form $\psi = r^{\lambda}f(\theta)$, with $\Delta^2 \psi = 0$, which gives the 4th order ODE~\cite{poz1997}
\begin{align*}
  f'''' + 2(\lambda^2 - 2 \lambda + 2)f'' + \lambda^2(\lambda-2)^2 f =
  0.
\end{align*}

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.4 \textwidth]{./figs/corner.pdf}
\caption{Schematic of 2D Stokes flow near a corner: The flow around an infinite wedge of opening angle $\oangle$ is described by a stream-function $\psi(r,\theta)$ for $\theta \in [-\theta_0, \theta_0]$}.
\label{corner}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
 
This ODE is subject to no-slip boundary conditions along the wedge $f(\thb) = f'(\thb) = 0$, where $\thb = \pi - \oangle/2$, along with the condition of odd-symmetry $f(0) = f''(0) = 0$ (corresponding to up-down symmetry of the flow).  The corresponding shear stress evaluated on the surface of the wedge is $\tau = \mu r^{\lambda-2} f''(\thb)$. Thus, the wedge of uniform stress corresponds to $\lambda = 2$. For this value, the solution for $f$ satisfying odd symmetry is
\begin{align*}
  f(\theta) = B \sin (2 \theta) + C \theta.
\end{align*}
Imposing the no-slip boundary conditions gives the condition
\begin{align*}
  \sin(2 \thb) - 2 \thb \cos(2 \thb) = 0,
\end{align*}
which has a solution $\thb \approx 129$ degrees. This gives an opening angle of $\oangle = 2(180^{\circ} - \thb) \approx 102$ degrees. 
% Pozrikidis page 239: symmetric flow.


 
We note that this uniform-stress shape is closely related to the so-called `optimal profile in Stokes flow' found by Pironneau (1973) \cite{pir1973}, who determined the shape that minimizes drag in 3D Stokes flow subject to the constraint of fixed volume (see also \cite{mon-lau2015} for an interesting related shape). Pironneau's 3D shape has an opening angle of $120^{\circ}$ and ours is simply the 2D counterpart with its slightly different $102^{\circ}$ opening angle. Previous numerical simulations on erosion in 3D Stokes flow revealed that, in long time, an eroding body tends to a shape that is approximately (though not precisely) Pironneau's optimal profile \cite{mit-spa2016}.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.85 \textwidth]{./figs/fixed_intface.pdf}
\caption{Fixed-area simulations: (a) Interfaces of a body eroding under shear stress but with the area artifically kept constant. Inset: zoom near the rear stagnation point, showing that the corner is actually smooth on a fine scale. (b) The stress distribution on the surface of the body. Over time, the stress becomes more uniform.}
\label{fixed_intface}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure from datafile 01circ1024c5
% Uses 01circ1024.in with epsfac = 5, sigfac = 5, dt = 2e-4, fixarea = 1, fixpdrop = 0

\subsection{Fixed-area simulations}

To compare with this analytical prediction, we aim to measure the opening angles formed in our numerical simulations. However, our simulations lose accuracy just in the final moments as the body is vanishing due to the shear stress blowing up (in accordance with the scaling laws discussed in Section \ref{sec:scaling}). To circumvent this problem, we could restart our simulation with a scaled-up version of the the near-final  body as the initial condition and iterate the process until convergence. A simpler solution, though, is to remove the effect of shrinking by modifying the normal velocity $\Vn$ to have zero mean,
\begin{align*}
\Vn \leftarrow \Vn - \mean{\Vn} \, .
\end{align*}
This modification allows erosion to sculpt the body as it normally would but artificially keeps the area fixed. We show in Fig.~\ref{fixed_intface}(a) several interfaces of this modified erosion process at equally-spaced times. Notice the body obtains a similar profile as observed previously, but with fixed area. Importantly, more numerical accuracy is now available to quantify the terminal state. The inset in Fig.~\ref{fixed_intface}(a) shows a zoom of the body's rear stagnation point, demonstrating that the near-corner is actually smooth on a fine scale, in accordance with our numerical smoothing. 
Likewise, Fig.~\ref{fixed_intface}(b) shows the stress distribution on the evolving body, revealing that stress becomes more uniform as time proceeds. Interestingly, the slight rise in shear near the front/rear corners that was seen in Fig.~\ref{shrink_intface}(b) is no longer present, suggesting that the effect was due to loss of accuracy.
Here, time is normalized by the same vanishing time $t_f = 1.79E-2$ as in Fig.~\ref{shrink_intface}. Curiously, about 3 multiples of $t_f$ are required to reach an approximate steady-state, which contrasts with previous studies of high-Reynolds-number erosion, in which a satisfactory steady-state was usually reached before the body vanished~\cite{moo-ris-chi-zha-she2013}.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.85 \textwidth]{./figs/arangle.pdf}
\caption{Shape characteristics of an eroding body: (a) The aspect ratio, defined as the width to height, versus time. (b) The measured opening angle versus time. For both measurements, we show three cases of the smoothing parameters: $\eps = \sigma = 20/1024, 10/1024,$ and 5/1024. In the most resolved simulation (5/1024) the aspect ratio converges to 2.7 and the opening angle converges to the predicted value of $102^{\circ}$ in long time.}
\label{fig:arangle}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure from datafile 01circ1024c5
% Uses 01circ1024.in with epsfac = 5, sigfac = 5, dt = 2e-4, fixarea = 1, fixpdrop = 0

The fixed-area simulations allow for us to precisely measure characteristics of the shape. In particular, Fig.~\ref{fig:arangle} shows measurements of the body's aspect ratio (its width to height) and the front opening angle as they vary in time. We show these measurements for three simulations in which the smoothing parameters, $\eps$ and $\sigma$, are sequentially reduced, allowing us to assess convergence in these parameters. As shown in Fig.~\ref{fig:arangle}(a), the aspect ratio begins at one for the initial circular geometry and increases in time as erosion sculpts a more slender shape. The aspect ratio reaches a long time limit of about 2.7 in the most resolved simulation. Fig.~\ref{fig:arangle}b shows the body's opening angle, which we measure by fitting the tangent angle $\theta(\alpha)$ with a 7th degree polynomial over a region excluding the front/rear stagnation point (where a near-corner is approximated by a smooth curve of very high curvature). The polynomial fit is then extrapolated to the stagnation point to obtain an angle estimate (subject to some uncertainty, which we estimate below). As seen in Fig.~\ref{fig:arangle}a, the opening angle is initially $180^\circ$, corresponding to the initially circular geometry. Erosion causes the angle to form after a short time, and the angle becomes increasingly sharp as it converges to the value $102^\circ$ in the most resolved simulation. This coincides exactly with the valued predicted by our local solutions.

To examine the influence of the smoothing parameters, $\eps$ and
$\sigma$, we show in Table~\ref{table:arangle} the measurements of the
aspect ratio and the opening angle for different simulations. We fix the total number of discretization points at $N_\iin = 1024$ and sequentially reduce the smoothing with $\eps$ and $\sigma$ always equal. We choose the values $20/1024$, $10/1024$, and $5/1024$. 
Loosely, this corresponds to smoothing over the nearest 20, 10, and 5 grid points respectively. As seen in the table, the aspect ratio converges to a values of $2.65$ and the opening angle converges to $102^{\circ}$. We also estimate the uncertainty in the angle measurements by varying the region of the polynomial fit and the degree of the fit. As shown in the table, as the smoothing parameters are reduced, the angle measurements become more precise.

% Table
%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{table}%[htbp]
\begin{center}
\caption{Final aspect ratio and opening angle
} 
\vspace{0.3 pc}
\label{table:arangle}
\begin{tabular}{c c c}
\hline
\hspace{0.5pc} smoothing parameters: $\eps$ and $\sigma$
\hspace{0.5pc} & final aspect ratio 
\hspace{0.5pc} & final opening angle \\
\hline
20/1024		& 2.55	& $110^\circ \pm 6^\circ$	\\
10/1024		& 2.62	& $104^\circ \pm 4^\circ$	\\
5/1024		& 2.65	& $102^\circ \pm 2^\circ$	\\
\hline
\end{tabular}
\end{center}
\end{table}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% npts = 1024


\subsection{Convergence test}

As a final validation, we now aim to verify that our method converges with second-order accuracy in time. To this end, we run the same single-body simulation from Figs.~\ref{01bodseq} and \ref{shrink_intface} (except with a coarser $N_\iin=256$) to a stopping time of $t_s = 10^{-2}$. This stopping time is 56\% of the time it takes the body to vanish, and was selected so that the body will have eroded substantially but is not so small that accuracy is compromised. We assess error by measuring the difference between simulations of successive resolutions (i.e.~we verify Cauchy convergence). In particular, we measure the $L^2$-difference of the body shapes obtained at the stopping time. At each stage we halve the timestep $\Delta t$. Table \ref{convtab} shows the $L^2$-errors between successive simulations, along with the order of accuracy as obtained by Richardson-extrapolation-type calculations. The table confirms that our method to converges with second-order accuracy. In the table, we also show the CPU time of the simulation run on a single processor (though the algorithm is easily parallelized), showing a linear increase in computational time.

% Table
%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{table}%[htbp]
\begin{center}
\caption{Convergence test: We run single-body erosion simulations to a stopping time of $t_s = 10^{-2}$ (56\% of the vanishing time) and measure the $L^2$-difference in shapes obtained with successive temporal resolutions. The tests confirm the method to be second-order accurate in time. The last column shows the measured CPU time which increases linearly as the time-step is refined.
}
\vspace{0.3 pc}
\label{convtab}
\begin{tabular}{l l l l}
\hline
\hspace{0.0pc} $\Delta t/t_s$
\hspace{0.5pc} & error 
\hspace{0.5pc} & order
\hspace{0.5pc} & CPU time \\
\hline
%
1/50		& 1.68E-5		& --		& 53 secs     	\\
1/100	& 4.84E-6		& 1.79	& 1.8 mins   	\\
1/200	& 1.30E-6		& 1.90	& 3.5 mins  	\\
1/400	& 3.36E-7		& 1.95	& 6.9 mins  	\\
1/800	& 8.54E-8		& 1.98	& 14 mins   	\\
1/1600	& 2.15E-8		& 1.99	& 28 mins  	\\
1/3200	& 5.40E-9		& 1.99	& 56 mins    	\\
1/6400	& --			& --		& 111 mins	\\
%
\hline
\end{tabular}
\end{center}
\end{table}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Parameters in this test are: 01circ256, nits = 7, dt0 = 1e-4, tfin = 1e-2
% epsfac = 10, sigfac = 10, fixarea = 0, fixprdop = 0


\section{Results: Multi-body erosion}
\label{MultiResults}

\subsection{Fixed pressure drop condition and validation}

With the numerical method validated, we are now ready to simulate the erosion of multiple bodies. We make one important conceptual change to our model. For a realistic porous medium composed of many solid bodies, the condition of a fixed incoming flow rate, $\umax$, is somewhat artificial. A more realistic condition is that the pressure difference from one end to another is held fixed. For example, in groundwater flow, this condition would correspond to a recharge region of given hydraulic head connecting to a discharge region of another hydraulic head. 

We therefore impose the condition of a fixed pressure difference by dynamically controlling the incoming flow-rate, $\umax$. This is achieved by first computing the Stokes flow with $\umax = 1$ prescribed, then measuring the pressure at a location upstream ($x = -2$) and downstream ($x=2$) of the eroding bodies. The vertically-averaged upstream and downstream pressures are given by
\begin{align}
p_{-} = \frac{1}{2} \int_{-1}^{1} p(-2,y) \, dy \, , \qquad
p_{+} = \frac{1}{2} \int_{-1}^{1} p(+2,y) \, dy \, .
\end{align}
We then rescale the computed density function by the pressure difference
\begin{align}
\eeta \leftarrow \frac{\eeta}{(p_{-} - p_{+})} \, .
\end{align}
This rescaling maintains a {\em fixed} pressure difference between the upstream ($x=-2$) and downstream ($x=2$) positions. Because the Stokes equations are linear, such a rescaling is permissible and does not alter the accuracy of our method. Furthermore, {\em dynamic} rescaling is also permissible because the Stokes equations are memoryless (i.e.~there is no time derivative present in the PDEs).

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{table}%[htbp]
\begin{center}
\caption{Convergence test for multiple-body erosion with fixed-pressure-drop condition. In this test, we use 20 bodies with $N_{\iin} = 128$ grid points on each. We run the simulations to a stopping time of $t_s = 4 \times 10^{-3}$ (24\% of the time it takes for {\em all} bodies to vanish). We measure the {\em combined} $L^2$-difference in the shapes of {\em all} bodies. The table confirms that the method maintains second-order accuracy in time, even with multiple bodies and a time-varying inflow rate $\umax$.
%We compare the shapes of {\em all} bodies from simulations of successive resolution using {\combined} $L^2$-norm
}
\vspace{0.3 pc}
\label{convtab}
\begin{tabular}{l l l l}
\hline
\hspace{0.0pc} $\Delta t/t_s$
\hspace{0.5pc} & error 
\hspace{0.5pc} & order
\hspace{0.5pc} & CPU time \\
\hline
%
1/10     	& 2.67E-5  	& --        	& 14 mins  	\\
1/20     	& 7.23E-6  	& 1.88 	& 27 mins  	\\
1/40     	& 1.95E-6  	& 1.89 	& 52 mins  	\\
1/80     	& 4.90E-7  	& 1.99 	& 1.7 hours	\\
1/160     	& 1.25E-7  	& 1.97  	& 3.4 hours	\\
%
\hline
\end{tabular}
\end{center}
\end{table}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Parameters in this test are: 20circ128, nits = 5, dt0 = 4e-4, tfin = 4e-3
% epsfac = 10, sigfac = 10, fixarea = 0, fixprdop = 1

Briefly, to verity that the rescaling does not alter accuracy, we show in Table \ref{convtab} a convergence test for a 20-body simulation with the condition of fixed pressure drop imposed. The table confirms that the method retains second-order accuracy in time. In the last column, we show the computational times, indicating that the 20-body simulations require more runtime than the single-body case. Although the GMRES-iteration count is independent of the spatial resolution, $N_{\iin}$, it can depend on the number of bodies and/or their configuration. To illustrate this point, we show in Table \ref{itertab} the GMRES count for various cases ...

% Table: GMRES iterations
%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{table}%[htbp]
\begin{center}
\caption{GMRES Iterations: the tolerance is 1E-8.
}
\vspace{0.3 pc}
\label{itertab}
\begin{tabular}{c c | c c}
\hline
\hspace{0.5pc} Number of bodies
\hspace{0.5pc} & GMRES iterations 
\hspace{0.5pc} & Resolution, $N_{\iin}$
\hspace{0.5pc} & GMRES iterations  \\
\hspace{0.0pc} ($N_\iin = 128$ fixed) & 
\hspace{0.5pc} &(10 bodies) & \\
\hline
%
10	& 223	& 32	    	& 228	\\
15	& 292	& 64    	& 226	\\
20	& 363	& 128	& 223	\\
30	& 496	& 256	& 223	\\
40	& 676	& 512	& 223	\\
50	& 991	& 1024	& 223	\\
%
\hline
\end{tabular}
\end{center}
\end{table}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% In these tests I always use 128 points per body.

\subsection{Multi-body erosion}

We now discuss some physical aspects of multi-body erosion revealed by our simulations. Figure~\ref{fig:06bodies} shows a simulation of 6 eroding bodies, each initially circles of various sizes and positions. Over time, erosion not only diminishes the size of the bodies, but also alters their shapes considerable. As in the single-body simulations, corner-like features develop, but not in locations that are easily predictable. Rather, when and where these sharp features develop depends on inter-body feedback as mediated by the Stokes flow.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.9 \textwidth]{./figs/06bod.pdf}
\caption{\label{fig:06bodies} 6 bodies.
}
%A time lapse of 50 bodies eroding in a viscous flow.  The boundary conditions are a constant pressure drop that creates a flow from the left to right.  The rate of erosion is proportional to the shear stress which is equivalent to the vorticity evaluated on the bodies.  The colors represent the vorticity, so regions with large vorticity (in magnitude) are regions where the flow will erode the fastest.
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure generated from data file 50circ512p5, 
%which uses 50circ512.in with epsfac = 30, sigfac = 10, dt = 1e-4, fixpdrop = 1

The initial configuration in  Fig.~\ref{fig:06bodies} was selected to have several near contacts between bodies, for example between bodies 1 \& 2, 3 \& 5, and 5 \& 6. Our method handles these near contacts without difficulty. Interestingly, erosion appears to preferentially remove material from these regions of near contact, as the narrow spacing between bodies expands rather rapidly. For example, the spacing between bodies 1 \& 2 is initially very small, but by the second frame, is comparable to the spacing between bodies 3 \& 4. Even more interesting, the bodies tend to develop flat faces where there are near contacts. This effect leads to the appearance of straight channels in between bodies, for example between bodies 1 \& 2, 3 \& 5, and 5 \& 6. Once formed, these straight channels persist until the bodies have nearly vanished.

The vorticity field not only allows us to visualize regions of high shear, but also allows us to identify preferred channels with most intense flow. Figure~\ref{fig:06bodies} shows that the flow is concentrated primarily in a single channel that runs horizontally below bodies 1 \& 2 and above bodies 3, 5, \& 6. This main channel widens the fastest, and secondary channels follow (e.g.~between bodies 1 \&2 or 3 \& 5 or 5 \& 6). Since the pressure drop across the cell is fixed, the overall flow rate increases as the bodies erode. This can be seen by the overall vorticity magnitude growing in time. By the final frame shown, body 4 has vanished completely and our method handles this event seamlessly.

%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
\begin{figure}%[htbp]
\begin{center}
\includegraphics[width = 0.95 \textwidth]{./figs/mbodyplots.pdf}
\caption{\label{fig:mbodyplots} plots to go with 6 body simulation.
}
\end{center}
\end{figure}
 %^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^%
% Figure generated from data file 50circ512p5, 
%which uses 50circ512.in with epsfac = 30, sigfac = 10, dt = 1e-4, fixpdrop = 1

We further quantify many of these observations in Fig.~\ref{fig:mbodyplots}. First, Fig.~\ref{fig:mbodyplots}(a) shows area fraction versus time. The area fraction is the total area of all bodies as compared to the domain area, i.e.~the 2D counterpart of volume fraction. The initial configuration of 6 circles comprises about 40\% of the domain area, and this percentage steadily decreases as the bodies erode. Figure \ref{fig:mbodyplots}(b) shows the inlet/outlet flow-rate, $\umax$, over time. Since we have fixed the pressure drop across the cell in these simulations, $\umax$ steadily increases as the bodies diminish and provide less resistance. Here, the vertical axis is logarithmic, and so the plot suggests exponential increase of $\umax$ at early times. This rapid increase in flow is likely due to the erosion-induced channelization observed above. In Fig.~\ref{fig:mbodyplots}(c) we show the total drag, summed over all bodies, versus time. Though the bodies diminish due to erosion, the steady increase of $\umax$ causes the total drag to remain relatively constant. Only near the end of the simulation does the drag decrease rapidly to zero. To remove the effect of increasing flow rate, we show in Fig.~\ref{fig:mbodyplots}(d) the total drag scaled on $\umax$. This value is a measure for the aggregate {\em resistance} of all bodies. Due to linearity of the Stokes equations, this measure does not depend on the flow-rate $\umax$, only on the bodies and their configuration. As seen here, the resistance decreases rapidly as the bodies erode. Since the vertical axis is logarithmic, the plot suggests an exponential decrease in resistance at early times, which is likely connected to the channelization process.

In Fig.~\ref{fig:mbodyplots} we also plot the same quantities for the 50-body simulation that was shown in Fig.~\ref{fig:50bodies} of the introduction. Overall, these plots support the same trends seen in the 6-body simulation. The initial area-fraction of the 50-body simulation is only slightly higher, about 45\%, and this fraction decreases steadily as bodies erode. The flow rate $\umax$ again increases very rapidly with time, though with a significantly smaller initial value due to the higher resistance provided by 50 bodies. As before, the total drag remains relatively constant throughout most of the simulation and then abruptly decreases to zero in the final moments. Our measure of resistance, $F_D/(4 \pi \umax)$, again decreases very rapidly in the early moments when channels are initially formed. Though the area fractions of the two simulations are nearly the same, the 50-body configuration provides about 5 times more resistance.


\newpage

Good word: Spontaneous channelization

\vsp{3}
Possible list:
\begin{itemize}
\item Show multiple body simulation with fixed flow rate
\item Then simulation with fixed pressure drop
\item GMRES counts
%
\item $\bigO(5-10)$ bodies
	\begin{itemize}
	\item Area and Drag
	\item Long channels between flat faces
	\end{itemize}
\item $\bigO(50)$ bodies
	\begin{itemize}
	\item Area and Drag
	\end{itemize}
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions\label{s:conclusions}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{\bf Acknowledgments} The authors would like to thank Manas
Rachh for supplying the FMM for the Stokes double-layer potential.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
\section{Error estimates for near-singular integration \label{A:AppendixA}} 
\end{appendices}


\bibliographystyle{plainnat} 
\bibliography{refs}
\biboptions{sort&compress}
\end{document}


