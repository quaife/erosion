\documentclass[preprint, 10pt]{elsarticle}

\newcommand{\mcaption}[2]{\caption{\small \em #1}\label{#2}}
\newcommand{\secref}[1]{\ref{#1}}

\input{preambles.tex}
\begin{document}

\title{Methods paper for erosion}

\author[Nick]{M.~Nicholas J.~Moore}
\author[Bryan]{Bryan D.~Quaife}
\address[Nick]{Department of Mathematics and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}
\address[Bryan]{Department of Scientific Computing and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}

\begin{abstract} 
We consider two dimensional eroding bodies in Stokes flow
\end{abstract}

\begin{keyword}
  Stokes flow \sep Erosion \sep Boundary integral method \sep
  Fluid-structure interaction \sep Fast multipole methods 
\end{keyword}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction\label{s:intro}}

This is a methods paper
\begin{itemize}
  \item Boundary integral equation formulation
  \item How we compute the shear stress and pressure
  \item Multiple bodies
  \item Avoiding stokes paradox
  \item {\thL} formulation
  \item Regularization
\end{itemize}

\cite{moo-ris-chi-zha-she2013}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Formulation\label{s:formulation}} 
Let us first define the main variables used to model erosion.  We only
consider flows that are confined by a solid wall $\Gamma$ that encloses
$M$ eroding bodies.  The bodies are denoted as $\gamma_k$,
$k=1,\ldots,M$, and we write $\gamma = \gamma_1 \cup \cdots \cup
\gamma_M$.  Neglecting inertial forces, the dynamics of the fluid is
fully characterized by the position of the bodies $\xx_k(s,t) \in
\gamma_k$, where $s$ is the arclength and $t$ is time.  Given
$\xx_k(s,t)$, $k=1,\ldots,M$, derived variables include the fluid
velocity $\uu$, the pressure $p$, and the shear stress $\tau$.   On the
bounding wall, we prescribed a velocity $\UU(\xx,t)$.  Then, the
governing equations are
\begin{equation}
\label{eqn:erosionModel}
\begin{split}
  \mu \Delta \uu = \grad p, &\hspace{20pt} \xx \in \Omega, \gap &&\mbox{conservation
of momentum}\\
\grad \cdot \uu = 0, &\hspace{20pt} \xx \in \Omega, \gap
&&\mbox{conservation of mass} \\
\uu = 0, &\hspace{20pt} \xx \in \gamma, \gap &&\mbox{no slip on the
bodies} \\
\uu = \UU, &\hspace{20pt} \xx \in \Gamma, \gap &&\mbox{outer wall
velocity} \\
\dot{\xx}(t) = \abs{\tau} \nn, &\hspace{20pt} \xx \in \gamma,
&&\mbox{erosion model},
\end{split}
\end{equation}
where $\nn$ is the outward unit normal vector which points away from the
fluid.  The outer wall is formed by rounding off the corners of $[-3,3]
\times [-1,1]$, and we enforce the Hagen-Poiseuille flow
\begin{align*}
  \uu(\xx) = (1-y^2,0)
\end{align*}
on $\Gamma$.  The boundary of the fluid domain is $\bd\Omega = \gamma_1
\cup \cdots \cup \gamma_M \cup \Gamma$.  To minimize the boundary
effects of the inflow and outflow, we only place bodies in the center
third, $[-1,1] \times [-1,1]$, of the fluid domain.
\begin{figure}[htpb]
  \centering
  \input{figs/schematic.tikz}
  \caption{\label{fig:schematic} A schematic for the governing
    equations.  A no-slip boundary condition is imposed on each body
    $\gamma_k$ whose unit normal points outward relative to the
    geometry.  On the outer geometry $\Gamma$, a pipe flow is imposed.
    The bodies are eroded according to the shear stress applied by the
    Stokesian fluid.  Finally, the bodies are constrained to the middle
    third of the channel that is located between the dashed lines.}
\end{figure}

We use a quasi-static approximation.  That is, at each time step, we
freeze the geometry, solve the incompressible Stokes equations, and then
update the geometry according to the erosion model.  A flow diagram is
illustrated in Figure~\ref{fig:workflow}.  The two steps inside the red
rectangle describes a time step in the quasi-static approximation
\begin{figure}[htpb]
  \centering
  \input{figs/workflow.tikz}
  \caption{\label{fig:workflow}A caption.}
\end{figure}

Our erosion model is based on the shear stress, and this model is
discussed in more detail in Section~\ref{sec:erosion}.  We then describe
how the incompressible Stokes equations are solved in $\Omega$ using a
boundary integral equation in Section~\ref{sec:bies}.  Then, in
Section~\ref{sec:qois}, we discuss how the shear stress, pressure, and
drag can all be readily computed.  


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Erosion Model} 
\label{sec:erosion}

To model erosion, we the normal velocity is prescribed to be
proportional to the absolute value of the shear stress.  The constant of
proportionality sets the time scale, and we set its value to be -1
\begin{align}
  \dot{\xx}(t) = \abs{\tau} \nn.
  \label{eqn:bodyEvolution}
\end{align}

\todo[inline]{Describe the erosion model and its justification}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boundary Integral Equation Formulation} 
\label{sec:bies}
Here we focus on solving the incompressible Stokes equations with
Dirichlet boundary conditions
\begin{alignat*}{3}
  \mu\Delta \uu &= \grad p, \qquad && \xx \in \Omega, \\
  \grad \cdot \uu &= 0,   && \xx \in \Omega, \\
  \uu &= \ff,  && \xx \in \bd\Omega.
\end{alignat*}
The viscosity $\mu$ sets the time scale, and we will assume that
$\mu=1$.  We start by defining the double-layer potential, which is the
convolution of the stresslet with a function $\eeta:\bd\Omega
\rightarrow \RR^2$,
\begin{align}
  \DD[\eeta](\xx) = \frac{1}{\pi} \int_{\bd\Omega} 
    \frac{\rr \cdot \nn}{\rho^2} \frac{\rr \otimes \rr}{\rho^2} 
    \eeta(\yy) \, ds_\yy, \quad \xx \in \Omega,
    \label{eqn:velocityDLP}
\end{align}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, and $\nn$ is the unit outward
normal at $\yy$.  For any density function $\eeta$, the double-layer
potential satisfies the incompressible Stokes equations, but the
double-layer potential can not capture velocity fields corresponding to
rigid body motions~\cite{pow-mir1987}.  A standard method to complete
the double-layer potential is to introduce a Stokeslets and rotlets
centered inside each interior body
\begin{align}
  S[\llambda_k,\cc_k] = \frac{1}{4\pi} \left(-\log \rho \II + 
    \frac{\rr \otimes \rr}{\rho^2} \right)\llambda_k
  \quad \text{and} \quad
  R[\xi_k,\cc_k] = \frac{\rr_k^\perp}{\rho^2}\xi_k, 
  \quad k=1,\ldots,M
  \label{eqn:stokeslet_rotlet}
\end{align}
where  $\rr = \xx - \cc_k$, $\cc_k$ is a point inside the $k^{th}$ body,
$\rr^\perp = (r_2,-r_1)$, and $\rho = \|\rr\|$.  Then, any solution of
the Stokes equations with a Dirichlet boundary condition $\ff$ can be
written as
\begin{align}
  \label{eqn:completed_DLP}
  \uu(\xx) = \DD[\eeta](\xx) + \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
              \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx), \quad \xx \in \Omega,
\end{align}
where the density function, Stokeslets, and rotlets satisfy
\begin{subequations}
\label{eqn:completed_BIE}
\begin{align}
  \ff(\xx) &= -\frac{1}{2}\eeta(\xx) + \DD[\eeta](\xx) + 
      \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
      \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx), \quad \xx \in \bd\Omega, 
      \label{eqn:DLP}\\
  \llambda_k &= \frac{1}{2\pi}\int_{\gamma_k} \eeta(\yy) \, ds_\yy,
  \quad k=1,\ldots,M
  \label{eqn:stokeslet} \\
  \xi_k &= \frac{1}{2\pi}\int_{\gamma_k} \yy^\perp \cdot \eeta(\yy)
  \, ds_\yy, \quad k=1,\ldots,M.
  \label{eqn:rotlet}
\end{align}
\end{subequations}
Finally, because of the incompressibility constraint, the boundary
condition must satisfy 
\begin{align*}
  \int_{\bd\Omega} \ff \cdot \nn \, ds_\yy = 0.
\end{align*}
The result is a rank-one null space of~\eqref{eqn:completed_BIE} which
is removed by adding the rank-one modification 
\begin{align}
  \NN_0[\eeta](\xx) = \int_{\Gamma} 
    (\nn(\xx) \otimes \nn(\yy))\eeta(\yy) \, ds_\yy, \quad \xx \in \Gamma.
\end{align}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computing Quantities of Interest}
\label{sec:qois}
There are several quantities besides the velocity that need to be
computed.  First, the governing equations~\eqref{eqn:erosionModel}
require the shear stress along $\gamma_k$.  In addition, to study
characteristics of the flow, the vorticity, pressure, and drag, and
resistivity will also be computed.  Once
equation~\eqref{eqn:completed_DLP} is solved for the density function,
Stokeslets, and rotlets, all of these quantities can be computed by
evaluating layer potentials that we now derive.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Shear Stress}
The shear stress is defined by
\begin{align*}
  \tau = -\left(\nabla \uu + \nabla \uu^T \right)\nn \cdot \ss,
\end{align*}
where $\ss$ and $\nn$ are the unit tangent and normal vectors,
respectively (Figure~\ref{fig:schematic}).  The velocity field of the
completed double-layer potential~\eqref{eqn:completed_DLP} involves
three terms: the double-layer potential $\DD$, the Stokeslets $S$, and
the rotlets $R$.  We first compute the deformation tensor $\ssigma =
\frac{1}{2}(\nabla\uu + \nabla\uu^T)$ for each of these terms
individually.

The deformation tensor of the double-layer
potential~\eqref{eqn:velocityDLP} at $\xx \in \Omega$ is
\begin{equation}
  \label{eqn:shearStressDLP}
  \begin{aligned}
  \ssigma^\DD(\xx) = \frac{1}{2\pi}\int_{\bd\Omega} &\left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn) 
    \right. \\
    &\left.
    +\frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right) ds_\yy.
  \end{aligned}
\end{equation}
We require the deformation tensor on $\bd\Omega$, and this requires
taking the limit of equation~\eqref{eqn:shearStressDLP} when $\xx$ tends
to $\xx_0 \in \bd\Omega$.  This limiting value is given
by~\cite{qua-bir2014a}
\begin{align*}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}\sigma_\DD(\xx) =
  J[\eeta](\xx_0) + \ssigma^\DD(\xx_0), \quad \xx_0 \in \bd\Omega,
\end{align*} 
where
\begin{align*}
  J[\eeta](\xx_0) = \frac{1}{2}\pderiv{\eeta}{\ss} \cdot \ss
  \left[ \begin{array}{cc}
    s_x^2 - s_y^2 & 2s_x s_y \\ 2s_x s_y & s_y^2 - s_x^2
  \end{array}\right].
\end{align*}
The deformation tensor due to the Stokeslets and
rotlets~\eqref{eqn:stokeslet_rotlet} are
\begin{align*}
  \ssigma^S(\xx_0) &= \sum_{k=1}^{M}
    \frac{\rr \cdot \llambda_k}{4\pi\rho^2} \left(
    \II - \frac{2}{\rho^2} \rr \otimes \rr \right),  \\
  \ssigma^R(\xx_0) &= \sum_{k=1}^M
    -\frac{\xi_k}{\rho^4} \left(\rr \otimes \rr^\perp + 
    \rr^\perp \otimes \rr \right),
\end{align*}
where $\rr = \xx - \cc_k$, $\cc_k$ is the point chosen inside body
$\gamma_k$, and $\rho = \|\rr_k\|$.  Now that the deformation tensor of
each component of the completed double-layer potential are computed, the
shear stress at $\xx_0 \in \bd\Omega$ can be computed as
\begin{align*}
  \tau = -2 \left(J[\eeta](\xx_0) + \ssigma^\DD(\xx_0) + 
    \ssigma^S(\xx_0) + \ssigma^R(\xx_0)\right) \nn \cdot \ss.
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Vorticity}
For the Stokes equations, on boundaries that have a no-slip boundary
condition, the shear stress is equivalent to the vorticity $w = v_x -
u_y$.  Therefore, to compute the $w(\xx)$ for $\xx \in
\overline{\Omega}$, we only need to compute $w(\xx)$ for $\xx\Omega$.
As we did for the shear stress, we compute the vorticity due to the
double-layer potential, Stokeslets, and rotlets individually.  The
vorticity of the double-layer potential~\eqref{eqn:velocityDLP} at
$\xx \in \Omega$ is
\begin{align}
  w^{\DD}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} 
    \frac{(\xx \cdot \eeta)(\xx \cdot \nn^\perp) + 
    (\xx \cdot \nn)(\xx \cdot \eeta)}{\rho^4}ds_{\yy}.
  \label{eqn:vorticityDLP}
\end{align}
The vorticity due to the Stokeslet is
\begin{align*}
  w^S(\xx) = -\frac{1}{\pi} \sum_{k=1}^{M} 
    \frac{\rr \cdot \llambda_k^\perp}{\rho^2},
\end{align*}
and the vorticity of a rotlet is zero.  Therefore, once the density
function and Stokeslets are computed, the vorticity at $\xx \in \Omega$
is
\begin{align*}
  w(\xx) = w^\DD(\xx) + w^S(\xx).
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Pressure}
To compute the pressure at $\xx \in \overline{\Omega}$, we follow the
same procedure used for the shear stress.  We first find the pressure of
the double-layer potential for $\xx \in \Omega$, and the find the jump
that results from taking the limit of $\xx$ to $\xx_0 \in \Gamma$.
Then, we compute the pressure due to the Stokestlet and rotlet
terms~\eqref{eqn:stokeslet_rotlet}.   For $\xx \in \Omega$,
the pressure is
\begin{align}
  p^{D}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot \eeta(\yy) \,ds_\yy.
  \label{eqn:pressureDLP}
\end{align}
To compute the pressure at $\xx_0 \in \bd\Omega$, we must take the limit
of equation~\eqref{eqn:pressureDLP} when $\xx$ tends to $\xx_0$.  The
limiting value is given by~\cite{qua-bir2014a}
\begin{align}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}p^\DD(\xx) =  
    \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0).
  \label{eqn:pressureDLPdiag}
\end{align}
The pressure due to the Stokeslets is
\begin{align*}
  p^S(\xx_0) = \sum_{k=1}^{M}\frac{\rr \cdot \llambda_k}{2\pi\rho^2},
\end{align*}
and the pressure due to the rotlets is zero.  Therefore, once the
density function and Stokeslets are computed, the pressure at a point
$\xx_0 \in \bd\Omega$ is
\begin{align*}
  p(\xx_0) = \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0) + 
              p^{S}(\xx_0).
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Drag}
\todo[inline]{check all signs in this section.  Fortran code assumes a
normal pointing into the eroding body and a tangent vector that
corresponds to a couterclockwise parameterization}
Finally, with the pressure and shear stress, the drag on a single body
with boundary $\gamma_k$ is
\begin{align}
  F_D = \int_{\gamma_k} (-p \nn + \tau \ss)\,ds.
  \label{eqn:drag}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Resistivity}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Methods\label{s:method}} 
There are three main numerical methods that need to developed: the
boundary integral equation solver~\eqref{eqn:completed_BIE}, computing
the quantities of interest in Section~\ref{sec:qois}, and updating the
shape of the eroding bodies with equation~\eqref{eqn:bodyEvolution}.  In
order to compute stable simulations with long time horizons, we use
numerical methods that achieve spectral accuracy in space, second-order
in time, and maintain an equispaced discretization of the bodies.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Spatial Discretization}
Each body will be represented with $N_\iin$ points.  Because
the boundary of each body is closed, it can be represented with spectral
accuracy as a Fourier series
\begin{align*}
  \xx^k(\theta) = \sum_{j = -N/2}^{N/2-1} \hat{x}_j^k e^{ij\theta}.
\end{align*}
There are several instances where derivatives of the shape must be
taken, and this is done with spectral accuracy by differentiating the
Fourier series term-by-term
\begin{align*}
  \frac{d\xx^k(\theta)}{d\theta} = 
      \sum_{j = -N/2}^{N/2-1} ij\hat{x}_j^k e^{ij\theta}.
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quadrature} 
There are several integrals that need to be evaluated.  This includes
the double-layer potential for target points both
off~\eqref{eqn:velocityDLP} and on~\eqref{eqn:DLP} the $\bd\Omega$, the
shear stress~\eqref{eqn:shearStressDLP}, the
vorticity~\eqref{eqn:vorticityDLP}, the pressure both
off~\eqref{eqn:pressureDLP} and on~\eqref{eqn:pressureDLPdiag} the
boundary, the drag~\eqref{eqn:drag}, and the resistivity.  Most of the
integrands involved in these calculations are both smooth and periodic,
and the suitably adjusted trapezoid rule will result in spectral
accuracy~\cite{tre-wei2014}.

To numerically solve the completed double-layer
potential~\eqref{eqn:completed_BIE}, we start by discretizing each
interior body $\gamma_k$ with $N_\iin$ points, and the outer geometry
$\Gamma$ with $N_\out$ points.  We let $N = MN_\iin + N_\out$ be the
total number of discretization points, and we apply the trapezoid rule
which results in the linear system
\begin{align*}
  \ff(\xx_i^k) = \sum_{\ell = 1}^{M}\sum_{j=1}^{N} 
    K(\xx_i^k,\xx_j^\ell) \eeta(\xx_j^\ell) 
      \Delta s_{j}^{\ell}, \quad i=1,\ldots,N, \: k=1\ldots,M
\end{align*}
where $\Delta s_j^\ell$ is the arclength term of $\gamma_\ell$ at
$\xx_j^\ell \in \gamma_\ell$, or the corresponding term if $\xx_k \in
\Gamma$, and
\begin{align*}
  K(\xx,\yy) = \frac{1}{\pi} \frac{\rr \cdot \nn}{\rho^2} 
      \frac{\rr \otimes \rr}{\rho^2},
\end{align*}
where $\rr = \xx - \yy$, and $\rho = \|\rr\|$, is the kernel of the
double-layer potential.  The Stokeslet~\eqref{eqn:stokeslet} and
rotlet~\eqref{eqn:rotlet} strengths are also discretized with the
trapezoid rule
\begin{align*}
  \llambda_k &= \sum_{k=1}^{N_\iin} \eeta(\xx_k) 
    \Delta s_{k} \quad \text{and} \quad
  \mu_k = \sum_{k=1}^{N_\iin} \xx_k^\perp \cdot
    \eeta(\xx_k) \Delta s_{k}.
\end{align*}
\todo[inline]{need to pick a good notation for the indices}



By applying a quadrature method, this results in a dense linear system
which we solve with fast multipole accelerated GMRES.  Because of the
second-kind nature of the integral equation, the number of GMRES
iterations is mesh independent (but not geometry independent), and the
overall complexity of the Stokes solver is proportional to the cost of a
single matrix-vector multiplication.  The shear stress, pressure, and
drag must also be computed using quadrature, and this can be interpreted
as a post-processing step once the density function, Stokeslets, and
rotlets are computed.  All the quadrature methods are described in
Section~\ref{sec:quadrature}

Once the shear stress is computed, it is used to update the shape of the
bodies according to the normal flow~\eqref{eqn:bodyEvolution}.  To
eliminate tangling and stretching of the mesh, we use a {\thL}
formulation~\cite{hou-low-she1994} which is described in
Section~\ref{sec:thetaL}.  In this section, we also describe our time
stepping method and two regularization terms that are necessary to
control the curvature of the bodies and to maintain spectral accuracy in
space.


\label{sec:quadrature}
There are several integrals that we need to compute including the
double-layer potential velocity field~\eqref{eqn:velocityDLP}, the shear
stress~\eqref{eqn:shearStressDLP}, vorticity~\eqref{eqn:vorticityDLP},
and the pressure~\eqref{eqn:pressureDLP}.  By using carefully choosing
the quadrature rules, high-order solutions can be computed.  For all the
integrals, the trapezoid rule is used since it achieves spectral
accuracy for smooth periodic functions.  However, care must be taken
when the source point and target points coincide.

For the velocity field, the kernel of the integral operator
\begin{align*}
  D(\xx,\yy) = \frac{\rr \cdot \nn}{\rho^2} 
               \frac{\rr \otimes \rr}{\rho^2}
\end{align*}
has a removable singularity when $\xx = \yy$.  In particular
\begin{align*}
  \lim_{\substack{\yy \rightarrow \xx \\ \yy \in \bd\Omega}} D(\xx,\yy) = 
  -\frac{\kappa(\xx)}{2\pi}\ss \otimes \ss,
\end{align*}
where $\kappa(\xx)$ is the curvature of $\bd\Omega$ at $\xx$.  By using
this limiting term in when applying the trapezoid rule, spectral
accuracy is achieved because of the smoothness and periodicity of the
integrand~\cite{tre-wei2014}.

For the shear stress and the pressure, we will use odd-even integration
which achieves spectral accuracy if the integrand is no stronger than
$\mathcal{O}(\rho^{-1})$.  Since both these integrands are too strong,
the singularity must be weakened.  This can be done by adding a constant
density function which has no effect on the shear stress and
pressure~\cite{poz1992}.  In particular, the shear stress due to the
double-layer potential is equivalent to
\begin{align*}
  \ssigma^{\DD}(\xx_0) &= \int_{\bd\Omega}K_\ssigma(\xx_0,\yy)
      \ssigma(\yy) \, ds_{\yy} \\ 
      &= \int_{\bd\Omega}K_\ssigma(\xx_0,\yy)
      (\ssigma(\yy) - \ssigma(\xx_0)) \, ds_{\yy}.
\end{align*}
For the pressure, the double-layer potential is equivalent to
\begin{align*}
  p^\DD(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot (\eeta(\yy) - \eeta(\xx_0)) \,ds_\yy.
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Fast Summation} 
The majority of the computational cost comes from evaluating the the
double-layer potential $\mathcal{D}$ in equation~\eqref{eqn:DLP}.  This
layer potential can be efficiently evaluated using a fast summation
method such as the Fast Multipole Method
(FMM)~\cite{gre-rok1987}\footnote{The FMM for the Stokes double-layer
poetntial was supplied by Manas Rachh.}.  By using the
FMM,~\eqref{eqn:completed_BIE} can be solved with $\mathcal{O}(N)$
operations, where $N$ is the total number of discretization points.

In our erosion model, the shear stress must be computed which requires
evaulating the layer potential~\eqref{eqn:shearStressDLP}.  In our
implementation, this calculation is done directly which requires
$\mathcal{O}(N^2)$ operations.  This complexity could be reduced with
the kernel-independent FMM~\cite{yin-bir-zor2004}.  However, since this
calculation is only computed once per time step, unlike the velocity
double-layer potential that must be evaluated at each GMRES iteration.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{{\thL} Formulation} 
\label{sec:thetaL}

We use a quasi-static approximation so that the velocity field
instantaneously changes with the changing geometry.  Therefore, we can
alternate between the two main aspects of our simulation
\begin{enumerate}
  \item Given a geometry, compute the shear stress of along the boundary
    of each of the bodies.
  \item Given the shear stress, update the geometry according to the
    erosion model.
\end{enumerate}

\vsp{2}
To handle boundary evolution, we use the {\thL}    method, which offers certain advantages in the ability to stabilize fluid-structure interaction problems. Throughout this section, we use the following conventions: the bodies are parametrized in the CCW direction and the normal vector points into the bodies (our out of the fluid).


In order to regularize boundary evolution, we modify
Eq.~(\ref{eqn:bodyEvolution}) to include a curvature-driven component
(also corrected errors in this equation)
\begin{equation}
\dot{\xx}(t) = \abs{\tau} \nn + \eps \elfun(L) \left(\kappa - \frac{2 \pi}{L} \right)
\end{equation}
The curvature term acts to smooth bodies that have high-frequency oscillations.

Simple form for my talk
\begin{equation}
\dot{\xx}(t) = \abs{\tau} \nn + \eps \kappa
\end{equation}

\todo[inline]{Artificial Diffusion} 
\todo[inline]{Gaussian Filter} 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results\label{s:results}} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions\label{s:conclusions}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
\section{Error estimates for near-singular integration \label{A:AppendixA}} 
\end{appendices}


\bibliographystyle{plainnat} 
\bibliography{refs}
\biboptions{sort&compress}
\end{document}


