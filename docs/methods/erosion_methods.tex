\documentclass[preprint, 10pt]{elsarticle}

\newcommand{\mcaption}[2]{\caption{\small \em #1}\label{#2}}
\newcommand{\secref}[1]{\ref{#1}}

\input{preambles.tex}
\begin{document}

\title{Methods paper for erosion}

\author[Nick]{M.~Nicholas J.~Moore}
\author[Bryan]{Bryan D.~Quaife}
\address[Nick]{Department of Mathematics and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}
\address[Bryan]{Department of Scientific Computing and Geophysical Fluid Dynamics Institute, Florida State University, Tallahassee, FL, 32306.}

\begin{abstract} 
We consider two dimensional eroding bodies in Stokes flow
\end{abstract}

\begin{keyword}
  Stokes flow \sep Erosion \sep Boundary integral method \sep
  Fluid-structure interaction \sep Fast multipole methods 
\end{keyword}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction\label{s:intro}}

This is a methods paper
\begin{itemize}
  \item Boundary integral equation formulation
  \item How we compute the shear stress and pressure
  \item Multiple bodies
  \item Avoiding stokes paradox
  \item {\thL} formulation
  \item Regularization
\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Formulation\label{s:formulation}} 
Let us first define the main variables used to model erosion.  We only
consider flows that are confined by a solid wall $\Gamma$ that encloses
$M$ eroding bodies.  The bodies are denoted as $\gamma_k$,
$k=1,\ldots,M$, and we write $\gamma = \gamma_1 \cup \cdots \cup
\gamma_M$.  Neglecting inertial forces, the dynamics of the fluid is
fully characterized by the position of the bodies $\xx_k(s,t) \in
\gamma_k$, where $s$ is the arclength and $t$ is time.  Given
$\xx_k(s,t)$, $k=1,\ldots,M$, derived variables include the fluid
velocity $\uu$, the pressure $p$, and the shear stress $\tau$.   On the
bounding wall, we prescribed a velocity $\UU(\xx,t)$.  Then, the
governing equations are
\begin{equation}
\label{eqn:erosionModel}
\begin{split}
  \mu \Delta \uu = \grad p, &\hspace{20pt} \xx \in \Omega, \gap &&\mbox{conservation
of momentum}\\
\grad \cdot \uu = 0, &\hspace{20pt} \xx \in \Omega, \gap
&&\mbox{conservation of mass} \\
\uu = 0, &\hspace{20pt} \xx \in \gamma, \gap &&\mbox{no slip on the
bodies} \\
\uu = \UU, &\hspace{20pt} \xx \in \Gamma, \gap &&\mbox{outer wall
velocity} \\
\dot{\xx}(t) = \abs{\tau} \nn, &\hspace{20pt} \xx \in \gamma,
&&\mbox{erosion model},
\end{split}
\end{equation}
where $\nn$ is the outward unit normal vector which points away from the
fluid, and $\mu$ is the fluid viscosity.  The outer wall is formed by
rounding off the corners of $[-3,3] \times [-1,1]$, and we enforce the
Hagen-Poiseuille flow
\begin{align*}
  \uu(\xx) = (1-y^2,0)
\end{align*}
on $\Gamma$.  The boundary of the fluid domain is $\bd\Omega = \gamma_1
\cup \cdots \cup \gamma_M \cup \Gamma$.  To minimize the boundary
effects of the inflow and outflow, we only place bodies in the center
third, $[-1,1] \times [-1,1]$, of the fluid domain.
\begin{figure}[htpb]
  \centering
  \input{figs/schematic.tikz}
  \caption{\label{fig:schematic} A schematic for the governing
    equations.  A no-slip boundary condition is imposed on each body
    $\gamma_k$ whose unit normal points outward relative to the
    geometry.  On the outer geometry $\Gamma$, a pipe flow is imposed.
    The bodies are eroded at a rate that is proportional to the
    magnitude of the shear stress applied by the Stokesian fluid.  The
    bodies are constrained to the middle third of the channel that is
    located between the dashed lines.}
\end{figure}

We use a quasi-static approximation.  That is, at each time step, we
freeze the geometry, solve the incompressible Stokes equations, and then
update the geometry according to the erosion model.  A flow diagram is
illustrated in Figure~\ref{fig:workflow}.  The two steps inside the red
rectangle describes a time step in the quasi-static approximation
\begin{figure}[htpb]
  \centering
  \input{figs/workflow.tikz}
  \caption{\label{fig:workflow}A caption.}
\end{figure}

Our erosion model is based on the shear stress, and this model is
discussed in more detail in Section~\ref{sec:erosion}.  We then describe
how the incompressible Stokes equations are solved in $\Omega$ using a
boundary integral equation in Section~\ref{sec:bies}.  Then, in
Section~\ref{sec:qois}, we discuss how the shear stress, pressure, and
drag can all be readily computed.  


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Erosion Model} 
\label{sec:erosion}

To model erosion, we the normal velocity is prescribed to be
proportional to the absolute value of the shear stress.  The constant of
proportionality sets the time scale, and we set its value to be -1
\begin{align}
  \dot{\xx}(t) = \abs{\tau} \nn.
  \label{eqn:bodyEvolution}
\end{align}

\todo[inline]{Describe the erosion model and its justification}
\cite{moo-ris-chi-zha-she2013}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Boundary Integral Equation Formulation} 
\label{sec:bies}
Here we describe a boundary integral equation for the governing
equations.   This requires solving the incompressible Stokes equations
with Dirichlet boundary conditions 
\begin{alignat*}{3}
  \mu\Delta \uu &= \grad p, \qquad && \xx \in \Omega, \\
  \grad \cdot \uu &= 0,   && \xx \in \Omega, \\
  \uu &= \ff,  && \xx \in \bd\Omega.
\end{alignat*}
and also computing several quantities of interest, including the shear
stress.  The viscosity $\mu$ sets the time scale, and we will assume
that $\mu=1$.  We start by defining the double-layer potential, which is
the convolution of the stresslet with a density function
$\eeta:\bd\Omega \rightarrow \RR^2$,
\begin{align}
  \DD[\eeta](\xx) = \frac{1}{\pi} \int_{\bd\Omega} 
    \frac{\rr \cdot \nn}{\rho^2} \frac{\rr \otimes \rr}{\rho^2} 
    \eeta(\yy) \, ds_\yy, \quad \xx \in \Omega,
    \label{eqn:velocityDLP}
\end{align}
where $\rr = \xx - \yy$, $\rho = \|\rr\|$, and $\nn$ is the unit outward
normal at $\yy$.  For any density function $\eeta$, the double-layer
potential satisfies the incompressible Stokes equations, but it can not
capture velocity fields corresponding to rigid body
motions~\cite{pow-mir1987}.  A standard method to remove this rank
deficiency is to complement the double-layer potential with a Stokeslets
and rotlets centered inside each interior body
\begin{align}
  S[\llambda_k,\cc_k] = \frac{1}{4\pi} \left(-\log \rho \II + 
    \frac{\rr \otimes \rr}{\rho^2} \right)\llambda_k
  \quad \text{and} \quad
  R[\xi_k,\cc_k] = \frac{\rr_k^\perp}{\rho^2}\xi_k, 
  \quad k=1,\ldots,M,
  \label{eqn:stokeslet_rotlet}
\end{align}
where  $\rr = \xx - \cc_k$, $\cc_k$ is a point inside the $k^{th}$ body,
$\rr^\perp = (r_2,-r_1)$, and $\rho = \|\rr\|$.  Then, any solution of
the Stokes equations with a Dirichlet boundary condition $\ff$ can be
written in terms of the completed double-layer potential
\begin{align}
  \label{eqn:completed_DLP}
  \uu(\xx) = \DD[\eeta](\xx) + \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
              \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx), \quad \xx \in \Omega,
\end{align}
where the density function, Stokeslets, and rotlets satisfy
\begin{subequations}
\label{eqn:completed_BIE}
\begin{align}
  \ff(\xx) &= -\frac{1}{2}\eeta(\xx) + \DD[\eeta](\xx) + 
      \sum_{k=1}^{M} S[\llambda_k,\cc_k](\xx) +
      \sum_{k=1}^{M} R[\xi_k,\cc_k](\xx) + \NN_0[\eeta](\xx),
      \quad \xx \in \bd\Omega, 
      \label{eqn:DLP}\\
  \llambda_k &= \frac{1}{2\pi}\int_{\gamma_k} \eeta(\yy) \, ds_\yy,
  \quad k=1,\ldots,M,
  \label{eqn:stokeslet} \\
  \xi_k &= \frac{1}{2\pi}\int_{\gamma_k} \yy^\perp \cdot \eeta(\yy)
  \, ds_\yy, \quad k=1,\ldots,M,
  \label{eqn:rotlet}
\end{align}
\end{subequations}
where 
\begin{align*}
  \NN_0[\eeta](\xx) = \int_{\Gamma} 
    (\nn(\xx) \otimes \nn(\yy))\eeta(\yy) \, ds_\yy,
\end{align*}
is being used to remove the rank one null space that results from the
compatibility constraint that results from the flux-free requirement of
$\ff$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Layer Potentials for Quantities of Interest}
\label{sec:qois}
There are several quantities besides the velocity that need to be
computed.  First, the governing equations~\eqref{eqn:erosionModel}
require the shear stress along $\gamma_k$.  In addition, to study
characteristics of the flow, the vorticity, pressure, and drag, and
resistivity will also be computed.  Once
equation~\eqref{eqn:completed_DLP} is solved for the density function,
Stokeslets, and rotlets, all of these quantities can be computed by
evaluating layer potentials that we now derive.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Shear Stress}
The shear stress is defined by
\begin{align*}
  \tau = -\left(\nabla \uu + \nabla \uu^T \right)\nn \cdot \ss,
\end{align*}
where $\ss$ and $\nn$ are the unit tangent and normal vectors,
respectively (Figure~\ref{fig:schematic}).  The velocity field of the
completed double-layer potential~\eqref{eqn:completed_DLP} involves
three terms: the double-layer potential $\DD$, the Stokeslets $S$, and
the rotlets $R$.  We first compute the deformation tensor $\ssigma =
\frac{1}{2}(\nabla\uu + \nabla\uu^T)$ for each of these terms
individually.

The deformation tensor of the double-layer
potential~\eqref{eqn:velocityDLP} at $\xx \in \Omega$ is
\begin{equation}
  \label{eqn:shearStressDLP}
  \begin{aligned}
  \ssigma^\DD(\xx) = \frac{1}{2\pi}\int_{\bd\Omega} &\left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn) 
    \right. \\
    &\left.
    +\frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right) \eeta(\yy) ds_\yy.
  \end{aligned}
\end{equation}
We require the deformation tensor on $\bd\Omega$, and this requires
taking the limit of equation~\eqref{eqn:shearStressDLP} when $\xx$ tends
to $\xx_0 \in \bd\Omega$.  The limiting value is given
by~\cite{qua-bir2014a}
\begin{align*}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}\sigma_\DD(\xx) =
  J[\eeta](\xx_0) + \ssigma^\DD(\xx_0), \quad \xx_0 \in \bd\Omega,
\end{align*} 
where
\begin{align*}
  J[\eeta](\xx_0) = \frac{1}{2}\pderiv{\eeta}{\ss} \cdot \ss
  \left[ \begin{array}{cc}
    s_x^2 - s_y^2 & 2s_x s_y \\ 2s_x s_y & s_y^2 - s_x^2
  \end{array}\right].
\end{align*}
The deformation tensor of the Stokeslets and
rotlets~\eqref{eqn:stokeslet_rotlet} are
\begin{equation}
  \label{eqn:shearStressSR}
  \begin{aligned}
  \ssigma^S(\xx_0) &= \sum_{k=1}^{M}
    \frac{\rr \cdot \llambda_k}{4\pi\rho^2} \left(
    \II - \frac{2}{\rho^2} \rr \otimes \rr \right),  \\
  \ssigma^R(\xx_0) &= -\sum_{k=1}^M
    \frac{\xi_k}{\rho^4} \left(\rr \otimes \rr^\perp + 
    \rr^\perp \otimes \rr \right),
  \end{aligned}
\end{equation}
where $\rr = \xx - \cc_k$, $\cc_k$ is the point chosen inside body
$\gamma_k$, and $\rho = \|\rr_k\|$.  Now that the deformation tensor of
each component of the completed double-layer potential is computed, the
shear stress at $\xx_0 \in \bd\Omega$ is
\begin{align*}
  \tau = -2 \left(J[\eeta](\xx_0) + \ssigma^\DD(\xx_0) + 
    \ssigma^S(\xx_0) + \ssigma^R(\xx_0)\right) \nn \cdot \ss.
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Vorticity}
For the Stokes equations, on boundaries that have a no-slip boundary
condition, the shear stress is equivalent to the vorticity $w = v_x -
u_y$.  Therefore, to compute the $w(\xx)$ for $\xx \in
\overline{\Omega}$, we only need to compute $w(\xx)$ for $\xx \in
\Omega$.  As we did for the shear stress, we compute the vorticity due
to the double-layer potential, Stokeslets, and rotlets individually.
The vorticity of the double-layer potential~\eqref{eqn:velocityDLP} at
$\xx \in \Omega$ is
\begin{align}
  w^{\DD}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} 
    \frac{(\rr \cdot \nn^\perp) + (\rr \cdot \nn)}{\rho^4}
    (\rr \cdot \eeta) ds_{\yy}.
  \label{eqn:vorticityDLP}
\end{align}
The vorticity due to the Stokeslet is
\begin{align*}
  w^S(\xx) = -\frac{1}{\pi} \sum_{k=1}^{M} 
    \frac{\rr \cdot \llambda_k^\perp}{\rho^2},
\end{align*}
and the vorticity of a rotlet is zero.  Therefore, the vorticity at $\xx
\in \Omega$ is
\begin{align*}
  w(\xx) = w^\DD(\xx) + w^S(\xx).
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Pressure}
To compute the pressure at $\xx \in \overline{\Omega}$, we follow the
same procedure used for the shear stress.  We start by computing the
pressure of the double-layer potential for $\xx \in \Omega$ and add the
appropriate jump if $\xx \in \Gamma$. For $\xx \in \Omega$, the pressure
is
\begin{align}
  p^{D}(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot \eeta(\yy) \,ds_\yy.
\end{align}
To compute the pressure at $\xx_0 \in \bd\Omega$, we consider the limit
as $\xx$ tends to $\xx_0$.  The limiting value is given
by~\cite{qua-bir2014a}
\begin{align*}
  \lim_{\substack{\xx \rightarrow \xx_0 \\ \xx \in \Omega}}p^\DD(\xx) =  
    \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx_0).
\end{align*}
The pressure due to the Stokeslets is
\begin{align*}
  p^S(\xx_0) = \sum_{k=1}^{M}\frac{\rr \cdot \llambda_k}{2\pi\rho^2},
\end{align*}
and the pressure due to the rotlets is zero.  Therefore, the pressure is
\begin{equation}
\label{eqn:pressureDLP}
\begin{aligned}
  p(\xx) &= p^{\DD}(\xx) + p^{S}(\xx), \quad &&\xx \in \Omega,\\
  p(\xx) &= \pderiv{\eeta}{\ss} \cdot \ss + p^{\DD}(\xx) + 
              p^{S}(\xx), && \xx \in \bd\Omega.
\end{aligned}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Drag}
\todo[inline]{check all signs in this section.  Fortran code assumes a
normal pointing into the eroding body and a tangent vector that
corresponds to a couterclockwise parameterization}
Finally, with the pressure and shear stress, the drag on a single body
with boundary $\gamma_k$ is
\begin{align}
  F_D = \int_{\gamma_k} (-p \nn + \tau \ss)\,ds.
  \label{eqn:drag}
\end{align}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Resistivity}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Methods\label{s:method}} 
There are three main numerical methods that need to be developed:~the
boundary integral equation solver for
equation~\eqref{eqn:completed_BIE}, computing the quantities of interest
in Section~\ref{sec:qois}, and updating the shape of the eroding bodies
with equation~\eqref{eqn:bodyEvolution}.  So that we can form stable
simulations with long time horizons, we use numerical methods that
achieve spectral accuracy in space, second-order accuracy in time, and
maintain an equispaced discretization of the bodies.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Spatial Discretization}
Each body is represented with at $N_\iin$ points as the Fourier series
\begin{align*}
  \xx^k(\theta) = \sum_{j = -N/2}^{N/2-1} \hat{x}_j^k e^{ij\theta},
    \quad k=1,\ldots,M.
\end{align*}
The exterior geometry is represented with a Fourier series using
$N_\out$ points.  Derivatives of the shape are computed in Fourier space
\begin{align*}
  \frac{d\xx^k(\theta)}{d\theta} = 
    \sum_{j = -N/2}^{N/2-1} ij\hat{x}_j^k e^{ij\theta},
    \quad k=1,\ldots,M.
\end{align*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Quadrature} 
Integrals that need to be approximated are the double-layer potential
for target points both off the boundary~\eqref{eqn:velocityDLP} and on
the boundary~\eqref{eqn:DLP}, the shear
stress~\eqref{eqn:shearStressDLP}, the
vorticity~\eqref{eqn:vorticityDLP}, the pressure both off and on the
boundary~\eqref{eqn:pressureDLP}, the drag~\eqref{eqn:drag}, and the
resistivity.   The shear stress, pressure, and drag must also be
computed using quadrature, and this can be interpreted as a
post-processing step once the density function, Stokeslets, and rotlets
are computed.

The integrands of each of these integrals, except for the resistivity,
are smooth and periodic.  Therefore, the trapezoid rule guarantees
spectral accuracy~\cite{tre-wei2014}.  However, before the trapezoid
rule can be applied, singularity subtraction and odd-even
integration~\cite{sid-isr1988} method must be used.  In addition, when
the target point is near $\bd\Omega$, a near-singular integration scheme
must be used.


\subsubsection{Velocity}
To numerically evaluate the completed double-layer
potential~\eqref{eqn:completed_BIE}, we define $N = MN_\iin + N_\out$ to
be the total number of discretization points of $\bd\Omega$.  The
double-layer potential in~\eqref{eqn:DLP} is discretized with the
trapezoid rule as
\begin{align}
  \DD[\eeta](\xx_i) = \sum_{j=1}^{N} K(\xx_i,\xx_j) \eeta(\xx_j) 
      \Delta s_{j}, \quad i=1,\ldots,N,
  \label{eqn:trapDLP}
\end{align}
where $\Delta s_j$ is the arclength term of $\bd\Omega$ at
$\xx_j$, and
\begin{align*}
  K(\xx,\yy) = \frac{1}{\pi} \frac{\rr \cdot \nn}{\rho^2} 
      \frac{\rr \otimes \rr}{\rho^2},
\end{align*}
where $\rr = \xx - \yy$ and $\rho = \|\rr\|$, is the kernel of the
double-layer potential.  The diagonal term of~\eqref{eqn:trapDLP} is
replaced with the limiting value of the double-layer potential
\begin{align*}
  D(\xx,\xx) = -\frac{\kappa(\xx)}{2\pi}(\ss(\xx) \otimes \ss(\xx)),
\end{align*}
where $\kappa(\xx)$ is the curvature and $\ss(\xx)$ is the unit tangent
vector at $\xx \in \bd\Omega$.  The equations for the strengths of the
Stokeslets~\eqref{eqn:stokeslet} and the rotlets~\eqref{eqn:rotlet} are
also discretized with the trapezoid rule.  Applying this discretization
strategy to~\eqref{eqn:completed_BIE}, the dense linear system that
needs to be solved is
\begin{equation}
  \label{eqn:completed_BIE_discretized}
  \begin{aligned}
    \ff(\xx_i) &= -\frac{1}{2}\ssigma(\xx_i) + \sum_{j=1}^{N} 
      K(\xx_i,\xx_j) \eeta(\xx_j) \Delta s_{j} +
      \sum_{k=1}^M S[\llambda_k,\cc_k](\xx_i) +
      \sum_{k=1}^M R[\xi_k,\cc_k](\xx_i) + 
      \sum_{\xx_j \in \Gamma} (\nn(\xx_i) \otimes
      \nn(\xx_j))\eeta(\xx_j), \\
    \llambda_k &= \sum_{\xx_i \in \gamma_k} \eeta(\xx_i) 
      \Delta s_i \\ 
    \mu_k &= \sum_{\xx_i \in \gamma_k}
      {(\xx_i^k - \cc_k)}^\perp \cdot \eeta(\xx_i^k) \Delta s_i^k,
  \end{aligned}
\end{equation}
for $i=1,\ldots,N$, $k=1,\ldots,M$.

The dense linear system~\eqref{eqn:completed_BIE_discretized} is solved
iteratively with GMRES.  The most expensive part is computing the $N$
term sum for all target points.  A direct summation would require
$\bigO(N^2)$ operations, but this is reduced to $\bigO(N)$ by using the
Fast Mutlipole method for the Stokes double-layer
potential~\cite{gre-rok1987,rac-???} \todo[inline]{sent email to Manas
asking about this}.  Since we are discretizing a second-kind integral
equation, the number of GMRES iterations is bounded independent of
$N$~\cite{cam-ips-kel-mey-xue1996}, and the overall complexity for
solving~\eqref{eqn:completed_BIE_discretized} is $\bigO(N)$.

\subsubsection{Shear Stress}
We have decomposed the deformation tensor into the contributions due to
three different terms.  The contributions from the Stokeslets and the
rotlets can be directly evaluated since $\rr \neq 0$ for all $\xx \in
\gamma$.  However, the kernel of the deformation tensor due to the
double-layer potential~\eqref{eqn:shearStressDLP} 
\begin{align*}
  K_\ssigma(\xx,\yy) = \frac{1}{2\pi} \left(
    2\frac{\rr \cdot \nn}{\rho^2} \frac{\rr \cdot \eeta}{\rho^2} \II + 
    \frac{\rr \cdot \eeta}{\rho^4} (\nn \otimes \rr + \rr \otimes \nn) +
    \frac{\rr \cdot \nn}{\rho^4} (\eeta \otimes \rr + \rr \otimes \eeta) - 
    8\frac{(\rr \cdot \nn)(\rr \cdot \eeta)}{\rho^6}(\rr \otimes \rr)
  \right),
\end{align*}
has a singularity that is asymptotic to $\bigO(\rho^2)$ when $\yy
\rightarrow \xx$.  The strength of this singularity can be reduced  by
using the fact that a velocity field due to a constant density function
is constant~\cite{poz1992}.  Therefore, the first part of the
deformation tensor can be evaluated as 
\begin{align*}
  \ssigma^{\DD}(\xx) = \int_{\bd\Omega}K_\ssigma(\xx,\yy)
      (\eeta(\yy) - \eeta(\xx)) \, ds_{\yy}, \quad \xx \in \bd\Omega.
\end{align*}
This expression for the deformation tensor has a singularity that is
asymptotic to $\bigO(\rho)$ when $\yy \rightarrow \xx$.  Finally, to
achieve a spectrally accurate discretization for the deformation tensor,
we use odd-even integration~\cite{sid-isr1988}.  That is, the
deformation tensor due to the double-layer potential at a discretization
point $\xx_i$ on body $\gamma_k$, with $i$ being odd, is approximated as
\begin{align*}
  \ssigma^{\DD}(\xx_i) = \sum_{\xx_j \notin \gamma_k}
    K_\ssigma(\xx_i,\xx_j) \eeta(\xx_j) \Delta s_j + 
  \sum_{\substack{\xx_j \in \gamma_k \\ j \: \mathtt{even}}}
    K_\ssigma(\xx_i,\xx_j) (\eeta(\xx_j) - \eeta(\xx_i)) \Delta s_j,
\end{align*}
and a similar approximation is used when $i$ is even.  The deformation
tensor due to the Stokeslets and rotlets is given in
equation~\eqref{eqn:shearStressSR}, and then the shear stress can be
computed by computing the deformation tensor in the normal direction,
and taking the inner product with the tangent direction.

In our implementation, the deformation tensor is computed with a direct
summation, and this requires $\bigO(N^2)$ operations.  Since this
calculation is only computed once per time step, while the velocity is
calculated at each GMRES iteration, the computational cost is
manageable.  However, in future work, to simulate erosion in a dense
packing of grains, a fast summation method, such as the
kernel-independent FMM~\cite{yin-bir-zor2004}, will be incorporated. 


\subsubsection{Vorticity}
Since the vorticity is equivalent to the shear stress on $\bd\Omega$, we
only need to compute the vorticity at target points $\xx \in \Omega$ in
the interior.  This is done with the trapezoid rule by computing
\begin{align*}
  \omega(\xx_i) = \sum_{j=1}^N K_\omega (\xx_i,\xx_j) \cdot \eeta_j 
    \Delta s_j,
\end{align*}
where
\begin{align*}
  K_\omega (\xx,\yy) =  -\frac{\rr}{\pi}
    \frac{(\rr \cdot \nn^\perp) + (\rr \cdot \nn)}{\rho^4}.
\end{align*}


\subsubsection{Pressure}
For the pressure, the double-layer potential is equivalent to
\begin{align*}
  p^\DD(\xx) = -\frac{1}{\pi}\int_{\bd\Omega} \frac{1}{\rho^2}
    \left(I - 2 \frac{\rr \otimes \rr}{\rho^2}\right) 
    \nn \cdot (\eeta(\yy) - \eeta(\xx_0)) \,ds_\yy.
\end{align*}


\subsubsection{Drag}



\subsubsection{Resistivity}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{{\thL} Formulation} 
\label{sec:thetaL}

In this section, we also describe our time stepping method and two
regularization terms that are necessary to control the curvature of the
bodies and to maintain spectral accuracy in space.


Once the shear stress is computed, it is used to update the shape of the
bodies according to the normal flow~\eqref{eqn:bodyEvolution}.  To
eliminate tangling and stretching of the mesh, we use a {\thL}
formulation~\cite{hou-low-she1994} which is described in
Section~\ref{sec:thetaL}.




We use a quasi-static approximation so that the velocity field
instantaneously changes with the changing geometry.  Therefore, we can
alternate between the two main aspects of our simulation
\begin{enumerate}
  \item Given a geometry, compute the shear stress of along the boundary
    of each of the bodies.
  \item Given the shear stress, update the geometry according to the
    erosion model.
\end{enumerate}

\vsp{2}
To handle boundary evolution, we use the {\thL}    method, which offers certain advantages in the ability to stabilize fluid-structure interaction problems \cite{hou-low-she1994}. Throughout this section, we use the following conventions: the bodies are parametrized in the CCW direction and the normal vector points into the bodies (our out of the fluid).

In order to regularize boundary evolution, we modify the normal velocity in Eq.~(\ref{eqn:bodyEvolution}) as follows
\begin{equation}
\label{eqn:Vn}
\Vn = \atau + \frac{\eps}{\log \left(2\pi/L \right)} \left(\kappa - \frac{2 \pi}{L} \right)
\end{equation}
Here, $\kappa$ is the curvature, $\eps$ is a small parameter, and $L$ is the total arc length of the body. The second term on the right acts to smooth bodies that have high-frequency oscillations. Since we have subtracted the mean curvature, $2\pi/L$, this term is area-preserving, so that the only material loss is due to the shear stress. We chose the prefactor $\log^{-1} \left(2\pi/L \right)$, so that, for 2D Stokes flow, this term scales the same as shear stress as $L \to 0$. Thus, the relative strength of the smoothing is always the same. 

We now introduce the tangent angle, $\theta$, defined through the relation
\begin{equation}
(x_s, y_s) = (\cos \theta, \sin \theta)
\end{equation}
where $s$ is arc length. We also introduce the normalized arc length $\alpha = s / L$. In terms of these new variables, the curvature can be expressed as
\begin{equation}
\kappa = \frac{1}{L} \pderiv{\theta}{\alpha}
\end{equation}
Substitution into Eq.~(\ref{eqn:Vn}) gives
\begin{equation}
\label{eqn:Vn2}
\Vn = \atau + \frac{\eps}{L \log \left(2\pi/L \right)}  \left(\pderiv{\theta}{\alpha} - 2 \pi \right)
\end{equation}
The main idea is to introduce an artificial tangential velocity that keeps collocation points equally spaced with respect to arc length; i.e.~the grid of $\alpha$ should always remain equally spaced. The tangential velocity that does the trick is determined by \cite{hou-low-she1994}
\begin{equation}
\pderiv{\Vs}{\alpha} = \thalpha \Vn - \mean{\thalpha \Vn}
\end{equation}
The interface evolution is then given by
\begin{equation}
\dot{\xx}(t) = \Vn \nn + \Vs \ss.
\end{equation}
Upon transforming to the variables $\theta(\alpha,t)$ and $L(t)$, we obtain the evolution equations
\begin{align}
& \tderiv{L}{t} = - \mean{\thalpha \Vn} \\
& \pderiv{\theta}{t} = \frac{1}{L} \left( \pderiv{\Vn}{\alpha} + \thalpha \Vs \right)
\end{align}
Inserting Eq.~(\ref{eqn:Vn2}) for the normal velocity gives
\begin{equation}
\pderiv{\theta}{t} = \frac{\eps}{L^{2} \log \left(2\pi/L \right)} \ppd{\theta}{\alpha} 
+ \frac{1}{L} \left( \pderiv{\atau}{\alpha} + \thalpha \Vs \right)
\end{equation}
For simplicity, we introduce the variables
\begin{align}
& M = - \mean{\thalpha \Vn} \\
& N = \frac{1}{L} \left( \pderiv{\atau}{\alpha} + \thalpha \Vs \right) \\
& \elfun = \frac{1}{L^{2} \log \left(2\pi/L \right)}
\end{align}
Then the evolution equations can be expressed as
\begin{align}
& \tderiv{L}{t} = M \\
& \pderiv{\theta}{t} = \eps \elfun \ppd{\theta}{\alpha} + N
\end{align}
We treat $\theta$ spectrally
\begin{equation}
\theta(\alpha,t) = \sum_{k = -\infty}^{\infty} \thhat_k e^{2\pi i k \alpha}
\end{equation}
Then we get
\begin{equation}
\tderiv{\thhat_k}{t} +  4 \eps \pi^2 k^2  \elfun \thhat_k = \hat{N}_k
\end{equation}
We introduce the integrating factor
\begin{equation}
\mu = \exp \left( 4 \eps \pi^2 k^2 \int \elfun dt \right)
\end{equation}
so that the solution can be represented as
\begin{align}
\thhat_k(t) & = \frac{1}{\mu} \int^t \mu \hat{N}_k dt'
= \thhat_k(0) + \int_0^t \exp \left( -4 \eps \pi^2 k^2 \int_{t'}^t \elfun dt'' \right) \hat{N}_k \, dt'
% LONGER FORM
%& = \exp \left( -4 \eps \pi^2 k^2 \int_0^t \elfun(L) ds \right) \, 
%\int_0^t \exp \left( 4 \eps \pi^2 k^2 \int_0^s \elfun(L) ds' \right) \hat{N}_k ds \\
\end{align}
where $t'$ and $t''$ are simply dummy variables for integration. We can get the exact relationship
\begin{equation}
\thhat_k(t + \Delta t) = \thhat_k(t) 
+ \int_t^{t+\Delta t} \exp \left( -4 \eps \pi^2 k^2 \int_{t'}^{t+\Delta t} \elfun dt'' \right) \hat{N}_k \, dt'
\end{equation}








\vsp{5}
\todo[inline]{Artificial Diffusion} 
\todo[inline]{Gaussian Filter} 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results\label{s:results}} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions\label{s:conclusions}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{appendices}
\section{Error estimates for near-singular integration \label{A:AppendixA}} 
\end{appendices}


\bibliographystyle{plainnat} 
\bibliography{refs}
\biboptions{sort&compress}
\end{document}


